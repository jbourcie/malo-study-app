function uT(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in n)){const l=Object.getOwnPropertyDescriptor(s,o);l&&Object.defineProperty(n,o,l.get?l:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function cv(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Gh={exports:{}},ol={},Kh={exports:{}},Fe={};var uy;function dT(){if(uy)return Fe;uy=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),T=Symbol.iterator;function C(D){return D===null||typeof D!="object"?null:(D=T&&D[T]||D["@@iterator"],typeof D=="function"?D:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$=Object.assign,j={};function O(D,Q,fe){this.props=D,this.context=Q,this.refs=j,this.updater=fe||k}O.prototype.isReactComponent={},O.prototype.setState=function(D,Q){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,Q,"setState")},O.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function Z(){}Z.prototype=O.prototype;function G(D,Q,fe){this.props=D,this.context=Q,this.refs=j,this.updater=fe||k}var X=G.prototype=new Z;X.constructor=G,$(X,O.prototype),X.isPureReactComponent=!0;var q=Array.isArray,M=Object.prototype.hasOwnProperty,H={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function S(D,Q,fe){var we,Te={},pe=null,Ve=null;if(Q!=null)for(we in Q.ref!==void 0&&(Ve=Q.ref),Q.key!==void 0&&(pe=""+Q.key),Q)M.call(Q,we)&&!I.hasOwnProperty(we)&&(Te[we]=Q[we]);var ke=arguments.length-2;if(ke===1)Te.children=fe;else if(1<ke){for(var Le=Array(ke),Pe=0;Pe<ke;Pe++)Le[Pe]=arguments[Pe+2];Te.children=Le}if(D&&D.defaultProps)for(we in ke=D.defaultProps,ke)Te[we]===void 0&&(Te[we]=ke[we]);return{$$typeof:n,type:D,key:pe,ref:Ve,props:Te,_owner:H.current}}function R(D,Q){return{$$typeof:n,type:D.type,key:Q,ref:D.ref,props:D.props,_owner:D._owner}}function V(D){return typeof D=="object"&&D!==null&&D.$$typeof===n}function N(D){var Q={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(fe){return Q[fe]})}var P=/\/+/g;function x(D,Q){return typeof D=="object"&&D!==null&&D.key!=null?N(""+D.key):Q.toString(36)}function ge(D,Q,fe,we,Te){var pe=typeof D;(pe==="undefined"||pe==="boolean")&&(D=null);var Ve=!1;if(D===null)Ve=!0;else switch(pe){case"string":case"number":Ve=!0;break;case"object":switch(D.$$typeof){case n:case e:Ve=!0}}if(Ve)return Ve=D,Te=Te(Ve),D=we===""?"."+x(Ve,0):we,q(Te)?(fe="",D!=null&&(fe=D.replace(P,"$&/")+"/"),ge(Te,Q,fe,"",function(Pe){return Pe})):Te!=null&&(V(Te)&&(Te=R(Te,fe+(!Te.key||Ve&&Ve.key===Te.key?"":(""+Te.key).replace(P,"$&/")+"/")+D)),Q.push(Te)),1;if(Ve=0,we=we===""?".":we+":",q(D))for(var ke=0;ke<D.length;ke++){pe=D[ke];var Le=we+x(pe,ke);Ve+=ge(pe,Q,fe,Le,Te)}else if(Le=C(D),typeof Le=="function")for(D=Le.call(D),ke=0;!(pe=D.next()).done;)pe=pe.value,Le=we+x(pe,ke++),Ve+=ge(pe,Q,fe,Le,Te);else if(pe==="object")throw Q=String(D),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return Ve}function Ue(D,Q,fe){if(D==null)return D;var we=[],Te=0;return ge(D,we,"","",function(pe){return Q.call(fe,pe,Te++)}),we}function Ke(D){if(D._status===-1){var Q=D._result;Q=Q(),Q.then(function(fe){(D._status===0||D._status===-1)&&(D._status=1,D._result=fe)},function(fe){(D._status===0||D._status===-1)&&(D._status=2,D._result=fe)}),D._status===-1&&(D._status=0,D._result=Q)}if(D._status===1)return D._result.default;throw D._result}var xe={current:null},re={transition:null},ve={ReactCurrentDispatcher:xe,ReactCurrentBatchConfig:re,ReactCurrentOwner:H};function ae(){throw Error("act(...) is not supported in production builds of React.")}return Fe.Children={map:Ue,forEach:function(D,Q,fe){Ue(D,function(){Q.apply(this,arguments)},fe)},count:function(D){var Q=0;return Ue(D,function(){Q++}),Q},toArray:function(D){return Ue(D,function(Q){return Q})||[]},only:function(D){if(!V(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Fe.Component=O,Fe.Fragment=t,Fe.Profiler=o,Fe.PureComponent=G,Fe.StrictMode=s,Fe.Suspense=p,Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ve,Fe.act=ae,Fe.cloneElement=function(D,Q,fe){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var we=$({},D.props),Te=D.key,pe=D.ref,Ve=D._owner;if(Q!=null){if(Q.ref!==void 0&&(pe=Q.ref,Ve=H.current),Q.key!==void 0&&(Te=""+Q.key),D.type&&D.type.defaultProps)var ke=D.type.defaultProps;for(Le in Q)M.call(Q,Le)&&!I.hasOwnProperty(Le)&&(we[Le]=Q[Le]===void 0&&ke!==void 0?ke[Le]:Q[Le])}var Le=arguments.length-2;if(Le===1)we.children=fe;else if(1<Le){ke=Array(Le);for(var Pe=0;Pe<Le;Pe++)ke[Pe]=arguments[Pe+2];we.children=ke}return{$$typeof:n,type:D.type,key:Te,ref:pe,props:we,_owner:Ve}},Fe.createContext=function(D){return D={$$typeof:u,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:l,_context:D},D.Consumer=D},Fe.createElement=S,Fe.createFactory=function(D){var Q=S.bind(null,D);return Q.type=D,Q},Fe.createRef=function(){return{current:null}},Fe.forwardRef=function(D){return{$$typeof:h,render:D}},Fe.isValidElement=V,Fe.lazy=function(D){return{$$typeof:w,_payload:{_status:-1,_result:D},_init:Ke}},Fe.memo=function(D,Q){return{$$typeof:y,type:D,compare:Q===void 0?null:Q}},Fe.startTransition=function(D){var Q=re.transition;re.transition={};try{D()}finally{re.transition=Q}},Fe.unstable_act=ae,Fe.useCallback=function(D,Q){return xe.current.useCallback(D,Q)},Fe.useContext=function(D){return xe.current.useContext(D)},Fe.useDebugValue=function(){},Fe.useDeferredValue=function(D){return xe.current.useDeferredValue(D)},Fe.useEffect=function(D,Q){return xe.current.useEffect(D,Q)},Fe.useId=function(){return xe.current.useId()},Fe.useImperativeHandle=function(D,Q,fe){return xe.current.useImperativeHandle(D,Q,fe)},Fe.useInsertionEffect=function(D,Q){return xe.current.useInsertionEffect(D,Q)},Fe.useLayoutEffect=function(D,Q){return xe.current.useLayoutEffect(D,Q)},Fe.useMemo=function(D,Q){return xe.current.useMemo(D,Q)},Fe.useReducer=function(D,Q,fe){return xe.current.useReducer(D,Q,fe)},Fe.useRef=function(D){return xe.current.useRef(D)},Fe.useState=function(D){return xe.current.useState(D)},Fe.useSyncExternalStore=function(D,Q,fe){return xe.current.useSyncExternalStore(D,Q,fe)},Fe.useTransition=function(){return xe.current.useTransition()},Fe.version="18.3.1",Fe}var dy;function qf(){return dy||(dy=1,Kh.exports=dT()),Kh.exports}var hy;function hT(){if(hy)return ol;hy=1;var n=qf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(h,p,y){var w,T={},C=null,k=null;y!==void 0&&(C=""+y),p.key!==void 0&&(C=""+p.key),p.ref!==void 0&&(k=p.ref);for(w in p)s.call(p,w)&&!l.hasOwnProperty(w)&&(T[w]=p[w]);if(h&&h.defaultProps)for(w in p=h.defaultProps,p)T[w]===void 0&&(T[w]=p[w]);return{$$typeof:e,type:h,key:C,ref:k,props:T,_owner:o.current}}return ol.Fragment=t,ol.jsx=u,ol.jsxs=u,ol}var fy;function fT(){return fy||(fy=1,Gh.exports=hT()),Gh.exports}var v=fT(),ue=qf();const de=cv(ue),pT=uT({__proto__:null,default:de},[ue]);var nu={},Qh={exports:{}},mn={},Jh={exports:{}},Xh={};var py;function mT(){return py||(py=1,(function(n){function e(re,ve){var ae=re.length;re.push(ve);e:for(;0<ae;){var D=ae-1>>>1,Q=re[D];if(0<o(Q,ve))re[D]=ve,re[ae]=Q,ae=D;else break e}}function t(re){return re.length===0?null:re[0]}function s(re){if(re.length===0)return null;var ve=re[0],ae=re.pop();if(ae!==ve){re[0]=ae;e:for(var D=0,Q=re.length,fe=Q>>>1;D<fe;){var we=2*(D+1)-1,Te=re[we],pe=we+1,Ve=re[pe];if(0>o(Te,ae))pe<Q&&0>o(Ve,Te)?(re[D]=Ve,re[pe]=ae,D=pe):(re[D]=Te,re[we]=ae,D=we);else if(pe<Q&&0>o(Ve,ae))re[D]=Ve,re[pe]=ae,D=pe;else break e}}return ve}function o(re,ve){var ae=re.sortIndex-ve.sortIndex;return ae!==0?ae:re.id-ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,h=u.now();n.unstable_now=function(){return u.now()-h}}var p=[],y=[],w=1,T=null,C=3,k=!1,$=!1,j=!1,O=typeof setTimeout=="function"?setTimeout:null,Z=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function X(re){for(var ve=t(y);ve!==null;){if(ve.callback===null)s(y);else if(ve.startTime<=re)s(y),ve.sortIndex=ve.expirationTime,e(p,ve);else break;ve=t(y)}}function q(re){if(j=!1,X(re),!$)if(t(p)!==null)$=!0,Ke(M);else{var ve=t(y);ve!==null&&xe(q,ve.startTime-re)}}function M(re,ve){$=!1,j&&(j=!1,Z(S),S=-1),k=!0;var ae=C;try{for(X(ve),T=t(p);T!==null&&(!(T.expirationTime>ve)||re&&!N());){var D=T.callback;if(typeof D=="function"){T.callback=null,C=T.priorityLevel;var Q=D(T.expirationTime<=ve);ve=n.unstable_now(),typeof Q=="function"?T.callback=Q:T===t(p)&&s(p),X(ve)}else s(p);T=t(p)}if(T!==null)var fe=!0;else{var we=t(y);we!==null&&xe(q,we.startTime-ve),fe=!1}return fe}finally{T=null,C=ae,k=!1}}var H=!1,I=null,S=-1,R=5,V=-1;function N(){return!(n.unstable_now()-V<R)}function P(){if(I!==null){var re=n.unstable_now();V=re;var ve=!0;try{ve=I(!0,re)}finally{ve?x():(H=!1,I=null)}}else H=!1}var x;if(typeof G=="function")x=function(){G(P)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,Ue=ge.port2;ge.port1.onmessage=P,x=function(){Ue.postMessage(null)}}else x=function(){O(P,0)};function Ke(re){I=re,H||(H=!0,x())}function xe(re,ve){S=O(function(){re(n.unstable_now())},ve)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(re){re.callback=null},n.unstable_continueExecution=function(){$||k||($=!0,Ke(M))},n.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<re?Math.floor(1e3/re):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_getFirstCallbackNode=function(){return t(p)},n.unstable_next=function(re){switch(C){case 1:case 2:case 3:var ve=3;break;default:ve=C}var ae=C;C=ve;try{return re()}finally{C=ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(re,ve){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var ae=C;C=re;try{return ve()}finally{C=ae}},n.unstable_scheduleCallback=function(re,ve,ae){var D=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?D+ae:D):ae=D,re){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=ae+Q,re={id:w++,callback:ve,priorityLevel:re,startTime:ae,expirationTime:Q,sortIndex:-1},ae>D?(re.sortIndex=ae,e(y,re),t(p)===null&&re===t(y)&&(j?(Z(S),S=-1):j=!0,xe(q,ae-D))):(re.sortIndex=Q,e(p,re),$||k||($=!0,Ke(M))),re},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(re){var ve=C;return function(){var ae=C;C=ve;try{return re.apply(this,arguments)}finally{C=ae}}}})(Xh)),Xh}var my;function gT(){return my||(my=1,Jh.exports=mT()),Jh.exports}var gy;function yT(){if(gy)return mn;gy=1;var n=qf(),e=gT();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(r,i){u(r,i),u(r+"Capture",i)}function u(r,i){for(o[r]=i,r=0;r<i.length;r++)s.add(i[r])}var h=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},T={};function C(r){return p.call(T,r)?!0:p.call(w,r)?!1:y.test(r)?T[r]=!0:(w[r]=!0,!1)}function k(r,i,a,d){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return d?!1:a!==null?!a.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function $(r,i,a,d){if(i===null||typeof i>"u"||k(r,i,a,d))return!0;if(d)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function j(r,i,a,d,f,m,E){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=d,this.attributeNamespace=f,this.mustUseProperty=a,this.propertyName=r,this.type=i,this.sanitizeURL=m,this.removeEmptyString=E}var O={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){O[r]=new j(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];O[i]=new j(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){O[r]=new j(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){O[r]=new j(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){O[r]=new j(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){O[r]=new j(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){O[r]=new j(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){O[r]=new j(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){O[r]=new j(r,5,!1,r.toLowerCase(),null,!1,!1)});var Z=/[\-:]([a-z])/g;function G(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(Z,G);O[i]=new j(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(Z,G);O[i]=new j(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(Z,G);O[i]=new j(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){O[r]=new j(r,1,!1,r.toLowerCase(),null,!1,!1)}),O.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){O[r]=new j(r,1,!1,r.toLowerCase(),null,!0,!0)});function X(r,i,a,d){var f=O.hasOwnProperty(i)?O[i]:null;(f!==null?f.type!==0:d||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&($(i,a,f,d)&&(a=null),d||f===null?C(i)&&(a===null?r.removeAttribute(i):r.setAttribute(i,""+a)):f.mustUseProperty?r[f.propertyName]=a===null?f.type===3?!1:"":a:(i=f.attributeName,d=f.attributeNamespace,a===null?r.removeAttribute(i):(f=f.type,a=f===3||f===4&&a===!0?"":""+a,d?r.setAttributeNS(d,i,a):r.setAttribute(i,a))))}var q=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,M=Symbol.for("react.element"),H=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),N=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),ge=Symbol.for("react.suspense_list"),Ue=Symbol.for("react.memo"),Ke=Symbol.for("react.lazy"),xe=Symbol.for("react.offscreen"),re=Symbol.iterator;function ve(r){return r===null||typeof r!="object"?null:(r=re&&r[re]||r["@@iterator"],typeof r=="function"?r:null)}var ae=Object.assign,D;function Q(r){if(D===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);D=i&&i[1]||""}return`
`+D+r}var fe=!1;function we(r,i){if(!r||fe)return"";fe=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(W){var d=W}Reflect.construct(r,[],i)}else{try{i.call()}catch(W){d=W}r.call(i.prototype)}else{try{throw Error()}catch(W){d=W}r()}}catch(W){if(W&&d&&typeof W.stack=="string"){for(var f=W.stack.split(`
`),m=d.stack.split(`
`),E=f.length-1,b=m.length-1;1<=E&&0<=b&&f[E]!==m[b];)b--;for(;1<=E&&0<=b;E--,b--)if(f[E]!==m[b]){if(E!==1||b!==1)do if(E--,b--,0>b||f[E]!==m[b]){var L=`
`+f[E].replace(" at new "," at ");return r.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",r.displayName)),L}while(1<=E&&0<=b);break}}}finally{fe=!1,Error.prepareStackTrace=a}return(r=r?r.displayName||r.name:"")?Q(r):""}function Te(r){switch(r.tag){case 5:return Q(r.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return r=we(r.type,!1),r;case 11:return r=we(r.type.render,!1),r;case 1:return r=we(r.type,!0),r;default:return""}}function pe(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case H:return"Portal";case R:return"Profiler";case S:return"StrictMode";case x:return"Suspense";case ge:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case N:return(r.displayName||"Context")+".Consumer";case V:return(r._context.displayName||"Context")+".Provider";case P:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Ue:return i=r.displayName||null,i!==null?i:pe(r.type)||"Memo";case Ke:i=r._payload,r=r._init;try{return pe(r(i))}catch{}}return null}function Ve(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(i);case 8:return i===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function ke(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Le(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Pe(r){var i=Le(r)?"checked":"value",a=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),d=""+r[i];if(!r.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var f=a.get,m=a.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return f.call(this)},set:function(E){d=""+E,m.call(this,E)}}),Object.defineProperty(r,i,{enumerable:a.enumerable}),{getValue:function(){return d},setValue:function(E){d=""+E},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function lt(r){r._valueTracker||(r._valueTracker=Pe(r))}function cn(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var a=i.getValue(),d="";return r&&(d=Le(r)?r.checked?"true":"false":r.value),r=d,r!==a?(i.setValue(r),!0):!1}function Ht(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Gt(r,i){var a=i.checked;return ae({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??r._wrapperState.initialChecked})}function Kt(r,i){var a=i.defaultValue==null?"":i.defaultValue,d=i.checked!=null?i.checked:i.defaultChecked;a=ke(i.value!=null?i.value:a),r._wrapperState={initialChecked:d,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Qt(r,i){i=i.checked,i!=null&&X(r,"checked",i,!1)}function qn(r,i){Qt(r,i);var a=ke(i.value),d=i.type;if(a!=null)d==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+a):r.value!==""+a&&(r.value=""+a);else if(d==="submit"||d==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?ct(r,i.type,a):i.hasOwnProperty("defaultValue")&&ct(r,i.type,ke(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function ir(r,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var d=i.type;if(!(d!=="submit"&&d!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,a||i===r.value||(r.value=i),r.defaultValue=i}a=r.name,a!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,a!==""&&(r.name=a)}function ct(r,i,a){(i!=="number"||Ht(r.ownerDocument)!==r)&&(a==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+a&&(r.defaultValue=""+a))}var ut=Array.isArray;function yn(r,i,a,d){if(r=r.options,i){i={};for(var f=0;f<a.length;f++)i["$"+a[f]]=!0;for(a=0;a<r.length;a++)f=i.hasOwnProperty("$"+r[a].value),r[a].selected!==f&&(r[a].selected=f),f&&d&&(r[a].defaultSelected=!0)}else{for(a=""+ke(a),i=null,f=0;f<r.length;f++){if(r[f].value===a){r[f].selected=!0,d&&(r[f].defaultSelected=!0);return}i!==null||r[f].disabled||(i=r[f])}i!==null&&(i.selected=!0)}}function ui(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return ae({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Ie(r,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(t(92));if(ut(a)){if(1<a.length)throw Error(t(93));a=a[0]}i=a}i==null&&(i=""),a=i}r._wrapperState={initialValue:ke(a)}}function Mt(r,i){var a=ke(i.value),d=ke(i.defaultValue);a!=null&&(a=""+a,a!==r.value&&(r.value=a),i.defaultValue==null&&r.defaultValue!==a&&(r.defaultValue=a)),d!=null&&(r.defaultValue=""+d)}function We(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function $n(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _n(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?$n(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Jt,or=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,d,f){MSApp.execUnsafeLocalFunction(function(){return r(i,a,d,f)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(Jt=Jt||document.createElement("div"),Jt.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Jt.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function di(r,i){if(i){var a=r.firstChild;if(a&&a===r.lastChild&&a.nodeType===3){a.nodeValue=i;return}}r.textContent=i}var cs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$l=["Webkit","ms","Moz","O"];Object.keys(cs).forEach(function(r){$l.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),cs[i]=cs[r]})});function us(r,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||cs.hasOwnProperty(r)&&cs[r]?(""+i).trim():i+"px"}function eo(r,i){r=r.style;for(var a in i)if(i.hasOwnProperty(a)){var d=a.indexOf("--")===0,f=us(a,i[a],d);a==="float"&&(a="cssFloat"),d?r.setProperty(a,f):r[a]=f}}var ya=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wn(r,i){if(i){if(ya[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function to(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ds=null;function no(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Or=null,Vr=null,pt=null;function _a(r){if(r=Wa(r)){if(typeof Or!="function")throw Error(t(280));var i=r.stateNode;i&&(i=yc(i),Or(r.stateNode,r.type,i))}}function hs(r){Vr?pt?pt.push(r):pt=[r]:Vr=r}function fs(){if(Vr){var r=Vr,i=pt;if(pt=Vr=null,_a(r),i)for(r=0;r<i.length;r++)_a(i[r])}}function Wl(r,i){return r(i)}function Hl(){}var ar=!1;function Gl(r,i,a){if(ar)return r(i,a);ar=!0;try{return Wl(r,i,a)}finally{ar=!1,(Vr!==null||pt!==null)&&(Hl(),fs())}}function hi(r,i){var a=r.stateNode;if(a===null)return null;var d=yc(a);if(d===null)return null;a=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(a&&typeof a!="function")throw Error(t(231,i,typeof a));return a}var ps=!1;if(h)try{var ms={};Object.defineProperty(ms,"passive",{get:function(){ps=!0}}),window.addEventListener("test",ms,ms),window.removeEventListener("test",ms,ms)}catch{ps=!1}function Kl(r,i,a,d,f,m,E,b,L){var W=Array.prototype.slice.call(arguments,3);try{i.apply(a,W)}catch(te){this.onError(te)}}var jr=!1,lr=null,ro=!1,Nn=null,Ql={onError:function(r){jr=!0,lr=r}};function Jl(r,i,a,d,f,m,E,b,L){jr=!1,lr=null,Kl.apply(Ql,arguments)}function va(r,i,a,d,f,m,E,b,L){if(Jl.apply(this,arguments),jr){if(jr){var W=lr;jr=!1,lr=null}else throw Error(t(198));ro||(ro=!0,Nn=W)}}function Hn(r){var i=r,a=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(a=i.return),r=i.return;while(r)}return i.tag===3?a:null}function wa(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function Xl(r){if(Hn(r)!==r)throw Error(t(188))}function Yl(r){var i=r.alternate;if(!i){if(i=Hn(r),i===null)throw Error(t(188));return i!==r?null:r}for(var a=r,d=i;;){var f=a.return;if(f===null)break;var m=f.alternate;if(m===null){if(d=f.return,d!==null){a=d;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===a)return Xl(f),r;if(m===d)return Xl(f),i;m=m.sibling}throw Error(t(188))}if(a.return!==d.return)a=f,d=m;else{for(var E=!1,b=f.child;b;){if(b===a){E=!0,a=f,d=m;break}if(b===d){E=!0,d=f,a=m;break}b=b.sibling}if(!E){for(b=m.child;b;){if(b===a){E=!0,a=m,d=f;break}if(b===d){E=!0,d=m,a=f;break}b=b.sibling}if(!E)throw Error(t(189))}}if(a.alternate!==d)throw Error(t(190))}if(a.tag!==3)throw Error(t(188));return a.stateNode.current===a?r:i}function Zl(r){return r=Yl(r),r!==null?fi(r):null}function fi(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=fi(r);if(i!==null)return i;r=r.sibling}return null}var Ea=e.unstable_scheduleCallback,so=e.unstable_cancelCallback,pi=e.unstable_shouldYield,Mr=e.unstable_requestPaint,rt=e.unstable_now,Sd=e.unstable_getCurrentPriorityLevel,io=e.unstable_ImmediatePriority,Ta=e.unstable_UserBlockingPriority,mi=e.unstable_NormalPriority,Ia=e.unstable_LowPriority,oo=e.unstable_IdlePriority,gi=null,vn=null;function ec(r){if(vn&&typeof vn.onCommitFiberRoot=="function")try{vn.onCommitFiberRoot(gi,r,void 0,(r.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:yi,cr=Math.log,Dn=Math.LN2;function yi(r){return r>>>=0,r===0?32:31-(cr(r)/Dn|0)|0}var ur=64,gs=4194304;function Xe(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Lr(r,i){var a=r.pendingLanes;if(a===0)return 0;var d=0,f=r.suspendedLanes,m=r.pingedLanes,E=a&268435455;if(E!==0){var b=E&~f;b!==0?d=Xe(b):(m&=E,m!==0&&(d=Xe(m)))}else E=a&~f,E!==0?d=Xe(E):m!==0&&(d=Xe(m));if(d===0)return 0;if(i!==0&&i!==d&&(i&f)===0&&(f=d&-d,m=i&-i,f>=m||f===16&&(m&4194240)!==0))return i;if((d&4)!==0&&(d|=a&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=d;0<i;)a=31-wn(i),f=1<<a,d|=r[a],i&=~f;return d}function _i(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vi(r,i){for(var a=r.suspendedLanes,d=r.pingedLanes,f=r.expirationTimes,m=r.pendingLanes;0<m;){var E=31-wn(m),b=1<<E,L=f[E];L===-1?((b&a)===0||(b&d)!==0)&&(f[E]=_i(b,i)):L<=i&&(r.expiredLanes|=b),m&=~b}}function Sa(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function Aa(){var r=ur;return ur<<=1,(ur&4194240)===0&&(ur=64),r}function Ca(r){for(var i=[],a=0;31>a;a++)i.push(r);return i}function wi(r,i,a){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-wn(i),r[i]=a}function Ad(r,i){var a=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var d=r.eventTimes;for(r=r.expirationTimes;0<a;){var f=31-wn(a),m=1<<f;i[f]=0,d[f]=-1,r[f]=-1,a&=~m}}function Ra(r,i){var a=r.entangledLanes|=i;for(r=r.entanglements;a;){var d=31-wn(a),f=1<<d;f&i|r[d]&i&&(r[d]|=i),a&=~f}}var $e=0;function dr(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var xa,ao,ba,Pa,ka,hr=!1,lo=[],fr=null,pr=null,Lt=null,Ei=new Map,Fr=new Map,En=[],tc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ys(r,i){switch(r){case"focusin":case"focusout":fr=null;break;case"dragenter":case"dragleave":pr=null;break;case"mouseover":case"mouseout":Lt=null;break;case"pointerover":case"pointerout":Ei.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fr.delete(i.pointerId)}}function Gn(r,i,a,d,f,m){return r===null||r.nativeEvent!==m?(r={blockedOn:i,domEventName:a,eventSystemFlags:d,nativeEvent:m,targetContainers:[f]},i!==null&&(i=Wa(i),i!==null&&ao(i)),r):(r.eventSystemFlags|=d,i=r.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),r)}function nc(r,i,a,d,f){switch(i){case"focusin":return fr=Gn(fr,r,i,a,d,f),!0;case"dragenter":return pr=Gn(pr,r,i,a,d,f),!0;case"mouseover":return Lt=Gn(Lt,r,i,a,d,f),!0;case"pointerover":var m=f.pointerId;return Ei.set(m,Gn(Ei.get(m)||null,r,i,a,d,f)),!0;case"gotpointercapture":return m=f.pointerId,Fr.set(m,Gn(Fr.get(m)||null,r,i,a,d,f)),!0}return!1}function co(r){var i=Ai(r.target);if(i!==null){var a=Hn(i);if(a!==null){if(i=a.tag,i===13){if(i=wa(a),i!==null){r.blockedOn=i,ka(r.priority,function(){ba(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){r.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}r.blockedOn=null}function tt(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var a=uo(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(a===null){a=r.nativeEvent;var d=new a.constructor(a.type,a);ds=d,a.target.dispatchEvent(d),ds=null}else return i=Wa(a),i!==null&&ao(i),r.blockedOn=a,!1;i.shift()}return!0}function rc(r,i,a){tt(r)&&a.delete(i)}function Cd(){hr=!1,fr!==null&&tt(fr)&&(fr=null),pr!==null&&tt(pr)&&(pr=null),Lt!==null&&tt(Lt)&&(Lt=null),Ei.forEach(rc),Fr.forEach(rc)}function _s(r,i){r.blockedOn===i&&(r.blockedOn=null,hr||(hr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Cd)))}function vs(r){function i(f){return _s(f,r)}if(0<lo.length){_s(lo[0],r);for(var a=1;a<lo.length;a++){var d=lo[a];d.blockedOn===r&&(d.blockedOn=null)}}for(fr!==null&&_s(fr,r),pr!==null&&_s(pr,r),Lt!==null&&_s(Lt,r),Ei.forEach(i),Fr.forEach(i),a=0;a<En.length;a++)d=En[a],d.blockedOn===r&&(d.blockedOn=null);for(;0<En.length&&(a=En[0],a.blockedOn===null);)co(a),a.blockedOn===null&&En.shift()}var Ur=q.ReactCurrentBatchConfig,Br=!0;function mr(r,i,a,d){var f=$e,m=Ur.transition;Ur.transition=null;try{$e=1,Na(r,i,a,d)}finally{$e=f,Ur.transition=m}}function sc(r,i,a,d){var f=$e,m=Ur.transition;Ur.transition=null;try{$e=4,Na(r,i,a,d)}finally{$e=f,Ur.transition=m}}function Na(r,i,a,d){if(Br){var f=uo(r,i,a,d);if(f===null)Md(r,i,d,gr,a),ys(r,d);else if(nc(f,r,i,a,d))d.stopPropagation();else if(ys(r,d),i&4&&-1<tc.indexOf(r)){for(;f!==null;){var m=Wa(f);if(m!==null&&xa(m),m=uo(r,i,a,d),m===null&&Md(r,i,d,gr,a),m===f)break;f=m}f!==null&&d.stopPropagation()}else Md(r,i,d,null,a)}}var gr=null;function uo(r,i,a,d){if(gr=null,r=no(d),r=Ai(r),r!==null)if(i=Hn(r),i===null)r=null;else if(a=i.tag,a===13){if(r=wa(i),r!==null)return r;r=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return gr=r,null}function ho(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Sd()){case io:return 1;case Ta:return 4;case mi:case Ia:return 16;case oo:return 536870912;default:return 16}default:return 16}}var Tn=null,fo=null,zr=null;function ic(){if(zr)return zr;var r,i=fo,a=i.length,d,f="value"in Tn?Tn.value:Tn.textContent,m=f.length;for(r=0;r<a&&i[r]===f[r];r++);var E=a-r;for(d=1;d<=E&&i[a-d]===f[m-d];d++);return zr=f.slice(r,1<d?1-d:void 0)}function Ti(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function yr(){return!0}function Da(){return!1}function Xt(r){function i(a,d,f,m,E){this._reactName=a,this._targetInst=f,this.type=d,this.nativeEvent=m,this.target=E,this.currentTarget=null;for(var b in r)r.hasOwnProperty(b)&&(a=r[b],this[b]=a?a(m):m[b]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?yr:Da,this.isPropagationStopped=Da,this}return ae(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=yr)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=yr)},persist:function(){},isPersistent:yr}),i}var _r={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ii=Xt(_r),ws=ae({},_r,{view:0,detail:0}),po=Xt(ws),mo,go,In,Si=ae({},ws,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:je,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==In&&(In&&r.type==="mousemove"?(mo=r.screenX-In.screenX,go=r.screenY-In.screenY):go=mo=0,In=r),mo)},movementY:function(r){return"movementY"in r?r.movementY:go}}),Oa=Xt(Si),oc=ae({},Si,{dataTransfer:0}),ac=Xt(oc),yo=ae({},ws,{relatedTarget:0}),Ft=Xt(yo),lc=ae({},_r,{animationName:0,elapsedTime:0,pseudoElement:0}),cc=Xt(lc),Es=ae({},_r,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),c=Xt(Es),g=ae({},_r,{data:0}),_=Xt(g),A={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},K={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ie(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=K[r])?!!i[r]:!1}function je(){return ie}var _t=ae({},ws,{key:function(r){if(r.key){var i=A[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Ti(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?B[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:je,charCode:function(r){return r.type==="keypress"?Ti(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ti(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Ze=Xt(_t),Tt=ae({},Si,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sn=Xt(Tt),qr=ae({},ws,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:je}),vr=Xt(qr),wr=ae({},_r,{propertyName:0,elapsedTime:0,pseudoElement:0}),_o=Xt(wr),Va=ae({},Si,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),sE=Xt(Va),iE=[9,13,27,32],Rd=h&&"CompositionEvent"in window,ja=null;h&&"documentMode"in document&&(ja=document.documentMode);var oE=h&&"TextEvent"in window&&!ja,nm=h&&(!Rd||ja&&8<ja&&11>=ja),rm=" ",sm=!1;function im(r,i){switch(r){case"keyup":return iE.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function om(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var vo=!1;function aE(r,i){switch(r){case"compositionend":return om(i);case"keypress":return i.which!==32?null:(sm=!0,rm);case"textInput":return r=i.data,r===rm&&sm?null:r;default:return null}}function lE(r,i){if(vo)return r==="compositionend"||!Rd&&im(r,i)?(r=ic(),zr=fo=Tn=null,vo=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return nm&&i.locale!=="ko"?null:i.data;default:return null}}var cE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function am(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!cE[r.type]:i==="textarea"}function lm(r,i,a,d){hs(d),i=pc(i,"onChange"),0<i.length&&(a=new Ii("onChange","change",null,a,d),r.push({event:a,listeners:i}))}var Ma=null,La=null;function uE(r){Cm(r,0)}function uc(r){var i=So(r);if(cn(i))return r}function dE(r,i){if(r==="change")return i}var cm=!1;if(h){var xd;if(h){var bd="oninput"in document;if(!bd){var um=document.createElement("div");um.setAttribute("oninput","return;"),bd=typeof um.oninput=="function"}xd=bd}else xd=!1;cm=xd&&(!document.documentMode||9<document.documentMode)}function dm(){Ma&&(Ma.detachEvent("onpropertychange",hm),La=Ma=null)}function hm(r){if(r.propertyName==="value"&&uc(La)){var i=[];lm(i,La,r,no(r)),Gl(uE,i)}}function hE(r,i,a){r==="focusin"?(dm(),Ma=i,La=a,Ma.attachEvent("onpropertychange",hm)):r==="focusout"&&dm()}function fE(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return uc(La)}function pE(r,i){if(r==="click")return uc(i)}function mE(r,i){if(r==="input"||r==="change")return uc(i)}function gE(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var Kn=typeof Object.is=="function"?Object.is:gE;function Fa(r,i){if(Kn(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var a=Object.keys(r),d=Object.keys(i);if(a.length!==d.length)return!1;for(d=0;d<a.length;d++){var f=a[d];if(!p.call(i,f)||!Kn(r[f],i[f]))return!1}return!0}function fm(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function pm(r,i){var a=fm(r);r=0;for(var d;a;){if(a.nodeType===3){if(d=r+a.textContent.length,r<=i&&d>=i)return{node:a,offset:i-r};r=d}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=fm(a)}}function mm(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?mm(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function gm(){for(var r=window,i=Ht();i instanceof r.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)r=i.contentWindow;else break;i=Ht(r.document)}return i}function Pd(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function yE(r){var i=gm(),a=r.focusedElem,d=r.selectionRange;if(i!==a&&a&&a.ownerDocument&&mm(a.ownerDocument.documentElement,a)){if(d!==null&&Pd(a)){if(i=d.start,r=d.end,r===void 0&&(r=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(r,a.value.length);else if(r=(i=a.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var f=a.textContent.length,m=Math.min(d.start,f);d=d.end===void 0?m:Math.min(d.end,f),!r.extend&&m>d&&(f=d,d=m,m=f),f=pm(a,m);var E=pm(a,d);f&&E&&(r.rangeCount!==1||r.anchorNode!==f.node||r.anchorOffset!==f.offset||r.focusNode!==E.node||r.focusOffset!==E.offset)&&(i=i.createRange(),i.setStart(f.node,f.offset),r.removeAllRanges(),m>d?(r.addRange(i),r.extend(E.node,E.offset)):(i.setEnd(E.node,E.offset),r.addRange(i)))}}for(i=[],r=a;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)r=i[a],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var _E=h&&"documentMode"in document&&11>=document.documentMode,wo=null,kd=null,Ua=null,Nd=!1;function ym(r,i,a){var d=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Nd||wo==null||wo!==Ht(d)||(d=wo,"selectionStart"in d&&Pd(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Ua&&Fa(Ua,d)||(Ua=d,d=pc(kd,"onSelect"),0<d.length&&(i=new Ii("onSelect","select",null,i,a),r.push({event:i,listeners:d}),i.target=wo)))}function dc(r,i){var a={};return a[r.toLowerCase()]=i.toLowerCase(),a["Webkit"+r]="webkit"+i,a["Moz"+r]="moz"+i,a}var Eo={animationend:dc("Animation","AnimationEnd"),animationiteration:dc("Animation","AnimationIteration"),animationstart:dc("Animation","AnimationStart"),transitionend:dc("Transition","TransitionEnd")},Dd={},_m={};h&&(_m=document.createElement("div").style,"AnimationEvent"in window||(delete Eo.animationend.animation,delete Eo.animationiteration.animation,delete Eo.animationstart.animation),"TransitionEvent"in window||delete Eo.transitionend.transition);function hc(r){if(Dd[r])return Dd[r];if(!Eo[r])return r;var i=Eo[r],a;for(a in i)if(i.hasOwnProperty(a)&&a in _m)return Dd[r]=i[a];return r}var vm=hc("animationend"),wm=hc("animationiteration"),Em=hc("animationstart"),Tm=hc("transitionend"),Im=new Map,Sm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ts(r,i){Im.set(r,i),l(i,[r])}for(var Od=0;Od<Sm.length;Od++){var Vd=Sm[Od],vE=Vd.toLowerCase(),wE=Vd[0].toUpperCase()+Vd.slice(1);Ts(vE,"on"+wE)}Ts(vm,"onAnimationEnd"),Ts(wm,"onAnimationIteration"),Ts(Em,"onAnimationStart"),Ts("dblclick","onDoubleClick"),Ts("focusin","onFocus"),Ts("focusout","onBlur"),Ts(Tm,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ba="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),EE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ba));function Am(r,i,a){var d=r.type||"unknown-event";r.currentTarget=a,va(d,i,void 0,r),r.currentTarget=null}function Cm(r,i){i=(i&4)!==0;for(var a=0;a<r.length;a++){var d=r[a],f=d.event;d=d.listeners;e:{var m=void 0;if(i)for(var E=d.length-1;0<=E;E--){var b=d[E],L=b.instance,W=b.currentTarget;if(b=b.listener,L!==m&&f.isPropagationStopped())break e;Am(f,b,W),m=L}else for(E=0;E<d.length;E++){if(b=d[E],L=b.instance,W=b.currentTarget,b=b.listener,L!==m&&f.isPropagationStopped())break e;Am(f,b,W),m=L}}}if(ro)throw r=Nn,ro=!1,Nn=null,r}function st(r,i){var a=i[qd];a===void 0&&(a=i[qd]=new Set);var d=r+"__bubble";a.has(d)||(Rm(i,r,2,!1),a.add(d))}function jd(r,i,a){var d=0;i&&(d|=4),Rm(a,r,d,i)}var fc="_reactListening"+Math.random().toString(36).slice(2);function za(r){if(!r[fc]){r[fc]=!0,s.forEach(function(a){a!=="selectionchange"&&(EE.has(a)||jd(a,!1,r),jd(a,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[fc]||(i[fc]=!0,jd("selectionchange",!1,i))}}function Rm(r,i,a,d){switch(ho(i)){case 1:var f=mr;break;case 4:f=sc;break;default:f=Na}a=f.bind(null,i,a,r),f=void 0,!ps||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),d?f!==void 0?r.addEventListener(i,a,{capture:!0,passive:f}):r.addEventListener(i,a,!0):f!==void 0?r.addEventListener(i,a,{passive:f}):r.addEventListener(i,a,!1)}function Md(r,i,a,d,f){var m=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var E=d.tag;if(E===3||E===4){var b=d.stateNode.containerInfo;if(b===f||b.nodeType===8&&b.parentNode===f)break;if(E===4)for(E=d.return;E!==null;){var L=E.tag;if((L===3||L===4)&&(L=E.stateNode.containerInfo,L===f||L.nodeType===8&&L.parentNode===f))return;E=E.return}for(;b!==null;){if(E=Ai(b),E===null)return;if(L=E.tag,L===5||L===6){d=m=E;continue e}b=b.parentNode}}d=d.return}Gl(function(){var W=m,te=no(a),ne=[];e:{var ee=Im.get(r);if(ee!==void 0){var ce=Ii,ye=r;switch(r){case"keypress":if(Ti(a)===0)break e;case"keydown":case"keyup":ce=Ze;break;case"focusin":ye="focus",ce=Ft;break;case"focusout":ye="blur",ce=Ft;break;case"beforeblur":case"afterblur":ce=Ft;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=Oa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=ac;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=vr;break;case vm:case wm:case Em:ce=cc;break;case Tm:ce=_o;break;case"scroll":ce=po;break;case"wheel":ce=sE;break;case"copy":case"cut":case"paste":ce=c;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=Sn}var _e=(i&4)!==0,vt=!_e&&r==="scroll",U=_e?ee!==null?ee+"Capture":null:ee;_e=[];for(var F=W,z;F!==null;){z=F;var se=z.stateNode;if(z.tag===5&&se!==null&&(z=se,U!==null&&(se=hi(F,U),se!=null&&_e.push(qa(F,se,z)))),vt)break;F=F.return}0<_e.length&&(ee=new ce(ee,ye,null,a,te),ne.push({event:ee,listeners:_e}))}}if((i&7)===0){e:{if(ee=r==="mouseover"||r==="pointerover",ce=r==="mouseout"||r==="pointerout",ee&&a!==ds&&(ye=a.relatedTarget||a.fromElement)&&(Ai(ye)||ye[$r]))break e;if((ce||ee)&&(ee=te.window===te?te:(ee=te.ownerDocument)?ee.defaultView||ee.parentWindow:window,ce?(ye=a.relatedTarget||a.toElement,ce=W,ye=ye?Ai(ye):null,ye!==null&&(vt=Hn(ye),ye!==vt||ye.tag!==5&&ye.tag!==6)&&(ye=null)):(ce=null,ye=W),ce!==ye)){if(_e=Oa,se="onMouseLeave",U="onMouseEnter",F="mouse",(r==="pointerout"||r==="pointerover")&&(_e=Sn,se="onPointerLeave",U="onPointerEnter",F="pointer"),vt=ce==null?ee:So(ce),z=ye==null?ee:So(ye),ee=new _e(se,F+"leave",ce,a,te),ee.target=vt,ee.relatedTarget=z,se=null,Ai(te)===W&&(_e=new _e(U,F+"enter",ye,a,te),_e.target=z,_e.relatedTarget=vt,se=_e),vt=se,ce&&ye)t:{for(_e=ce,U=ye,F=0,z=_e;z;z=To(z))F++;for(z=0,se=U;se;se=To(se))z++;for(;0<F-z;)_e=To(_e),F--;for(;0<z-F;)U=To(U),z--;for(;F--;){if(_e===U||U!==null&&_e===U.alternate)break t;_e=To(_e),U=To(U)}_e=null}else _e=null;ce!==null&&xm(ne,ee,ce,_e,!1),ye!==null&&vt!==null&&xm(ne,vt,ye,_e,!0)}}e:{if(ee=W?So(W):window,ce=ee.nodeName&&ee.nodeName.toLowerCase(),ce==="select"||ce==="input"&&ee.type==="file")var Ee=dE;else if(am(ee))if(cm)Ee=mE;else{Ee=fE;var Ce=hE}else(ce=ee.nodeName)&&ce.toLowerCase()==="input"&&(ee.type==="checkbox"||ee.type==="radio")&&(Ee=pE);if(Ee&&(Ee=Ee(r,W))){lm(ne,Ee,a,te);break e}Ce&&Ce(r,ee,W),r==="focusout"&&(Ce=ee._wrapperState)&&Ce.controlled&&ee.type==="number"&&ct(ee,"number",ee.value)}switch(Ce=W?So(W):window,r){case"focusin":(am(Ce)||Ce.contentEditable==="true")&&(wo=Ce,kd=W,Ua=null);break;case"focusout":Ua=kd=wo=null;break;case"mousedown":Nd=!0;break;case"contextmenu":case"mouseup":case"dragend":Nd=!1,ym(ne,a,te);break;case"selectionchange":if(_E)break;case"keydown":case"keyup":ym(ne,a,te)}var Re;if(Rd)e:{switch(r){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else vo?im(r,a)&&(Ne="onCompositionEnd"):r==="keydown"&&a.keyCode===229&&(Ne="onCompositionStart");Ne&&(nm&&a.locale!=="ko"&&(vo||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&vo&&(Re=ic()):(Tn=te,fo="value"in Tn?Tn.value:Tn.textContent,vo=!0)),Ce=pc(W,Ne),0<Ce.length&&(Ne=new _(Ne,r,null,a,te),ne.push({event:Ne,listeners:Ce}),Re?Ne.data=Re:(Re=om(a),Re!==null&&(Ne.data=Re)))),(Re=oE?aE(r,a):lE(r,a))&&(W=pc(W,"onBeforeInput"),0<W.length&&(te=new _("onBeforeInput","beforeinput",null,a,te),ne.push({event:te,listeners:W}),te.data=Re))}Cm(ne,i)})}function qa(r,i,a){return{instance:r,listener:i,currentTarget:a}}function pc(r,i){for(var a=i+"Capture",d=[];r!==null;){var f=r,m=f.stateNode;f.tag===5&&m!==null&&(f=m,m=hi(r,a),m!=null&&d.unshift(qa(r,m,f)),m=hi(r,i),m!=null&&d.push(qa(r,m,f))),r=r.return}return d}function To(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function xm(r,i,a,d,f){for(var m=i._reactName,E=[];a!==null&&a!==d;){var b=a,L=b.alternate,W=b.stateNode;if(L!==null&&L===d)break;b.tag===5&&W!==null&&(b=W,f?(L=hi(a,m),L!=null&&E.unshift(qa(a,L,b))):f||(L=hi(a,m),L!=null&&E.push(qa(a,L,b)))),a=a.return}E.length!==0&&r.push({event:i,listeners:E})}var TE=/\r\n?/g,IE=/\u0000|\uFFFD/g;function bm(r){return(typeof r=="string"?r:""+r).replace(TE,`
`).replace(IE,"")}function mc(r,i,a){if(i=bm(i),bm(r)!==i&&a)throw Error(t(425))}function gc(){}var Ld=null,Fd=null;function Ud(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Bd=typeof setTimeout=="function"?setTimeout:void 0,SE=typeof clearTimeout=="function"?clearTimeout:void 0,Pm=typeof Promise=="function"?Promise:void 0,AE=typeof queueMicrotask=="function"?queueMicrotask:typeof Pm<"u"?function(r){return Pm.resolve(null).then(r).catch(CE)}:Bd;function CE(r){setTimeout(function(){throw r})}function zd(r,i){var a=i,d=0;do{var f=a.nextSibling;if(r.removeChild(a),f&&f.nodeType===8)if(a=f.data,a==="/$"){if(d===0){r.removeChild(f),vs(i);return}d--}else a!=="$"&&a!=="$?"&&a!=="$!"||d++;a=f}while(a);vs(i)}function Is(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function km(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var a=r.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return r;i--}else a==="/$"&&i++}r=r.previousSibling}return null}var Io=Math.random().toString(36).slice(2),Er="__reactFiber$"+Io,$a="__reactProps$"+Io,$r="__reactContainer$"+Io,qd="__reactEvents$"+Io,RE="__reactListeners$"+Io,xE="__reactHandles$"+Io;function Ai(r){var i=r[Er];if(i)return i;for(var a=r.parentNode;a;){if(i=a[$r]||a[Er]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(r=km(r);r!==null;){if(a=r[Er])return a;r=km(r)}return i}r=a,a=r.parentNode}return null}function Wa(r){return r=r[Er]||r[$r],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function So(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function yc(r){return r[$a]||null}var $d=[],Ao=-1;function Ss(r){return{current:r}}function it(r){0>Ao||(r.current=$d[Ao],$d[Ao]=null,Ao--)}function nt(r,i){Ao++,$d[Ao]=r.current,r.current=i}var As={},Yt=Ss(As),un=Ss(!1),Ci=As;function Co(r,i){var a=r.type.contextTypes;if(!a)return As;var d=r.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===i)return d.__reactInternalMemoizedMaskedChildContext;var f={},m;for(m in a)f[m]=i[m];return d&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=f),f}function dn(r){return r=r.childContextTypes,r!=null}function _c(){it(un),it(Yt)}function Nm(r,i,a){if(Yt.current!==As)throw Error(t(168));nt(Yt,i),nt(un,a)}function Dm(r,i,a){var d=r.stateNode;if(i=i.childContextTypes,typeof d.getChildContext!="function")return a;d=d.getChildContext();for(var f in d)if(!(f in i))throw Error(t(108,Ve(r)||"Unknown",f));return ae({},a,d)}function vc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||As,Ci=Yt.current,nt(Yt,r),nt(un,un.current),!0}function Om(r,i,a){var d=r.stateNode;if(!d)throw Error(t(169));a?(r=Dm(r,i,Ci),d.__reactInternalMemoizedMergedChildContext=r,it(un),it(Yt),nt(Yt,r)):it(un),nt(un,a)}var Wr=null,wc=!1,Wd=!1;function Vm(r){Wr===null?Wr=[r]:Wr.push(r)}function bE(r){wc=!0,Vm(r)}function Cs(){if(!Wd&&Wr!==null){Wd=!0;var r=0,i=$e;try{var a=Wr;for($e=1;r<a.length;r++){var d=a[r];do d=d(!0);while(d!==null)}Wr=null,wc=!1}catch(f){throw Wr!==null&&(Wr=Wr.slice(r+1)),Ea(io,Cs),f}finally{$e=i,Wd=!1}}return null}var Ro=[],xo=0,Ec=null,Tc=0,On=[],Vn=0,Ri=null,Hr=1,Gr="";function xi(r,i){Ro[xo++]=Tc,Ro[xo++]=Ec,Ec=r,Tc=i}function jm(r,i,a){On[Vn++]=Hr,On[Vn++]=Gr,On[Vn++]=Ri,Ri=r;var d=Hr;r=Gr;var f=32-wn(d)-1;d&=~(1<<f),a+=1;var m=32-wn(i)+f;if(30<m){var E=f-f%5;m=(d&(1<<E)-1).toString(32),d>>=E,f-=E,Hr=1<<32-wn(i)+f|a<<f|d,Gr=m+r}else Hr=1<<m|a<<f|d,Gr=r}function Hd(r){r.return!==null&&(xi(r,1),jm(r,1,0))}function Gd(r){for(;r===Ec;)Ec=Ro[--xo],Ro[xo]=null,Tc=Ro[--xo],Ro[xo]=null;for(;r===Ri;)Ri=On[--Vn],On[Vn]=null,Gr=On[--Vn],On[Vn]=null,Hr=On[--Vn],On[Vn]=null}var An=null,Cn=null,at=!1,Qn=null;function Mm(r,i){var a=Fn(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=r,i=r.deletions,i===null?(r.deletions=[a],r.flags|=16):i.push(a)}function Lm(r,i){switch(r.tag){case 5:var a=r.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,An=r,Cn=Is(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,An=r,Cn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=Ri!==null?{id:Hr,overflow:Gr}:null,r.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=Fn(18,null,null,0),a.stateNode=i,a.return=r,r.child=a,An=r,Cn=null,!0):!1;default:return!1}}function Kd(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Qd(r){if(at){var i=Cn;if(i){var a=i;if(!Lm(r,i)){if(Kd(r))throw Error(t(418));i=Is(a.nextSibling);var d=An;i&&Lm(r,i)?Mm(d,a):(r.flags=r.flags&-4097|2,at=!1,An=r)}}else{if(Kd(r))throw Error(t(418));r.flags=r.flags&-4097|2,at=!1,An=r}}}function Fm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;An=r}function Ic(r){if(r!==An)return!1;if(!at)return Fm(r),at=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Ud(r.type,r.memoizedProps)),i&&(i=Cn)){if(Kd(r))throw Um(),Error(t(418));for(;i;)Mm(r,i),i=Is(i.nextSibling)}if(Fm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var a=r.data;if(a==="/$"){if(i===0){Cn=Is(r.nextSibling);break e}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}r=r.nextSibling}Cn=null}}else Cn=An?Is(r.stateNode.nextSibling):null;return!0}function Um(){for(var r=Cn;r;)r=Is(r.nextSibling)}function bo(){Cn=An=null,at=!1}function Jd(r){Qn===null?Qn=[r]:Qn.push(r)}var PE=q.ReactCurrentBatchConfig;function Ha(r,i,a){if(r=a.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(t(309));var d=a.stateNode}if(!d)throw Error(t(147,r));var f=d,m=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===m?i.ref:(i=function(E){var b=f.refs;E===null?delete b[m]:b[m]=E},i._stringRef=m,i)}if(typeof r!="string")throw Error(t(284));if(!a._owner)throw Error(t(290,r))}return r}function Sc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function Bm(r){var i=r._init;return i(r._payload)}function zm(r){function i(U,F){if(r){var z=U.deletions;z===null?(U.deletions=[F],U.flags|=16):z.push(F)}}function a(U,F){if(!r)return null;for(;F!==null;)i(U,F),F=F.sibling;return null}function d(U,F){for(U=new Map;F!==null;)F.key!==null?U.set(F.key,F):U.set(F.index,F),F=F.sibling;return U}function f(U,F){return U=Os(U,F),U.index=0,U.sibling=null,U}function m(U,F,z){return U.index=z,r?(z=U.alternate,z!==null?(z=z.index,z<F?(U.flags|=2,F):z):(U.flags|=2,F)):(U.flags|=1048576,F)}function E(U){return r&&U.alternate===null&&(U.flags|=2),U}function b(U,F,z,se){return F===null||F.tag!==6?(F=Bh(z,U.mode,se),F.return=U,F):(F=f(F,z),F.return=U,F)}function L(U,F,z,se){var Ee=z.type;return Ee===I?te(U,F,z.props.children,se,z.key):F!==null&&(F.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===Ke&&Bm(Ee)===F.type)?(se=f(F,z.props),se.ref=Ha(U,F,z),se.return=U,se):(se=Kc(z.type,z.key,z.props,null,U.mode,se),se.ref=Ha(U,F,z),se.return=U,se)}function W(U,F,z,se){return F===null||F.tag!==4||F.stateNode.containerInfo!==z.containerInfo||F.stateNode.implementation!==z.implementation?(F=zh(z,U.mode,se),F.return=U,F):(F=f(F,z.children||[]),F.return=U,F)}function te(U,F,z,se,Ee){return F===null||F.tag!==7?(F=ji(z,U.mode,se,Ee),F.return=U,F):(F=f(F,z),F.return=U,F)}function ne(U,F,z){if(typeof F=="string"&&F!==""||typeof F=="number")return F=Bh(""+F,U.mode,z),F.return=U,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case M:return z=Kc(F.type,F.key,F.props,null,U.mode,z),z.ref=Ha(U,null,F),z.return=U,z;case H:return F=zh(F,U.mode,z),F.return=U,F;case Ke:var se=F._init;return ne(U,se(F._payload),z)}if(ut(F)||ve(F))return F=ji(F,U.mode,z,null),F.return=U,F;Sc(U,F)}return null}function ee(U,F,z,se){var Ee=F!==null?F.key:null;if(typeof z=="string"&&z!==""||typeof z=="number")return Ee!==null?null:b(U,F,""+z,se);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case M:return z.key===Ee?L(U,F,z,se):null;case H:return z.key===Ee?W(U,F,z,se):null;case Ke:return Ee=z._init,ee(U,F,Ee(z._payload),se)}if(ut(z)||ve(z))return Ee!==null?null:te(U,F,z,se,null);Sc(U,z)}return null}function ce(U,F,z,se,Ee){if(typeof se=="string"&&se!==""||typeof se=="number")return U=U.get(z)||null,b(F,U,""+se,Ee);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case M:return U=U.get(se.key===null?z:se.key)||null,L(F,U,se,Ee);case H:return U=U.get(se.key===null?z:se.key)||null,W(F,U,se,Ee);case Ke:var Ce=se._init;return ce(U,F,z,Ce(se._payload),Ee)}if(ut(se)||ve(se))return U=U.get(z)||null,te(F,U,se,Ee,null);Sc(F,se)}return null}function ye(U,F,z,se){for(var Ee=null,Ce=null,Re=F,Ne=F=0,Dt=null;Re!==null&&Ne<z.length;Ne++){Re.index>Ne?(Dt=Re,Re=null):Dt=Re.sibling;var Je=ee(U,Re,z[Ne],se);if(Je===null){Re===null&&(Re=Dt);break}r&&Re&&Je.alternate===null&&i(U,Re),F=m(Je,F,Ne),Ce===null?Ee=Je:Ce.sibling=Je,Ce=Je,Re=Dt}if(Ne===z.length)return a(U,Re),at&&xi(U,Ne),Ee;if(Re===null){for(;Ne<z.length;Ne++)Re=ne(U,z[Ne],se),Re!==null&&(F=m(Re,F,Ne),Ce===null?Ee=Re:Ce.sibling=Re,Ce=Re);return at&&xi(U,Ne),Ee}for(Re=d(U,Re);Ne<z.length;Ne++)Dt=ce(Re,U,Ne,z[Ne],se),Dt!==null&&(r&&Dt.alternate!==null&&Re.delete(Dt.key===null?Ne:Dt.key),F=m(Dt,F,Ne),Ce===null?Ee=Dt:Ce.sibling=Dt,Ce=Dt);return r&&Re.forEach(function(Vs){return i(U,Vs)}),at&&xi(U,Ne),Ee}function _e(U,F,z,se){var Ee=ve(z);if(typeof Ee!="function")throw Error(t(150));if(z=Ee.call(z),z==null)throw Error(t(151));for(var Ce=Ee=null,Re=F,Ne=F=0,Dt=null,Je=z.next();Re!==null&&!Je.done;Ne++,Je=z.next()){Re.index>Ne?(Dt=Re,Re=null):Dt=Re.sibling;var Vs=ee(U,Re,Je.value,se);if(Vs===null){Re===null&&(Re=Dt);break}r&&Re&&Vs.alternate===null&&i(U,Re),F=m(Vs,F,Ne),Ce===null?Ee=Vs:Ce.sibling=Vs,Ce=Vs,Re=Dt}if(Je.done)return a(U,Re),at&&xi(U,Ne),Ee;if(Re===null){for(;!Je.done;Ne++,Je=z.next())Je=ne(U,Je.value,se),Je!==null&&(F=m(Je,F,Ne),Ce===null?Ee=Je:Ce.sibling=Je,Ce=Je);return at&&xi(U,Ne),Ee}for(Re=d(U,Re);!Je.done;Ne++,Je=z.next())Je=ce(Re,U,Ne,Je.value,se),Je!==null&&(r&&Je.alternate!==null&&Re.delete(Je.key===null?Ne:Je.key),F=m(Je,F,Ne),Ce===null?Ee=Je:Ce.sibling=Je,Ce=Je);return r&&Re.forEach(function(cT){return i(U,cT)}),at&&xi(U,Ne),Ee}function vt(U,F,z,se){if(typeof z=="object"&&z!==null&&z.type===I&&z.key===null&&(z=z.props.children),typeof z=="object"&&z!==null){switch(z.$$typeof){case M:e:{for(var Ee=z.key,Ce=F;Ce!==null;){if(Ce.key===Ee){if(Ee=z.type,Ee===I){if(Ce.tag===7){a(U,Ce.sibling),F=f(Ce,z.props.children),F.return=U,U=F;break e}}else if(Ce.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===Ke&&Bm(Ee)===Ce.type){a(U,Ce.sibling),F=f(Ce,z.props),F.ref=Ha(U,Ce,z),F.return=U,U=F;break e}a(U,Ce);break}else i(U,Ce);Ce=Ce.sibling}z.type===I?(F=ji(z.props.children,U.mode,se,z.key),F.return=U,U=F):(se=Kc(z.type,z.key,z.props,null,U.mode,se),se.ref=Ha(U,F,z),se.return=U,U=se)}return E(U);case H:e:{for(Ce=z.key;F!==null;){if(F.key===Ce)if(F.tag===4&&F.stateNode.containerInfo===z.containerInfo&&F.stateNode.implementation===z.implementation){a(U,F.sibling),F=f(F,z.children||[]),F.return=U,U=F;break e}else{a(U,F);break}else i(U,F);F=F.sibling}F=zh(z,U.mode,se),F.return=U,U=F}return E(U);case Ke:return Ce=z._init,vt(U,F,Ce(z._payload),se)}if(ut(z))return ye(U,F,z,se);if(ve(z))return _e(U,F,z,se);Sc(U,z)}return typeof z=="string"&&z!==""||typeof z=="number"?(z=""+z,F!==null&&F.tag===6?(a(U,F.sibling),F=f(F,z),F.return=U,U=F):(a(U,F),F=Bh(z,U.mode,se),F.return=U,U=F),E(U)):a(U,F)}return vt}var Po=zm(!0),qm=zm(!1),Ac=Ss(null),Cc=null,ko=null,Xd=null;function Yd(){Xd=ko=Cc=null}function Zd(r){var i=Ac.current;it(Ac),r._currentValue=i}function eh(r,i,a){for(;r!==null;){var d=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),r===a)break;r=r.return}}function No(r,i){Cc=r,Xd=ko=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(hn=!0),r.firstContext=null)}function jn(r){var i=r._currentValue;if(Xd!==r)if(r={context:r,memoizedValue:i,next:null},ko===null){if(Cc===null)throw Error(t(308));ko=r,Cc.dependencies={lanes:0,firstContext:r}}else ko=ko.next=r;return i}var bi=null;function th(r){bi===null?bi=[r]:bi.push(r)}function $m(r,i,a,d){var f=i.interleaved;return f===null?(a.next=a,th(i)):(a.next=f.next,f.next=a),i.interleaved=a,Kr(r,d)}function Kr(r,i){r.lanes|=i;var a=r.alternate;for(a!==null&&(a.lanes|=i),a=r,r=r.return;r!==null;)r.childLanes|=i,a=r.alternate,a!==null&&(a.childLanes|=i),a=r,r=r.return;return a.tag===3?a.stateNode:null}var Rs=!1;function nh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wm(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Qr(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function xs(r,i,a){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(Qe&2)!==0){var f=d.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),d.pending=i,Kr(r,a)}return f=d.interleaved,f===null?(i.next=i,th(d)):(i.next=f.next,f.next=i),d.interleaved=i,Kr(r,a)}function Rc(r,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var d=i.lanes;d&=r.pendingLanes,a|=d,i.lanes=a,Ra(r,a)}}function Hm(r,i){var a=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,a===d)){var f=null,m=null;if(a=a.firstBaseUpdate,a!==null){do{var E={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};m===null?f=m=E:m=m.next=E,a=a.next}while(a!==null);m===null?f=m=i:m=m.next=i}else f=m=i;a={baseState:d.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:d.shared,effects:d.effects},r.updateQueue=a;return}r=a.lastBaseUpdate,r===null?a.firstBaseUpdate=i:r.next=i,a.lastBaseUpdate=i}function xc(r,i,a,d){var f=r.updateQueue;Rs=!1;var m=f.firstBaseUpdate,E=f.lastBaseUpdate,b=f.shared.pending;if(b!==null){f.shared.pending=null;var L=b,W=L.next;L.next=null,E===null?m=W:E.next=W,E=L;var te=r.alternate;te!==null&&(te=te.updateQueue,b=te.lastBaseUpdate,b!==E&&(b===null?te.firstBaseUpdate=W:b.next=W,te.lastBaseUpdate=L))}if(m!==null){var ne=f.baseState;E=0,te=W=L=null,b=m;do{var ee=b.lane,ce=b.eventTime;if((d&ee)===ee){te!==null&&(te=te.next={eventTime:ce,lane:0,tag:b.tag,payload:b.payload,callback:b.callback,next:null});e:{var ye=r,_e=b;switch(ee=i,ce=a,_e.tag){case 1:if(ye=_e.payload,typeof ye=="function"){ne=ye.call(ce,ne,ee);break e}ne=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=_e.payload,ee=typeof ye=="function"?ye.call(ce,ne,ee):ye,ee==null)break e;ne=ae({},ne,ee);break e;case 2:Rs=!0}}b.callback!==null&&b.lane!==0&&(r.flags|=64,ee=f.effects,ee===null?f.effects=[b]:ee.push(b))}else ce={eventTime:ce,lane:ee,tag:b.tag,payload:b.payload,callback:b.callback,next:null},te===null?(W=te=ce,L=ne):te=te.next=ce,E|=ee;if(b=b.next,b===null){if(b=f.shared.pending,b===null)break;ee=b,b=ee.next,ee.next=null,f.lastBaseUpdate=ee,f.shared.pending=null}}while(!0);if(te===null&&(L=ne),f.baseState=L,f.firstBaseUpdate=W,f.lastBaseUpdate=te,i=f.shared.interleaved,i!==null){f=i;do E|=f.lane,f=f.next;while(f!==i)}else m===null&&(f.shared.lanes=0);Ni|=E,r.lanes=E,r.memoizedState=ne}}function Gm(r,i,a){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var d=r[i],f=d.callback;if(f!==null){if(d.callback=null,d=a,typeof f!="function")throw Error(t(191,f));f.call(d)}}}var Ga={},Tr=Ss(Ga),Ka=Ss(Ga),Qa=Ss(Ga);function Pi(r){if(r===Ga)throw Error(t(174));return r}function rh(r,i){switch(nt(Qa,i),nt(Ka,r),nt(Tr,Ga),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:_n(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=_n(i,r)}it(Tr),nt(Tr,i)}function Do(){it(Tr),it(Ka),it(Qa)}function Km(r){Pi(Qa.current);var i=Pi(Tr.current),a=_n(i,r.type);i!==a&&(nt(Ka,r),nt(Tr,a))}function sh(r){Ka.current===r&&(it(Tr),it(Ka))}var dt=Ss(0);function bc(r){for(var i=r;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var ih=[];function oh(){for(var r=0;r<ih.length;r++)ih[r]._workInProgressVersionPrimary=null;ih.length=0}var Pc=q.ReactCurrentDispatcher,ah=q.ReactCurrentBatchConfig,ki=0,ht=null,xt=null,kt=null,kc=!1,Ja=!1,Xa=0,kE=0;function Zt(){throw Error(t(321))}function lh(r,i){if(i===null)return!1;for(var a=0;a<i.length&&a<r.length;a++)if(!Kn(r[a],i[a]))return!1;return!0}function ch(r,i,a,d,f,m){if(ki=m,ht=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Pc.current=r===null||r.memoizedState===null?VE:jE,r=a(d,f),Ja){m=0;do{if(Ja=!1,Xa=0,25<=m)throw Error(t(301));m+=1,kt=xt=null,i.updateQueue=null,Pc.current=ME,r=a(d,f)}while(Ja)}if(Pc.current=Oc,i=xt!==null&&xt.next!==null,ki=0,kt=xt=ht=null,kc=!1,i)throw Error(t(300));return r}function uh(){var r=Xa!==0;return Xa=0,r}function Ir(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kt===null?ht.memoizedState=kt=r:kt=kt.next=r,kt}function Mn(){if(xt===null){var r=ht.alternate;r=r!==null?r.memoizedState:null}else r=xt.next;var i=kt===null?ht.memoizedState:kt.next;if(i!==null)kt=i,xt=r;else{if(r===null)throw Error(t(310));xt=r,r={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},kt===null?ht.memoizedState=kt=r:kt=kt.next=r}return kt}function Ya(r,i){return typeof i=="function"?i(r):i}function dh(r){var i=Mn(),a=i.queue;if(a===null)throw Error(t(311));a.lastRenderedReducer=r;var d=xt,f=d.baseQueue,m=a.pending;if(m!==null){if(f!==null){var E=f.next;f.next=m.next,m.next=E}d.baseQueue=f=m,a.pending=null}if(f!==null){m=f.next,d=d.baseState;var b=E=null,L=null,W=m;do{var te=W.lane;if((ki&te)===te)L!==null&&(L=L.next={lane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),d=W.hasEagerState?W.eagerState:r(d,W.action);else{var ne={lane:te,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null};L===null?(b=L=ne,E=d):L=L.next=ne,ht.lanes|=te,Ni|=te}W=W.next}while(W!==null&&W!==m);L===null?E=d:L.next=b,Kn(d,i.memoizedState)||(hn=!0),i.memoizedState=d,i.baseState=E,i.baseQueue=L,a.lastRenderedState=d}if(r=a.interleaved,r!==null){f=r;do m=f.lane,ht.lanes|=m,Ni|=m,f=f.next;while(f!==r)}else f===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function hh(r){var i=Mn(),a=i.queue;if(a===null)throw Error(t(311));a.lastRenderedReducer=r;var d=a.dispatch,f=a.pending,m=i.memoizedState;if(f!==null){a.pending=null;var E=f=f.next;do m=r(m,E.action),E=E.next;while(E!==f);Kn(m,i.memoizedState)||(hn=!0),i.memoizedState=m,i.baseQueue===null&&(i.baseState=m),a.lastRenderedState=m}return[m,d]}function Qm(){}function Jm(r,i){var a=ht,d=Mn(),f=i(),m=!Kn(d.memoizedState,f);if(m&&(d.memoizedState=f,hn=!0),d=d.queue,fh(Zm.bind(null,a,d,r),[r]),d.getSnapshot!==i||m||kt!==null&&kt.memoizedState.tag&1){if(a.flags|=2048,Za(9,Ym.bind(null,a,d,f,i),void 0,null),Nt===null)throw Error(t(349));(ki&30)!==0||Xm(a,i,f)}return f}function Xm(r,i,a){r.flags|=16384,r={getSnapshot:i,value:a},i=ht.updateQueue,i===null?(i={lastEffect:null,stores:null},ht.updateQueue=i,i.stores=[r]):(a=i.stores,a===null?i.stores=[r]:a.push(r))}function Ym(r,i,a,d){i.value=a,i.getSnapshot=d,eg(i)&&tg(r)}function Zm(r,i,a){return a(function(){eg(i)&&tg(r)})}function eg(r){var i=r.getSnapshot;r=r.value;try{var a=i();return!Kn(r,a)}catch{return!0}}function tg(r){var i=Kr(r,1);i!==null&&Zn(i,r,1,-1)}function ng(r){var i=Ir();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ya,lastRenderedState:r},i.queue=r,r=r.dispatch=OE.bind(null,ht,r),[i.memoizedState,r]}function Za(r,i,a,d){return r={tag:r,create:i,destroy:a,deps:d,next:null},i=ht.updateQueue,i===null?(i={lastEffect:null,stores:null},ht.updateQueue=i,i.lastEffect=r.next=r):(a=i.lastEffect,a===null?i.lastEffect=r.next=r:(d=a.next,a.next=r,r.next=d,i.lastEffect=r)),r}function rg(){return Mn().memoizedState}function Nc(r,i,a,d){var f=Ir();ht.flags|=r,f.memoizedState=Za(1|i,a,void 0,d===void 0?null:d)}function Dc(r,i,a,d){var f=Mn();d=d===void 0?null:d;var m=void 0;if(xt!==null){var E=xt.memoizedState;if(m=E.destroy,d!==null&&lh(d,E.deps)){f.memoizedState=Za(i,a,m,d);return}}ht.flags|=r,f.memoizedState=Za(1|i,a,m,d)}function sg(r,i){return Nc(8390656,8,r,i)}function fh(r,i){return Dc(2048,8,r,i)}function ig(r,i){return Dc(4,2,r,i)}function og(r,i){return Dc(4,4,r,i)}function ag(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function lg(r,i,a){return a=a!=null?a.concat([r]):null,Dc(4,4,ag.bind(null,i,r),a)}function ph(){}function cg(r,i){var a=Mn();i=i===void 0?null:i;var d=a.memoizedState;return d!==null&&i!==null&&lh(i,d[1])?d[0]:(a.memoizedState=[r,i],r)}function ug(r,i){var a=Mn();i=i===void 0?null:i;var d=a.memoizedState;return d!==null&&i!==null&&lh(i,d[1])?d[0]:(r=r(),a.memoizedState=[r,i],r)}function dg(r,i,a){return(ki&21)===0?(r.baseState&&(r.baseState=!1,hn=!0),r.memoizedState=a):(Kn(a,i)||(a=Aa(),ht.lanes|=a,Ni|=a,r.baseState=!0),i)}function NE(r,i){var a=$e;$e=a!==0&&4>a?a:4,r(!0);var d=ah.transition;ah.transition={};try{r(!1),i()}finally{$e=a,ah.transition=d}}function hg(){return Mn().memoizedState}function DE(r,i,a){var d=Ns(r);if(a={lane:d,action:a,hasEagerState:!1,eagerState:null,next:null},fg(r))pg(i,a);else if(a=$m(r,i,a,d),a!==null){var f=an();Zn(a,r,d,f),mg(a,i,d)}}function OE(r,i,a){var d=Ns(r),f={lane:d,action:a,hasEagerState:!1,eagerState:null,next:null};if(fg(r))pg(i,f);else{var m=r.alternate;if(r.lanes===0&&(m===null||m.lanes===0)&&(m=i.lastRenderedReducer,m!==null))try{var E=i.lastRenderedState,b=m(E,a);if(f.hasEagerState=!0,f.eagerState=b,Kn(b,E)){var L=i.interleaved;L===null?(f.next=f,th(i)):(f.next=L.next,L.next=f),i.interleaved=f;return}}catch{}a=$m(r,i,f,d),a!==null&&(f=an(),Zn(a,r,d,f),mg(a,i,d))}}function fg(r){var i=r.alternate;return r===ht||i!==null&&i===ht}function pg(r,i){Ja=kc=!0;var a=r.pending;a===null?i.next=i:(i.next=a.next,a.next=i),r.pending=i}function mg(r,i,a){if((a&4194240)!==0){var d=i.lanes;d&=r.pendingLanes,a|=d,i.lanes=a,Ra(r,a)}}var Oc={readContext:jn,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},VE={readContext:jn,useCallback:function(r,i){return Ir().memoizedState=[r,i===void 0?null:i],r},useContext:jn,useEffect:sg,useImperativeHandle:function(r,i,a){return a=a!=null?a.concat([r]):null,Nc(4194308,4,ag.bind(null,i,r),a)},useLayoutEffect:function(r,i){return Nc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Nc(4,2,r,i)},useMemo:function(r,i){var a=Ir();return i=i===void 0?null:i,r=r(),a.memoizedState=[r,i],r},useReducer:function(r,i,a){var d=Ir();return i=a!==void 0?a(i):i,d.memoizedState=d.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},d.queue=r,r=r.dispatch=DE.bind(null,ht,r),[d.memoizedState,r]},useRef:function(r){var i=Ir();return r={current:r},i.memoizedState=r},useState:ng,useDebugValue:ph,useDeferredValue:function(r){return Ir().memoizedState=r},useTransition:function(){var r=ng(!1),i=r[0];return r=NE.bind(null,r[1]),Ir().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,a){var d=ht,f=Ir();if(at){if(a===void 0)throw Error(t(407));a=a()}else{if(a=i(),Nt===null)throw Error(t(349));(ki&30)!==0||Xm(d,i,a)}f.memoizedState=a;var m={value:a,getSnapshot:i};return f.queue=m,sg(Zm.bind(null,d,m,r),[r]),d.flags|=2048,Za(9,Ym.bind(null,d,m,a,i),void 0,null),a},useId:function(){var r=Ir(),i=Nt.identifierPrefix;if(at){var a=Gr,d=Hr;a=(d&~(1<<32-wn(d)-1)).toString(32)+a,i=":"+i+"R"+a,a=Xa++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=kE++,i=":"+i+"r"+a.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},jE={readContext:jn,useCallback:cg,useContext:jn,useEffect:fh,useImperativeHandle:lg,useInsertionEffect:ig,useLayoutEffect:og,useMemo:ug,useReducer:dh,useRef:rg,useState:function(){return dh(Ya)},useDebugValue:ph,useDeferredValue:function(r){var i=Mn();return dg(i,xt.memoizedState,r)},useTransition:function(){var r=dh(Ya)[0],i=Mn().memoizedState;return[r,i]},useMutableSource:Qm,useSyncExternalStore:Jm,useId:hg,unstable_isNewReconciler:!1},ME={readContext:jn,useCallback:cg,useContext:jn,useEffect:fh,useImperativeHandle:lg,useInsertionEffect:ig,useLayoutEffect:og,useMemo:ug,useReducer:hh,useRef:rg,useState:function(){return hh(Ya)},useDebugValue:ph,useDeferredValue:function(r){var i=Mn();return xt===null?i.memoizedState=r:dg(i,xt.memoizedState,r)},useTransition:function(){var r=hh(Ya)[0],i=Mn().memoizedState;return[r,i]},useMutableSource:Qm,useSyncExternalStore:Jm,useId:hg,unstable_isNewReconciler:!1};function Jn(r,i){if(r&&r.defaultProps){i=ae({},i),r=r.defaultProps;for(var a in r)i[a]===void 0&&(i[a]=r[a]);return i}return i}function mh(r,i,a,d){i=r.memoizedState,a=a(d,i),a=a==null?i:ae({},i,a),r.memoizedState=a,r.lanes===0&&(r.updateQueue.baseState=a)}var Vc={isMounted:function(r){return(r=r._reactInternals)?Hn(r)===r:!1},enqueueSetState:function(r,i,a){r=r._reactInternals;var d=an(),f=Ns(r),m=Qr(d,f);m.payload=i,a!=null&&(m.callback=a),i=xs(r,m,f),i!==null&&(Zn(i,r,f,d),Rc(i,r,f))},enqueueReplaceState:function(r,i,a){r=r._reactInternals;var d=an(),f=Ns(r),m=Qr(d,f);m.tag=1,m.payload=i,a!=null&&(m.callback=a),i=xs(r,m,f),i!==null&&(Zn(i,r,f,d),Rc(i,r,f))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var a=an(),d=Ns(r),f=Qr(a,d);f.tag=2,i!=null&&(f.callback=i),i=xs(r,f,d),i!==null&&(Zn(i,r,d,a),Rc(i,r,d))}};function gg(r,i,a,d,f,m,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,m,E):i.prototype&&i.prototype.isPureReactComponent?!Fa(a,d)||!Fa(f,m):!0}function yg(r,i,a){var d=!1,f=As,m=i.contextType;return typeof m=="object"&&m!==null?m=jn(m):(f=dn(i)?Ci:Yt.current,d=i.contextTypes,m=(d=d!=null)?Co(r,f):As),i=new i(a,m),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Vc,r.stateNode=i,i._reactInternals=r,d&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=f,r.__reactInternalMemoizedMaskedChildContext=m),i}function _g(r,i,a,d){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,d),i.state!==r&&Vc.enqueueReplaceState(i,i.state,null)}function gh(r,i,a,d){var f=r.stateNode;f.props=a,f.state=r.memoizedState,f.refs={},nh(r);var m=i.contextType;typeof m=="object"&&m!==null?f.context=jn(m):(m=dn(i)?Ci:Yt.current,f.context=Co(r,m)),f.state=r.memoizedState,m=i.getDerivedStateFromProps,typeof m=="function"&&(mh(r,i,m,a),f.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(i=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),i!==f.state&&Vc.enqueueReplaceState(f,f.state,null),xc(r,a,f,d),f.state=r.memoizedState),typeof f.componentDidMount=="function"&&(r.flags|=4194308)}function Oo(r,i){try{var a="",d=i;do a+=Te(d),d=d.return;while(d);var f=a}catch(m){f=`
Error generating stack: `+m.message+`
`+m.stack}return{value:r,source:i,stack:f,digest:null}}function yh(r,i,a){return{value:r,source:null,stack:a??null,digest:i??null}}function _h(r,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var LE=typeof WeakMap=="function"?WeakMap:Map;function vg(r,i,a){a=Qr(-1,a),a.tag=3,a.payload={element:null};var d=i.value;return a.callback=function(){zc||(zc=!0,Dh=d),_h(r,i)},a}function wg(r,i,a){a=Qr(-1,a),a.tag=3;var d=r.type.getDerivedStateFromError;if(typeof d=="function"){var f=i.value;a.payload=function(){return d(f)},a.callback=function(){_h(r,i)}}var m=r.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(a.callback=function(){_h(r,i),typeof d!="function"&&(Ps===null?Ps=new Set([this]):Ps.add(this));var E=i.stack;this.componentDidCatch(i.value,{componentStack:E!==null?E:""})}),a}function Eg(r,i,a){var d=r.pingCache;if(d===null){d=r.pingCache=new LE;var f=new Set;d.set(i,f)}else f=d.get(i),f===void 0&&(f=new Set,d.set(i,f));f.has(a)||(f.add(a),r=YE.bind(null,r,i,a),i.then(r,r))}function Tg(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function Ig(r,i,a,d,f){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=Qr(-1,1),i.tag=2,xs(a,i,1))),a.lanes|=1),r):(r.flags|=65536,r.lanes=f,r)}var FE=q.ReactCurrentOwner,hn=!1;function on(r,i,a,d){i.child=r===null?qm(i,null,a,d):Po(i,r.child,a,d)}function Sg(r,i,a,d,f){a=a.render;var m=i.ref;return No(i,f),d=ch(r,i,a,d,m,f),a=uh(),r!==null&&!hn?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~f,Jr(r,i,f)):(at&&a&&Hd(i),i.flags|=1,on(r,i,d,f),i.child)}function Ag(r,i,a,d,f){if(r===null){var m=a.type;return typeof m=="function"&&!Uh(m)&&m.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=m,Cg(r,i,m,d,f)):(r=Kc(a.type,null,d,i,i.mode,f),r.ref=i.ref,r.return=i,i.child=r)}if(m=r.child,(r.lanes&f)===0){var E=m.memoizedProps;if(a=a.compare,a=a!==null?a:Fa,a(E,d)&&r.ref===i.ref)return Jr(r,i,f)}return i.flags|=1,r=Os(m,d),r.ref=i.ref,r.return=i,i.child=r}function Cg(r,i,a,d,f){if(r!==null){var m=r.memoizedProps;if(Fa(m,d)&&r.ref===i.ref)if(hn=!1,i.pendingProps=d=m,(r.lanes&f)!==0)(r.flags&131072)!==0&&(hn=!0);else return i.lanes=r.lanes,Jr(r,i,f)}return vh(r,i,a,d,f)}function Rg(r,i,a){var d=i.pendingProps,f=d.children,m=r!==null?r.memoizedState:null;if(d.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(jo,Rn),Rn|=a;else{if((a&1073741824)===0)return r=m!==null?m.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,nt(jo,Rn),Rn|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=m!==null?m.baseLanes:a,nt(jo,Rn),Rn|=d}else m!==null?(d=m.baseLanes|a,i.memoizedState=null):d=a,nt(jo,Rn),Rn|=d;return on(r,i,f,a),i.child}function xg(r,i){var a=i.ref;(r===null&&a!==null||r!==null&&r.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function vh(r,i,a,d,f){var m=dn(a)?Ci:Yt.current;return m=Co(i,m),No(i,f),a=ch(r,i,a,d,m,f),d=uh(),r!==null&&!hn?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~f,Jr(r,i,f)):(at&&d&&Hd(i),i.flags|=1,on(r,i,a,f),i.child)}function bg(r,i,a,d,f){if(dn(a)){var m=!0;vc(i)}else m=!1;if(No(i,f),i.stateNode===null)Mc(r,i),yg(i,a,d),gh(i,a,d,f),d=!0;else if(r===null){var E=i.stateNode,b=i.memoizedProps;E.props=b;var L=E.context,W=a.contextType;typeof W=="object"&&W!==null?W=jn(W):(W=dn(a)?Ci:Yt.current,W=Co(i,W));var te=a.getDerivedStateFromProps,ne=typeof te=="function"||typeof E.getSnapshotBeforeUpdate=="function";ne||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(b!==d||L!==W)&&_g(i,E,d,W),Rs=!1;var ee=i.memoizedState;E.state=ee,xc(i,d,E,f),L=i.memoizedState,b!==d||ee!==L||un.current||Rs?(typeof te=="function"&&(mh(i,a,te,d),L=i.memoizedState),(b=Rs||gg(i,a,b,d,ee,L,W))?(ne||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(i.flags|=4194308)):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=L),E.props=d,E.state=L,E.context=W,d=b):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{E=i.stateNode,Wm(r,i),b=i.memoizedProps,W=i.type===i.elementType?b:Jn(i.type,b),E.props=W,ne=i.pendingProps,ee=E.context,L=a.contextType,typeof L=="object"&&L!==null?L=jn(L):(L=dn(a)?Ci:Yt.current,L=Co(i,L));var ce=a.getDerivedStateFromProps;(te=typeof ce=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(b!==ne||ee!==L)&&_g(i,E,d,L),Rs=!1,ee=i.memoizedState,E.state=ee,xc(i,d,E,f);var ye=i.memoizedState;b!==ne||ee!==ye||un.current||Rs?(typeof ce=="function"&&(mh(i,a,ce,d),ye=i.memoizedState),(W=Rs||gg(i,a,W,d,ee,ye,L)||!1)?(te||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(d,ye,L),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(d,ye,L)),typeof E.componentDidUpdate=="function"&&(i.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof E.componentDidUpdate!="function"||b===r.memoizedProps&&ee===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||b===r.memoizedProps&&ee===r.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=ye),E.props=d,E.state=ye,E.context=L,d=W):(typeof E.componentDidUpdate!="function"||b===r.memoizedProps&&ee===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||b===r.memoizedProps&&ee===r.memoizedState||(i.flags|=1024),d=!1)}return wh(r,i,a,d,m,f)}function wh(r,i,a,d,f,m){xg(r,i);var E=(i.flags&128)!==0;if(!d&&!E)return f&&Om(i,a,!1),Jr(r,i,m);d=i.stateNode,FE.current=i;var b=E&&typeof a.getDerivedStateFromError!="function"?null:d.render();return i.flags|=1,r!==null&&E?(i.child=Po(i,r.child,null,m),i.child=Po(i,null,b,m)):on(r,i,b,m),i.memoizedState=d.state,f&&Om(i,a,!0),i.child}function Pg(r){var i=r.stateNode;i.pendingContext?Nm(r,i.pendingContext,i.pendingContext!==i.context):i.context&&Nm(r,i.context,!1),rh(r,i.containerInfo)}function kg(r,i,a,d,f){return bo(),Jd(f),i.flags|=256,on(r,i,a,d),i.child}var Eh={dehydrated:null,treeContext:null,retryLane:0};function Th(r){return{baseLanes:r,cachePool:null,transitions:null}}function Ng(r,i,a){var d=i.pendingProps,f=dt.current,m=!1,E=(i.flags&128)!==0,b;if((b=E)||(b=r!==null&&r.memoizedState===null?!1:(f&2)!==0),b?(m=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(f|=1),nt(dt,f&1),r===null)return Qd(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(E=d.children,r=d.fallback,m?(d=i.mode,m=i.child,E={mode:"hidden",children:E},(d&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=E):m=Qc(E,d,0,null),r=ji(r,d,a,null),m.return=i,r.return=i,m.sibling=r,i.child=m,i.child.memoizedState=Th(a),i.memoizedState=Eh,r):Ih(i,E));if(f=r.memoizedState,f!==null&&(b=f.dehydrated,b!==null))return UE(r,i,E,d,b,f,a);if(m){m=d.fallback,E=i.mode,f=r.child,b=f.sibling;var L={mode:"hidden",children:d.children};return(E&1)===0&&i.child!==f?(d=i.child,d.childLanes=0,d.pendingProps=L,i.deletions=null):(d=Os(f,L),d.subtreeFlags=f.subtreeFlags&14680064),b!==null?m=Os(b,m):(m=ji(m,E,a,null),m.flags|=2),m.return=i,d.return=i,d.sibling=m,i.child=d,d=m,m=i.child,E=r.child.memoizedState,E=E===null?Th(a):{baseLanes:E.baseLanes|a,cachePool:null,transitions:E.transitions},m.memoizedState=E,m.childLanes=r.childLanes&~a,i.memoizedState=Eh,d}return m=r.child,r=m.sibling,d=Os(m,{mode:"visible",children:d.children}),(i.mode&1)===0&&(d.lanes=a),d.return=i,d.sibling=null,r!==null&&(a=i.deletions,a===null?(i.deletions=[r],i.flags|=16):a.push(r)),i.child=d,i.memoizedState=null,d}function Ih(r,i){return i=Qc({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function jc(r,i,a,d){return d!==null&&Jd(d),Po(i,r.child,null,a),r=Ih(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function UE(r,i,a,d,f,m,E){if(a)return i.flags&256?(i.flags&=-257,d=yh(Error(t(422))),jc(r,i,E,d)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(m=d.fallback,f=i.mode,d=Qc({mode:"visible",children:d.children},f,0,null),m=ji(m,f,E,null),m.flags|=2,d.return=i,m.return=i,d.sibling=m,i.child=d,(i.mode&1)!==0&&Po(i,r.child,null,E),i.child.memoizedState=Th(E),i.memoizedState=Eh,m);if((i.mode&1)===0)return jc(r,i,E,null);if(f.data==="$!"){if(d=f.nextSibling&&f.nextSibling.dataset,d)var b=d.dgst;return d=b,m=Error(t(419)),d=yh(m,d,void 0),jc(r,i,E,d)}if(b=(E&r.childLanes)!==0,hn||b){if(d=Nt,d!==null){switch(E&-E){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=(f&(d.suspendedLanes|E))!==0?0:f,f!==0&&f!==m.retryLane&&(m.retryLane=f,Kr(r,f),Zn(d,r,f,-1))}return Fh(),d=yh(Error(t(421))),jc(r,i,E,d)}return f.data==="$?"?(i.flags|=128,i.child=r.child,i=ZE.bind(null,r),f._reactRetry=i,null):(r=m.treeContext,Cn=Is(f.nextSibling),An=i,at=!0,Qn=null,r!==null&&(On[Vn++]=Hr,On[Vn++]=Gr,On[Vn++]=Ri,Hr=r.id,Gr=r.overflow,Ri=i),i=Ih(i,d.children),i.flags|=4096,i)}function Dg(r,i,a){r.lanes|=i;var d=r.alternate;d!==null&&(d.lanes|=i),eh(r.return,i,a)}function Sh(r,i,a,d,f){var m=r.memoizedState;m===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:a,tailMode:f}:(m.isBackwards=i,m.rendering=null,m.renderingStartTime=0,m.last=d,m.tail=a,m.tailMode=f)}function Og(r,i,a){var d=i.pendingProps,f=d.revealOrder,m=d.tail;if(on(r,i,d.children,a),d=dt.current,(d&2)!==0)d=d&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Dg(r,a,i);else if(r.tag===19)Dg(r,a,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}d&=1}if(nt(dt,d),(i.mode&1)===0)i.memoizedState=null;else switch(f){case"forwards":for(a=i.child,f=null;a!==null;)r=a.alternate,r!==null&&bc(r)===null&&(f=a),a=a.sibling;a=f,a===null?(f=i.child,i.child=null):(f=a.sibling,a.sibling=null),Sh(i,!1,f,a,m);break;case"backwards":for(a=null,f=i.child,i.child=null;f!==null;){if(r=f.alternate,r!==null&&bc(r)===null){i.child=f;break}r=f.sibling,f.sibling=a,a=f,f=r}Sh(i,!0,a,null,m);break;case"together":Sh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Mc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function Jr(r,i,a){if(r!==null&&(i.dependencies=r.dependencies),Ni|=i.lanes,(a&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,a=Os(r,r.pendingProps),i.child=a,a.return=i;r.sibling!==null;)r=r.sibling,a=a.sibling=Os(r,r.pendingProps),a.return=i;a.sibling=null}return i.child}function BE(r,i,a){switch(i.tag){case 3:Pg(i),bo();break;case 5:Km(i);break;case 1:dn(i.type)&&vc(i);break;case 4:rh(i,i.stateNode.containerInfo);break;case 10:var d=i.type._context,f=i.memoizedProps.value;nt(Ac,d._currentValue),d._currentValue=f;break;case 13:if(d=i.memoizedState,d!==null)return d.dehydrated!==null?(nt(dt,dt.current&1),i.flags|=128,null):(a&i.child.childLanes)!==0?Ng(r,i,a):(nt(dt,dt.current&1),r=Jr(r,i,a),r!==null?r.sibling:null);nt(dt,dt.current&1);break;case 19:if(d=(a&i.childLanes)!==0,(r.flags&128)!==0){if(d)return Og(r,i,a);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),nt(dt,dt.current),d)break;return null;case 22:case 23:return i.lanes=0,Rg(r,i,a)}return Jr(r,i,a)}var Vg,Ah,jg,Mg;Vg=function(r,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},Ah=function(){},jg=function(r,i,a,d){var f=r.memoizedProps;if(f!==d){r=i.stateNode,Pi(Tr.current);var m=null;switch(a){case"input":f=Gt(r,f),d=Gt(r,d),m=[];break;case"select":f=ae({},f,{value:void 0}),d=ae({},d,{value:void 0}),m=[];break;case"textarea":f=ui(r,f),d=ui(r,d),m=[];break;default:typeof f.onClick!="function"&&typeof d.onClick=="function"&&(r.onclick=gc)}Wn(a,d);var E;a=null;for(W in f)if(!d.hasOwnProperty(W)&&f.hasOwnProperty(W)&&f[W]!=null)if(W==="style"){var b=f[W];for(E in b)b.hasOwnProperty(E)&&(a||(a={}),a[E]="")}else W!=="dangerouslySetInnerHTML"&&W!=="children"&&W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(o.hasOwnProperty(W)?m||(m=[]):(m=m||[]).push(W,null));for(W in d){var L=d[W];if(b=f?.[W],d.hasOwnProperty(W)&&L!==b&&(L!=null||b!=null))if(W==="style")if(b){for(E in b)!b.hasOwnProperty(E)||L&&L.hasOwnProperty(E)||(a||(a={}),a[E]="");for(E in L)L.hasOwnProperty(E)&&b[E]!==L[E]&&(a||(a={}),a[E]=L[E])}else a||(m||(m=[]),m.push(W,a)),a=L;else W==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,b=b?b.__html:void 0,L!=null&&b!==L&&(m=m||[]).push(W,L)):W==="children"?typeof L!="string"&&typeof L!="number"||(m=m||[]).push(W,""+L):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&(o.hasOwnProperty(W)?(L!=null&&W==="onScroll"&&st("scroll",r),m||b===L||(m=[])):(m=m||[]).push(W,L))}a&&(m=m||[]).push("style",a);var W=m;(i.updateQueue=W)&&(i.flags|=4)}},Mg=function(r,i,a,d){a!==d&&(i.flags|=4)};function el(r,i){if(!at)switch(r.tailMode){case"hidden":i=r.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?r.tail=null:a.sibling=null;break;case"collapsed":a=r.tail;for(var d=null;a!==null;)a.alternate!==null&&(d=a),a=a.sibling;d===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function en(r){var i=r.alternate!==null&&r.alternate.child===r.child,a=0,d=0;if(i)for(var f=r.child;f!==null;)a|=f.lanes|f.childLanes,d|=f.subtreeFlags&14680064,d|=f.flags&14680064,f.return=r,f=f.sibling;else for(f=r.child;f!==null;)a|=f.lanes|f.childLanes,d|=f.subtreeFlags,d|=f.flags,f.return=r,f=f.sibling;return r.subtreeFlags|=d,r.childLanes=a,i}function zE(r,i,a){var d=i.pendingProps;switch(Gd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(i),null;case 1:return dn(i.type)&&_c(),en(i),null;case 3:return d=i.stateNode,Do(),it(un),it(Yt),oh(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(r===null||r.child===null)&&(Ic(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Qn!==null&&(jh(Qn),Qn=null))),Ah(r,i),en(i),null;case 5:sh(i);var f=Pi(Qa.current);if(a=i.type,r!==null&&i.stateNode!=null)jg(r,i,a,d,f),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!d){if(i.stateNode===null)throw Error(t(166));return en(i),null}if(r=Pi(Tr.current),Ic(i)){d=i.stateNode,a=i.type;var m=i.memoizedProps;switch(d[Er]=i,d[$a]=m,r=(i.mode&1)!==0,a){case"dialog":st("cancel",d),st("close",d);break;case"iframe":case"object":case"embed":st("load",d);break;case"video":case"audio":for(f=0;f<Ba.length;f++)st(Ba[f],d);break;case"source":st("error",d);break;case"img":case"image":case"link":st("error",d),st("load",d);break;case"details":st("toggle",d);break;case"input":Kt(d,m),st("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!m.multiple},st("invalid",d);break;case"textarea":Ie(d,m),st("invalid",d)}Wn(a,m),f=null;for(var E in m)if(m.hasOwnProperty(E)){var b=m[E];E==="children"?typeof b=="string"?d.textContent!==b&&(m.suppressHydrationWarning!==!0&&mc(d.textContent,b,r),f=["children",b]):typeof b=="number"&&d.textContent!==""+b&&(m.suppressHydrationWarning!==!0&&mc(d.textContent,b,r),f=["children",""+b]):o.hasOwnProperty(E)&&b!=null&&E==="onScroll"&&st("scroll",d)}switch(a){case"input":lt(d),ir(d,m,!0);break;case"textarea":lt(d),We(d);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(d.onclick=gc)}d=f,i.updateQueue=d,d!==null&&(i.flags|=4)}else{E=f.nodeType===9?f:f.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=$n(a)),r==="http://www.w3.org/1999/xhtml"?a==="script"?(r=E.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof d.is=="string"?r=E.createElement(a,{is:d.is}):(r=E.createElement(a),a==="select"&&(E=r,d.multiple?E.multiple=!0:d.size&&(E.size=d.size))):r=E.createElementNS(r,a),r[Er]=i,r[$a]=d,Vg(r,i,!1,!1),i.stateNode=r;e:{switch(E=to(a,d),a){case"dialog":st("cancel",r),st("close",r),f=d;break;case"iframe":case"object":case"embed":st("load",r),f=d;break;case"video":case"audio":for(f=0;f<Ba.length;f++)st(Ba[f],r);f=d;break;case"source":st("error",r),f=d;break;case"img":case"image":case"link":st("error",r),st("load",r),f=d;break;case"details":st("toggle",r),f=d;break;case"input":Kt(r,d),f=Gt(r,d),st("invalid",r);break;case"option":f=d;break;case"select":r._wrapperState={wasMultiple:!!d.multiple},f=ae({},d,{value:void 0}),st("invalid",r);break;case"textarea":Ie(r,d),f=ui(r,d),st("invalid",r);break;default:f=d}Wn(a,f),b=f;for(m in b)if(b.hasOwnProperty(m)){var L=b[m];m==="style"?eo(r,L):m==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&or(r,L)):m==="children"?typeof L=="string"?(a!=="textarea"||L!=="")&&di(r,L):typeof L=="number"&&di(r,""+L):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(o.hasOwnProperty(m)?L!=null&&m==="onScroll"&&st("scroll",r):L!=null&&X(r,m,L,E))}switch(a){case"input":lt(r),ir(r,d,!1);break;case"textarea":lt(r),We(r);break;case"option":d.value!=null&&r.setAttribute("value",""+ke(d.value));break;case"select":r.multiple=!!d.multiple,m=d.value,m!=null?yn(r,!!d.multiple,m,!1):d.defaultValue!=null&&yn(r,!!d.multiple,d.defaultValue,!0);break;default:typeof f.onClick=="function"&&(r.onclick=gc)}switch(a){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return en(i),null;case 6:if(r&&i.stateNode!=null)Mg(r,i,r.memoizedProps,d);else{if(typeof d!="string"&&i.stateNode===null)throw Error(t(166));if(a=Pi(Qa.current),Pi(Tr.current),Ic(i)){if(d=i.stateNode,a=i.memoizedProps,d[Er]=i,(m=d.nodeValue!==a)&&(r=An,r!==null))switch(r.tag){case 3:mc(d.nodeValue,a,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&mc(d.nodeValue,a,(r.mode&1)!==0)}m&&(i.flags|=4)}else d=(a.nodeType===9?a:a.ownerDocument).createTextNode(d),d[Er]=i,i.stateNode=d}return en(i),null;case 13:if(it(dt),d=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(at&&Cn!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Um(),bo(),i.flags|=98560,m=!1;else if(m=Ic(i),d!==null&&d.dehydrated!==null){if(r===null){if(!m)throw Error(t(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(t(317));m[Er]=i}else bo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;en(i),m=!1}else Qn!==null&&(jh(Qn),Qn=null),m=!0;if(!m)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=a,i):(d=d!==null,d!==(r!==null&&r.memoizedState!==null)&&d&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(dt.current&1)!==0?bt===0&&(bt=3):Fh())),i.updateQueue!==null&&(i.flags|=4),en(i),null);case 4:return Do(),Ah(r,i),r===null&&za(i.stateNode.containerInfo),en(i),null;case 10:return Zd(i.type._context),en(i),null;case 17:return dn(i.type)&&_c(),en(i),null;case 19:if(it(dt),m=i.memoizedState,m===null)return en(i),null;if(d=(i.flags&128)!==0,E=m.rendering,E===null)if(d)el(m,!1);else{if(bt!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(E=bc(r),E!==null){for(i.flags|=128,el(m,!1),d=E.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),i.subtreeFlags=0,d=a,a=i.child;a!==null;)m=a,r=d,m.flags&=14680066,E=m.alternate,E===null?(m.childLanes=0,m.lanes=r,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=E.childLanes,m.lanes=E.lanes,m.child=E.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=E.memoizedProps,m.memoizedState=E.memoizedState,m.updateQueue=E.updateQueue,m.type=E.type,r=E.dependencies,m.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),a=a.sibling;return nt(dt,dt.current&1|2),i.child}r=r.sibling}m.tail!==null&&rt()>Mo&&(i.flags|=128,d=!0,el(m,!1),i.lanes=4194304)}else{if(!d)if(r=bc(E),r!==null){if(i.flags|=128,d=!0,a=r.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),el(m,!0),m.tail===null&&m.tailMode==="hidden"&&!E.alternate&&!at)return en(i),null}else 2*rt()-m.renderingStartTime>Mo&&a!==1073741824&&(i.flags|=128,d=!0,el(m,!1),i.lanes=4194304);m.isBackwards?(E.sibling=i.child,i.child=E):(a=m.last,a!==null?a.sibling=E:i.child=E,m.last=E)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=rt(),i.sibling=null,a=dt.current,nt(dt,d?a&1|2:a&1),i):(en(i),null);case 22:case 23:return Lh(),d=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==d&&(i.flags|=8192),d&&(i.mode&1)!==0?(Rn&1073741824)!==0&&(en(i),i.subtreeFlags&6&&(i.flags|=8192)):en(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function qE(r,i){switch(Gd(i),i.tag){case 1:return dn(i.type)&&_c(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return Do(),it(un),it(Yt),oh(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return sh(i),null;case 13:if(it(dt),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));bo()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return it(dt),null;case 4:return Do(),null;case 10:return Zd(i.type._context),null;case 22:case 23:return Lh(),null;case 24:return null;default:return null}}var Lc=!1,tn=!1,$E=typeof WeakSet=="function"?WeakSet:Set,me=null;function Vo(r,i){var a=r.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(d){mt(r,i,d)}else a.current=null}function Ch(r,i,a){try{a()}catch(d){mt(r,i,d)}}var Lg=!1;function WE(r,i){if(Ld=Br,r=gm(),Pd(r)){if("selectionStart"in r)var a={start:r.selectionStart,end:r.selectionEnd};else e:{a=(a=r.ownerDocument)&&a.defaultView||window;var d=a.getSelection&&a.getSelection();if(d&&d.rangeCount!==0){a=d.anchorNode;var f=d.anchorOffset,m=d.focusNode;d=d.focusOffset;try{a.nodeType,m.nodeType}catch{a=null;break e}var E=0,b=-1,L=-1,W=0,te=0,ne=r,ee=null;t:for(;;){for(var ce;ne!==a||f!==0&&ne.nodeType!==3||(b=E+f),ne!==m||d!==0&&ne.nodeType!==3||(L=E+d),ne.nodeType===3&&(E+=ne.nodeValue.length),(ce=ne.firstChild)!==null;)ee=ne,ne=ce;for(;;){if(ne===r)break t;if(ee===a&&++W===f&&(b=E),ee===m&&++te===d&&(L=E),(ce=ne.nextSibling)!==null)break;ne=ee,ee=ne.parentNode}ne=ce}a=b===-1||L===-1?null:{start:b,end:L}}else a=null}a=a||{start:0,end:0}}else a=null;for(Fd={focusedElem:r,selectionRange:a},Br=!1,me=i;me!==null;)if(i=me,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,me=r;else for(;me!==null;){i=me;try{var ye=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(ye!==null){var _e=ye.memoizedProps,vt=ye.memoizedState,U=i.stateNode,F=U.getSnapshotBeforeUpdate(i.elementType===i.type?_e:Jn(i.type,_e),vt);U.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var z=i.stateNode.containerInfo;z.nodeType===1?z.textContent="":z.nodeType===9&&z.documentElement&&z.removeChild(z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(se){mt(i,i.return,se)}if(r=i.sibling,r!==null){r.return=i.return,me=r;break}me=i.return}return ye=Lg,Lg=!1,ye}function tl(r,i,a){var d=i.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var f=d=d.next;do{if((f.tag&r)===r){var m=f.destroy;f.destroy=void 0,m!==void 0&&Ch(i,a,m)}f=f.next}while(f!==d)}}function Fc(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&r)===r){var d=a.create;a.destroy=d()}a=a.next}while(a!==i)}}function Rh(r){var i=r.ref;if(i!==null){var a=r.stateNode;r.tag,r=a,typeof i=="function"?i(r):i.current=r}}function Fg(r){var i=r.alternate;i!==null&&(r.alternate=null,Fg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[Er],delete i[$a],delete i[qd],delete i[RE],delete i[xE])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Ug(r){return r.tag===5||r.tag===3||r.tag===4}function Bg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Ug(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function xh(r,i,a){var d=r.tag;if(d===5||d===6)r=r.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(r,i):a.insertBefore(r,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(r,a)):(i=a,i.appendChild(r)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=gc));else if(d!==4&&(r=r.child,r!==null))for(xh(r,i,a),r=r.sibling;r!==null;)xh(r,i,a),r=r.sibling}function bh(r,i,a){var d=r.tag;if(d===5||d===6)r=r.stateNode,i?a.insertBefore(r,i):a.appendChild(r);else if(d!==4&&(r=r.child,r!==null))for(bh(r,i,a),r=r.sibling;r!==null;)bh(r,i,a),r=r.sibling}var Ut=null,Xn=!1;function bs(r,i,a){for(a=a.child;a!==null;)zg(r,i,a),a=a.sibling}function zg(r,i,a){if(vn&&typeof vn.onCommitFiberUnmount=="function")try{vn.onCommitFiberUnmount(gi,a)}catch{}switch(a.tag){case 5:tn||Vo(a,i);case 6:var d=Ut,f=Xn;Ut=null,bs(r,i,a),Ut=d,Xn=f,Ut!==null&&(Xn?(r=Ut,a=a.stateNode,r.nodeType===8?r.parentNode.removeChild(a):r.removeChild(a)):Ut.removeChild(a.stateNode));break;case 18:Ut!==null&&(Xn?(r=Ut,a=a.stateNode,r.nodeType===8?zd(r.parentNode,a):r.nodeType===1&&zd(r,a),vs(r)):zd(Ut,a.stateNode));break;case 4:d=Ut,f=Xn,Ut=a.stateNode.containerInfo,Xn=!0,bs(r,i,a),Ut=d,Xn=f;break;case 0:case 11:case 14:case 15:if(!tn&&(d=a.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){f=d=d.next;do{var m=f,E=m.destroy;m=m.tag,E!==void 0&&((m&2)!==0||(m&4)!==0)&&Ch(a,i,E),f=f.next}while(f!==d)}bs(r,i,a);break;case 1:if(!tn&&(Vo(a,i),d=a.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=a.memoizedProps,d.state=a.memoizedState,d.componentWillUnmount()}catch(b){mt(a,i,b)}bs(r,i,a);break;case 21:bs(r,i,a);break;case 22:a.mode&1?(tn=(d=tn)||a.memoizedState!==null,bs(r,i,a),tn=d):bs(r,i,a);break;default:bs(r,i,a)}}function qg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var a=r.stateNode;a===null&&(a=r.stateNode=new $E),i.forEach(function(d){var f=eT.bind(null,r,d);a.has(d)||(a.add(d),d.then(f,f))})}}function Yn(r,i){var a=i.deletions;if(a!==null)for(var d=0;d<a.length;d++){var f=a[d];try{var m=r,E=i,b=E;e:for(;b!==null;){switch(b.tag){case 5:Ut=b.stateNode,Xn=!1;break e;case 3:Ut=b.stateNode.containerInfo,Xn=!0;break e;case 4:Ut=b.stateNode.containerInfo,Xn=!0;break e}b=b.return}if(Ut===null)throw Error(t(160));zg(m,E,f),Ut=null,Xn=!1;var L=f.alternate;L!==null&&(L.return=null),f.return=null}catch(W){mt(f,i,W)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)$g(i,r),i=i.sibling}function $g(r,i){var a=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Yn(i,r),Sr(r),d&4){try{tl(3,r,r.return),Fc(3,r)}catch(_e){mt(r,r.return,_e)}try{tl(5,r,r.return)}catch(_e){mt(r,r.return,_e)}}break;case 1:Yn(i,r),Sr(r),d&512&&a!==null&&Vo(a,a.return);break;case 5:if(Yn(i,r),Sr(r),d&512&&a!==null&&Vo(a,a.return),r.flags&32){var f=r.stateNode;try{di(f,"")}catch(_e){mt(r,r.return,_e)}}if(d&4&&(f=r.stateNode,f!=null)){var m=r.memoizedProps,E=a!==null?a.memoizedProps:m,b=r.type,L=r.updateQueue;if(r.updateQueue=null,L!==null)try{b==="input"&&m.type==="radio"&&m.name!=null&&Qt(f,m),to(b,E);var W=to(b,m);for(E=0;E<L.length;E+=2){var te=L[E],ne=L[E+1];te==="style"?eo(f,ne):te==="dangerouslySetInnerHTML"?or(f,ne):te==="children"?di(f,ne):X(f,te,ne,W)}switch(b){case"input":qn(f,m);break;case"textarea":Mt(f,m);break;case"select":var ee=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!m.multiple;var ce=m.value;ce!=null?yn(f,!!m.multiple,ce,!1):ee!==!!m.multiple&&(m.defaultValue!=null?yn(f,!!m.multiple,m.defaultValue,!0):yn(f,!!m.multiple,m.multiple?[]:"",!1))}f[$a]=m}catch(_e){mt(r,r.return,_e)}}break;case 6:if(Yn(i,r),Sr(r),d&4){if(r.stateNode===null)throw Error(t(162));f=r.stateNode,m=r.memoizedProps;try{f.nodeValue=m}catch(_e){mt(r,r.return,_e)}}break;case 3:if(Yn(i,r),Sr(r),d&4&&a!==null&&a.memoizedState.isDehydrated)try{vs(i.containerInfo)}catch(_e){mt(r,r.return,_e)}break;case 4:Yn(i,r),Sr(r);break;case 13:Yn(i,r),Sr(r),f=r.child,f.flags&8192&&(m=f.memoizedState!==null,f.stateNode.isHidden=m,!m||f.alternate!==null&&f.alternate.memoizedState!==null||(Nh=rt())),d&4&&qg(r);break;case 22:if(te=a!==null&&a.memoizedState!==null,r.mode&1?(tn=(W=tn)||te,Yn(i,r),tn=W):Yn(i,r),Sr(r),d&8192){if(W=r.memoizedState!==null,(r.stateNode.isHidden=W)&&!te&&(r.mode&1)!==0)for(me=r,te=r.child;te!==null;){for(ne=me=te;me!==null;){switch(ee=me,ce=ee.child,ee.tag){case 0:case 11:case 14:case 15:tl(4,ee,ee.return);break;case 1:Vo(ee,ee.return);var ye=ee.stateNode;if(typeof ye.componentWillUnmount=="function"){d=ee,a=ee.return;try{i=d,ye.props=i.memoizedProps,ye.state=i.memoizedState,ye.componentWillUnmount()}catch(_e){mt(d,a,_e)}}break;case 5:Vo(ee,ee.return);break;case 22:if(ee.memoizedState!==null){Gg(ne);continue}}ce!==null?(ce.return=ee,me=ce):Gg(ne)}te=te.sibling}e:for(te=null,ne=r;;){if(ne.tag===5){if(te===null){te=ne;try{f=ne.stateNode,W?(m=f.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(b=ne.stateNode,L=ne.memoizedProps.style,E=L!=null&&L.hasOwnProperty("display")?L.display:null,b.style.display=us("display",E))}catch(_e){mt(r,r.return,_e)}}}else if(ne.tag===6){if(te===null)try{ne.stateNode.nodeValue=W?"":ne.memoizedProps}catch(_e){mt(r,r.return,_e)}}else if((ne.tag!==22&&ne.tag!==23||ne.memoizedState===null||ne===r)&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===r)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===r)break e;te===ne&&(te=null),ne=ne.return}te===ne&&(te=null),ne.sibling.return=ne.return,ne=ne.sibling}}break;case 19:Yn(i,r),Sr(r),d&4&&qg(r);break;case 21:break;default:Yn(i,r),Sr(r)}}function Sr(r){var i=r.flags;if(i&2){try{e:{for(var a=r.return;a!==null;){if(Ug(a)){var d=a;break e}a=a.return}throw Error(t(160))}switch(d.tag){case 5:var f=d.stateNode;d.flags&32&&(di(f,""),d.flags&=-33);var m=Bg(r);bh(r,m,f);break;case 3:case 4:var E=d.stateNode.containerInfo,b=Bg(r);xh(r,b,E);break;default:throw Error(t(161))}}catch(L){mt(r,r.return,L)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function HE(r,i,a){me=r,Wg(r)}function Wg(r,i,a){for(var d=(r.mode&1)!==0;me!==null;){var f=me,m=f.child;if(f.tag===22&&d){var E=f.memoizedState!==null||Lc;if(!E){var b=f.alternate,L=b!==null&&b.memoizedState!==null||tn;b=Lc;var W=tn;if(Lc=E,(tn=L)&&!W)for(me=f;me!==null;)E=me,L=E.child,E.tag===22&&E.memoizedState!==null?Kg(f):L!==null?(L.return=E,me=L):Kg(f);for(;m!==null;)me=m,Wg(m),m=m.sibling;me=f,Lc=b,tn=W}Hg(r)}else(f.subtreeFlags&8772)!==0&&m!==null?(m.return=f,me=m):Hg(r)}}function Hg(r){for(;me!==null;){var i=me;if((i.flags&8772)!==0){var a=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:tn||Fc(5,i);break;case 1:var d=i.stateNode;if(i.flags&4&&!tn)if(a===null)d.componentDidMount();else{var f=i.elementType===i.type?a.memoizedProps:Jn(i.type,a.memoizedProps);d.componentDidUpdate(f,a.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var m=i.updateQueue;m!==null&&Gm(i,m,d);break;case 3:var E=i.updateQueue;if(E!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}Gm(i,E,a)}break;case 5:var b=i.stateNode;if(a===null&&i.flags&4){a=b;var L=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&a.focus();break;case"img":L.src&&(a.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var W=i.alternate;if(W!==null){var te=W.memoizedState;if(te!==null){var ne=te.dehydrated;ne!==null&&vs(ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}tn||i.flags&512&&Rh(i)}catch(ee){mt(i,i.return,ee)}}if(i===r){me=null;break}if(a=i.sibling,a!==null){a.return=i.return,me=a;break}me=i.return}}function Gg(r){for(;me!==null;){var i=me;if(i===r){me=null;break}var a=i.sibling;if(a!==null){a.return=i.return,me=a;break}me=i.return}}function Kg(r){for(;me!==null;){var i=me;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{Fc(4,i)}catch(L){mt(i,a,L)}break;case 1:var d=i.stateNode;if(typeof d.componentDidMount=="function"){var f=i.return;try{d.componentDidMount()}catch(L){mt(i,f,L)}}var m=i.return;try{Rh(i)}catch(L){mt(i,m,L)}break;case 5:var E=i.return;try{Rh(i)}catch(L){mt(i,E,L)}}}catch(L){mt(i,i.return,L)}if(i===r){me=null;break}var b=i.sibling;if(b!==null){b.return=i.return,me=b;break}me=i.return}}var GE=Math.ceil,Uc=q.ReactCurrentDispatcher,Ph=q.ReactCurrentOwner,Ln=q.ReactCurrentBatchConfig,Qe=0,Nt=null,It=null,Bt=0,Rn=0,jo=Ss(0),bt=0,nl=null,Ni=0,Bc=0,kh=0,rl=null,fn=null,Nh=0,Mo=1/0,Xr=null,zc=!1,Dh=null,Ps=null,qc=!1,ks=null,$c=0,sl=0,Oh=null,Wc=-1,Hc=0;function an(){return(Qe&6)!==0?rt():Wc!==-1?Wc:Wc=rt()}function Ns(r){return(r.mode&1)===0?1:(Qe&2)!==0&&Bt!==0?Bt&-Bt:PE.transition!==null?(Hc===0&&(Hc=Aa()),Hc):(r=$e,r!==0||(r=window.event,r=r===void 0?16:ho(r.type)),r)}function Zn(r,i,a,d){if(50<sl)throw sl=0,Oh=null,Error(t(185));wi(r,a,d),((Qe&2)===0||r!==Nt)&&(r===Nt&&((Qe&2)===0&&(Bc|=a),bt===4&&Ds(r,Bt)),pn(r,d),a===1&&Qe===0&&(i.mode&1)===0&&(Mo=rt()+500,wc&&Cs()))}function pn(r,i){var a=r.callbackNode;vi(r,i);var d=Lr(r,r===Nt?Bt:0);if(d===0)a!==null&&so(a),r.callbackNode=null,r.callbackPriority=0;else if(i=d&-d,r.callbackPriority!==i){if(a!=null&&so(a),i===1)r.tag===0?bE(Jg.bind(null,r)):Vm(Jg.bind(null,r)),AE(function(){(Qe&6)===0&&Cs()}),a=null;else{switch(dr(d)){case 1:a=io;break;case 4:a=Ta;break;case 16:a=mi;break;case 536870912:a=oo;break;default:a=mi}a=sy(a,Qg.bind(null,r))}r.callbackPriority=i,r.callbackNode=a}}function Qg(r,i){if(Wc=-1,Hc=0,(Qe&6)!==0)throw Error(t(327));var a=r.callbackNode;if(Lo()&&r.callbackNode!==a)return null;var d=Lr(r,r===Nt?Bt:0);if(d===0)return null;if((d&30)!==0||(d&r.expiredLanes)!==0||i)i=Gc(r,d);else{i=d;var f=Qe;Qe|=2;var m=Yg();(Nt!==r||Bt!==i)&&(Xr=null,Mo=rt()+500,Oi(r,i));do try{JE();break}catch(b){Xg(r,b)}while(!0);Yd(),Uc.current=m,Qe=f,It!==null?i=0:(Nt=null,Bt=0,i=bt)}if(i!==0){if(i===2&&(f=Sa(r),f!==0&&(d=f,i=Vh(r,f))),i===1)throw a=nl,Oi(r,0),Ds(r,d),pn(r,rt()),a;if(i===6)Ds(r,d);else{if(f=r.current.alternate,(d&30)===0&&!KE(f)&&(i=Gc(r,d),i===2&&(m=Sa(r),m!==0&&(d=m,i=Vh(r,m))),i===1))throw a=nl,Oi(r,0),Ds(r,d),pn(r,rt()),a;switch(r.finishedWork=f,r.finishedLanes=d,i){case 0:case 1:throw Error(t(345));case 2:Vi(r,fn,Xr);break;case 3:if(Ds(r,d),(d&130023424)===d&&(i=Nh+500-rt(),10<i)){if(Lr(r,0)!==0)break;if(f=r.suspendedLanes,(f&d)!==d){an(),r.pingedLanes|=r.suspendedLanes&f;break}r.timeoutHandle=Bd(Vi.bind(null,r,fn,Xr),i);break}Vi(r,fn,Xr);break;case 4:if(Ds(r,d),(d&4194240)===d)break;for(i=r.eventTimes,f=-1;0<d;){var E=31-wn(d);m=1<<E,E=i[E],E>f&&(f=E),d&=~m}if(d=f,d=rt()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*GE(d/1960))-d,10<d){r.timeoutHandle=Bd(Vi.bind(null,r,fn,Xr),d);break}Vi(r,fn,Xr);break;case 5:Vi(r,fn,Xr);break;default:throw Error(t(329))}}}return pn(r,rt()),r.callbackNode===a?Qg.bind(null,r):null}function Vh(r,i){var a=rl;return r.current.memoizedState.isDehydrated&&(Oi(r,i).flags|=256),r=Gc(r,i),r!==2&&(i=fn,fn=a,i!==null&&jh(i)),r}function jh(r){fn===null?fn=r:fn.push.apply(fn,r)}function KE(r){for(var i=r;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var d=0;d<a.length;d++){var f=a[d],m=f.getSnapshot;f=f.value;try{if(!Kn(m(),f))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ds(r,i){for(i&=~kh,i&=~Bc,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var a=31-wn(i),d=1<<a;r[a]=-1,i&=~d}}function Jg(r){if((Qe&6)!==0)throw Error(t(327));Lo();var i=Lr(r,0);if((i&1)===0)return pn(r,rt()),null;var a=Gc(r,i);if(r.tag!==0&&a===2){var d=Sa(r);d!==0&&(i=d,a=Vh(r,d))}if(a===1)throw a=nl,Oi(r,0),Ds(r,i),pn(r,rt()),a;if(a===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,Vi(r,fn,Xr),pn(r,rt()),null}function Mh(r,i){var a=Qe;Qe|=1;try{return r(i)}finally{Qe=a,Qe===0&&(Mo=rt()+500,wc&&Cs())}}function Di(r){ks!==null&&ks.tag===0&&(Qe&6)===0&&Lo();var i=Qe;Qe|=1;var a=Ln.transition,d=$e;try{if(Ln.transition=null,$e=1,r)return r()}finally{$e=d,Ln.transition=a,Qe=i,(Qe&6)===0&&Cs()}}function Lh(){Rn=jo.current,it(jo)}function Oi(r,i){r.finishedWork=null,r.finishedLanes=0;var a=r.timeoutHandle;if(a!==-1&&(r.timeoutHandle=-1,SE(a)),It!==null)for(a=It.return;a!==null;){var d=a;switch(Gd(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&_c();break;case 3:Do(),it(un),it(Yt),oh();break;case 5:sh(d);break;case 4:Do();break;case 13:it(dt);break;case 19:it(dt);break;case 10:Zd(d.type._context);break;case 22:case 23:Lh()}a=a.return}if(Nt=r,It=r=Os(r.current,null),Bt=Rn=i,bt=0,nl=null,kh=Bc=Ni=0,fn=rl=null,bi!==null){for(i=0;i<bi.length;i++)if(a=bi[i],d=a.interleaved,d!==null){a.interleaved=null;var f=d.next,m=a.pending;if(m!==null){var E=m.next;m.next=f,d.next=E}a.pending=d}bi=null}return r}function Xg(r,i){do{var a=It;try{if(Yd(),Pc.current=Oc,kc){for(var d=ht.memoizedState;d!==null;){var f=d.queue;f!==null&&(f.pending=null),d=d.next}kc=!1}if(ki=0,kt=xt=ht=null,Ja=!1,Xa=0,Ph.current=null,a===null||a.return===null){bt=1,nl=i,It=null;break}e:{var m=r,E=a.return,b=a,L=i;if(i=Bt,b.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var W=L,te=b,ne=te.tag;if((te.mode&1)===0&&(ne===0||ne===11||ne===15)){var ee=te.alternate;ee?(te.updateQueue=ee.updateQueue,te.memoizedState=ee.memoizedState,te.lanes=ee.lanes):(te.updateQueue=null,te.memoizedState=null)}var ce=Tg(E);if(ce!==null){ce.flags&=-257,Ig(ce,E,b,m,i),ce.mode&1&&Eg(m,W,i),i=ce,L=W;var ye=i.updateQueue;if(ye===null){var _e=new Set;_e.add(L),i.updateQueue=_e}else ye.add(L);break e}else{if((i&1)===0){Eg(m,W,i),Fh();break e}L=Error(t(426))}}else if(at&&b.mode&1){var vt=Tg(E);if(vt!==null){(vt.flags&65536)===0&&(vt.flags|=256),Ig(vt,E,b,m,i),Jd(Oo(L,b));break e}}m=L=Oo(L,b),bt!==4&&(bt=2),rl===null?rl=[m]:rl.push(m),m=E;do{switch(m.tag){case 3:m.flags|=65536,i&=-i,m.lanes|=i;var U=vg(m,L,i);Hm(m,U);break e;case 1:b=L;var F=m.type,z=m.stateNode;if((m.flags&128)===0&&(typeof F.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(Ps===null||!Ps.has(z)))){m.flags|=65536,i&=-i,m.lanes|=i;var se=wg(m,b,i);Hm(m,se);break e}}m=m.return}while(m!==null)}ey(a)}catch(Ee){i=Ee,It===a&&a!==null&&(It=a=a.return);continue}break}while(!0)}function Yg(){var r=Uc.current;return Uc.current=Oc,r===null?Oc:r}function Fh(){(bt===0||bt===3||bt===2)&&(bt=4),Nt===null||(Ni&268435455)===0&&(Bc&268435455)===0||Ds(Nt,Bt)}function Gc(r,i){var a=Qe;Qe|=2;var d=Yg();(Nt!==r||Bt!==i)&&(Xr=null,Oi(r,i));do try{QE();break}catch(f){Xg(r,f)}while(!0);if(Yd(),Qe=a,Uc.current=d,It!==null)throw Error(t(261));return Nt=null,Bt=0,bt}function QE(){for(;It!==null;)Zg(It)}function JE(){for(;It!==null&&!pi();)Zg(It)}function Zg(r){var i=ry(r.alternate,r,Rn);r.memoizedProps=r.pendingProps,i===null?ey(r):It=i,Ph.current=null}function ey(r){var i=r;do{var a=i.alternate;if(r=i.return,(i.flags&32768)===0){if(a=zE(a,i,Rn),a!==null){It=a;return}}else{if(a=qE(a,i),a!==null){a.flags&=32767,It=a;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{bt=6,It=null;return}}if(i=i.sibling,i!==null){It=i;return}It=i=r}while(i!==null);bt===0&&(bt=5)}function Vi(r,i,a){var d=$e,f=Ln.transition;try{Ln.transition=null,$e=1,XE(r,i,a,d)}finally{Ln.transition=f,$e=d}return null}function XE(r,i,a,d){do Lo();while(ks!==null);if((Qe&6)!==0)throw Error(t(327));a=r.finishedWork;var f=r.finishedLanes;if(a===null)return null;if(r.finishedWork=null,r.finishedLanes=0,a===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var m=a.lanes|a.childLanes;if(Ad(r,m),r===Nt&&(It=Nt=null,Bt=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||qc||(qc=!0,sy(mi,function(){return Lo(),null})),m=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||m){m=Ln.transition,Ln.transition=null;var E=$e;$e=1;var b=Qe;Qe|=4,Ph.current=null,WE(r,a),$g(a,r),yE(Fd),Br=!!Ld,Fd=Ld=null,r.current=a,HE(a),Mr(),Qe=b,$e=E,Ln.transition=m}else r.current=a;if(qc&&(qc=!1,ks=r,$c=f),m=r.pendingLanes,m===0&&(Ps=null),ec(a.stateNode),pn(r,rt()),i!==null)for(d=r.onRecoverableError,a=0;a<i.length;a++)f=i[a],d(f.value,{componentStack:f.stack,digest:f.digest});if(zc)throw zc=!1,r=Dh,Dh=null,r;return($c&1)!==0&&r.tag!==0&&Lo(),m=r.pendingLanes,(m&1)!==0?r===Oh?sl++:(sl=0,Oh=r):sl=0,Cs(),null}function Lo(){if(ks!==null){var r=dr($c),i=Ln.transition,a=$e;try{if(Ln.transition=null,$e=16>r?16:r,ks===null)var d=!1;else{if(r=ks,ks=null,$c=0,(Qe&6)!==0)throw Error(t(331));var f=Qe;for(Qe|=4,me=r.current;me!==null;){var m=me,E=m.child;if((me.flags&16)!==0){var b=m.deletions;if(b!==null){for(var L=0;L<b.length;L++){var W=b[L];for(me=W;me!==null;){var te=me;switch(te.tag){case 0:case 11:case 15:tl(8,te,m)}var ne=te.child;if(ne!==null)ne.return=te,me=ne;else for(;me!==null;){te=me;var ee=te.sibling,ce=te.return;if(Fg(te),te===W){me=null;break}if(ee!==null){ee.return=ce,me=ee;break}me=ce}}}var ye=m.alternate;if(ye!==null){var _e=ye.child;if(_e!==null){ye.child=null;do{var vt=_e.sibling;_e.sibling=null,_e=vt}while(_e!==null)}}me=m}}if((m.subtreeFlags&2064)!==0&&E!==null)E.return=m,me=E;else e:for(;me!==null;){if(m=me,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:tl(9,m,m.return)}var U=m.sibling;if(U!==null){U.return=m.return,me=U;break e}me=m.return}}var F=r.current;for(me=F;me!==null;){E=me;var z=E.child;if((E.subtreeFlags&2064)!==0&&z!==null)z.return=E,me=z;else e:for(E=F;me!==null;){if(b=me,(b.flags&2048)!==0)try{switch(b.tag){case 0:case 11:case 15:Fc(9,b)}}catch(Ee){mt(b,b.return,Ee)}if(b===E){me=null;break e}var se=b.sibling;if(se!==null){se.return=b.return,me=se;break e}me=b.return}}if(Qe=f,Cs(),vn&&typeof vn.onPostCommitFiberRoot=="function")try{vn.onPostCommitFiberRoot(gi,r)}catch{}d=!0}return d}finally{$e=a,Ln.transition=i}}return!1}function ty(r,i,a){i=Oo(a,i),i=vg(r,i,1),r=xs(r,i,1),i=an(),r!==null&&(wi(r,1,i),pn(r,i))}function mt(r,i,a){if(r.tag===3)ty(r,r,a);else for(;i!==null;){if(i.tag===3){ty(i,r,a);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ps===null||!Ps.has(d))){r=Oo(a,r),r=wg(i,r,1),i=xs(i,r,1),r=an(),i!==null&&(wi(i,1,r),pn(i,r));break}}i=i.return}}function YE(r,i,a){var d=r.pingCache;d!==null&&d.delete(i),i=an(),r.pingedLanes|=r.suspendedLanes&a,Nt===r&&(Bt&a)===a&&(bt===4||bt===3&&(Bt&130023424)===Bt&&500>rt()-Nh?Oi(r,0):kh|=a),pn(r,i)}function ny(r,i){i===0&&((r.mode&1)===0?i=1:(i=gs,gs<<=1,(gs&130023424)===0&&(gs=4194304)));var a=an();r=Kr(r,i),r!==null&&(wi(r,i,a),pn(r,a))}function ZE(r){var i=r.memoizedState,a=0;i!==null&&(a=i.retryLane),ny(r,a)}function eT(r,i){var a=0;switch(r.tag){case 13:var d=r.stateNode,f=r.memoizedState;f!==null&&(a=f.retryLane);break;case 19:d=r.stateNode;break;default:throw Error(t(314))}d!==null&&d.delete(i),ny(r,a)}var ry;ry=function(r,i,a){if(r!==null)if(r.memoizedProps!==i.pendingProps||un.current)hn=!0;else{if((r.lanes&a)===0&&(i.flags&128)===0)return hn=!1,BE(r,i,a);hn=(r.flags&131072)!==0}else hn=!1,at&&(i.flags&1048576)!==0&&jm(i,Tc,i.index);switch(i.lanes=0,i.tag){case 2:var d=i.type;Mc(r,i),r=i.pendingProps;var f=Co(i,Yt.current);No(i,a),f=ch(null,i,d,r,f,a);var m=uh();return i.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,dn(d)?(m=!0,vc(i)):m=!1,i.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,nh(i),f.updater=Vc,i.stateNode=f,f._reactInternals=i,gh(i,d,r,a),i=wh(null,i,d,!0,m,a)):(i.tag=0,at&&m&&Hd(i),on(null,i,f,a),i=i.child),i;case 16:d=i.elementType;e:{switch(Mc(r,i),r=i.pendingProps,f=d._init,d=f(d._payload),i.type=d,f=i.tag=nT(d),r=Jn(d,r),f){case 0:i=vh(null,i,d,r,a);break e;case 1:i=bg(null,i,d,r,a);break e;case 11:i=Sg(null,i,d,r,a);break e;case 14:i=Ag(null,i,d,Jn(d.type,r),a);break e}throw Error(t(306,d,""))}return i;case 0:return d=i.type,f=i.pendingProps,f=i.elementType===d?f:Jn(d,f),vh(r,i,d,f,a);case 1:return d=i.type,f=i.pendingProps,f=i.elementType===d?f:Jn(d,f),bg(r,i,d,f,a);case 3:e:{if(Pg(i),r===null)throw Error(t(387));d=i.pendingProps,m=i.memoizedState,f=m.element,Wm(r,i),xc(i,d,null,a);var E=i.memoizedState;if(d=E.element,m.isDehydrated)if(m={element:d,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},i.updateQueue.baseState=m,i.memoizedState=m,i.flags&256){f=Oo(Error(t(423)),i),i=kg(r,i,d,a,f);break e}else if(d!==f){f=Oo(Error(t(424)),i),i=kg(r,i,d,a,f);break e}else for(Cn=Is(i.stateNode.containerInfo.firstChild),An=i,at=!0,Qn=null,a=qm(i,null,d,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(bo(),d===f){i=Jr(r,i,a);break e}on(r,i,d,a)}i=i.child}return i;case 5:return Km(i),r===null&&Qd(i),d=i.type,f=i.pendingProps,m=r!==null?r.memoizedProps:null,E=f.children,Ud(d,f)?E=null:m!==null&&Ud(d,m)&&(i.flags|=32),xg(r,i),on(r,i,E,a),i.child;case 6:return r===null&&Qd(i),null;case 13:return Ng(r,i,a);case 4:return rh(i,i.stateNode.containerInfo),d=i.pendingProps,r===null?i.child=Po(i,null,d,a):on(r,i,d,a),i.child;case 11:return d=i.type,f=i.pendingProps,f=i.elementType===d?f:Jn(d,f),Sg(r,i,d,f,a);case 7:return on(r,i,i.pendingProps,a),i.child;case 8:return on(r,i,i.pendingProps.children,a),i.child;case 12:return on(r,i,i.pendingProps.children,a),i.child;case 10:e:{if(d=i.type._context,f=i.pendingProps,m=i.memoizedProps,E=f.value,nt(Ac,d._currentValue),d._currentValue=E,m!==null)if(Kn(m.value,E)){if(m.children===f.children&&!un.current){i=Jr(r,i,a);break e}}else for(m=i.child,m!==null&&(m.return=i);m!==null;){var b=m.dependencies;if(b!==null){E=m.child;for(var L=b.firstContext;L!==null;){if(L.context===d){if(m.tag===1){L=Qr(-1,a&-a),L.tag=2;var W=m.updateQueue;if(W!==null){W=W.shared;var te=W.pending;te===null?L.next=L:(L.next=te.next,te.next=L),W.pending=L}}m.lanes|=a,L=m.alternate,L!==null&&(L.lanes|=a),eh(m.return,a,i),b.lanes|=a;break}L=L.next}}else if(m.tag===10)E=m.type===i.type?null:m.child;else if(m.tag===18){if(E=m.return,E===null)throw Error(t(341));E.lanes|=a,b=E.alternate,b!==null&&(b.lanes|=a),eh(E,a,i),E=m.sibling}else E=m.child;if(E!==null)E.return=m;else for(E=m;E!==null;){if(E===i){E=null;break}if(m=E.sibling,m!==null){m.return=E.return,E=m;break}E=E.return}m=E}on(r,i,f.children,a),i=i.child}return i;case 9:return f=i.type,d=i.pendingProps.children,No(i,a),f=jn(f),d=d(f),i.flags|=1,on(r,i,d,a),i.child;case 14:return d=i.type,f=Jn(d,i.pendingProps),f=Jn(d.type,f),Ag(r,i,d,f,a);case 15:return Cg(r,i,i.type,i.pendingProps,a);case 17:return d=i.type,f=i.pendingProps,f=i.elementType===d?f:Jn(d,f),Mc(r,i),i.tag=1,dn(d)?(r=!0,vc(i)):r=!1,No(i,a),yg(i,d,f),gh(i,d,f,a),wh(null,i,d,!0,r,a);case 19:return Og(r,i,a);case 22:return Rg(r,i,a)}throw Error(t(156,i.tag))};function sy(r,i){return Ea(r,i)}function tT(r,i,a,d){this.tag=r,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(r,i,a,d){return new tT(r,i,a,d)}function Uh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function nT(r){if(typeof r=="function")return Uh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===P)return 11;if(r===Ue)return 14}return 2}function Os(r,i){var a=r.alternate;return a===null?(a=Fn(r.tag,i,r.key,r.mode),a.elementType=r.elementType,a.type=r.type,a.stateNode=r.stateNode,a.alternate=r,r.alternate=a):(a.pendingProps=i,a.type=r.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=r.flags&14680064,a.childLanes=r.childLanes,a.lanes=r.lanes,a.child=r.child,a.memoizedProps=r.memoizedProps,a.memoizedState=r.memoizedState,a.updateQueue=r.updateQueue,i=r.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=r.sibling,a.index=r.index,a.ref=r.ref,a}function Kc(r,i,a,d,f,m){var E=2;if(d=r,typeof r=="function")Uh(r)&&(E=1);else if(typeof r=="string")E=5;else e:switch(r){case I:return ji(a.children,f,m,i);case S:E=8,f|=8;break;case R:return r=Fn(12,a,i,f|2),r.elementType=R,r.lanes=m,r;case x:return r=Fn(13,a,i,f),r.elementType=x,r.lanes=m,r;case ge:return r=Fn(19,a,i,f),r.elementType=ge,r.lanes=m,r;case xe:return Qc(a,f,m,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case V:E=10;break e;case N:E=9;break e;case P:E=11;break e;case Ue:E=14;break e;case Ke:E=16,d=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=Fn(E,a,i,f),i.elementType=r,i.type=d,i.lanes=m,i}function ji(r,i,a,d){return r=Fn(7,r,d,i),r.lanes=a,r}function Qc(r,i,a,d){return r=Fn(22,r,d,i),r.elementType=xe,r.lanes=a,r.stateNode={isHidden:!1},r}function Bh(r,i,a){return r=Fn(6,r,null,i),r.lanes=a,r}function zh(r,i,a){return i=Fn(4,r.children!==null?r.children:[],r.key,i),i.lanes=a,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function rT(r,i,a,d,f){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ca(0),this.expirationTimes=Ca(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ca(0),this.identifierPrefix=d,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function qh(r,i,a,d,f,m,E,b,L){return r=new rT(r,i,a,b,L),i===1?(i=1,m===!0&&(i|=8)):i=0,m=Fn(3,null,null,i),r.current=m,m.stateNode=r,m.memoizedState={element:d,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},nh(m),r}function sT(r,i,a){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:d==null?null:""+d,children:r,containerInfo:i,implementation:a}}function iy(r){if(!r)return As;r=r._reactInternals;e:{if(Hn(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(dn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var a=r.type;if(dn(a))return Dm(r,a,i)}return i}function oy(r,i,a,d,f,m,E,b,L){return r=qh(a,d,!0,r,f,m,E,b,L),r.context=iy(null),a=r.current,d=an(),f=Ns(a),m=Qr(d,f),m.callback=i??null,xs(a,m,f),r.current.lanes=f,wi(r,f,d),pn(r,d),r}function Jc(r,i,a,d){var f=i.current,m=an(),E=Ns(f);return a=iy(a),i.context===null?i.context=a:i.pendingContext=a,i=Qr(m,E),i.payload={element:r},d=d===void 0?null:d,d!==null&&(i.callback=d),r=xs(f,i,E),r!==null&&(Zn(r,f,E,m),Rc(r,f,E)),E}function Xc(r){return r=r.current,r.child?(r.child.tag===5,r.child.stateNode):null}function ay(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var a=r.retryLane;r.retryLane=a!==0&&a<i?a:i}}function $h(r,i){ay(r,i),(r=r.alternate)&&ay(r,i)}function iT(){return null}var ly=typeof reportError=="function"?reportError:function(r){console.error(r)};function Wh(r){this._internalRoot=r}Yc.prototype.render=Wh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));Jc(r,i,null,null)},Yc.prototype.unmount=Wh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Di(function(){Jc(null,r,null,null)}),i[$r]=null}};function Yc(r){this._internalRoot=r}Yc.prototype.unstable_scheduleHydration=function(r){if(r){var i=Pa();r={blockedOn:null,target:r,priority:i};for(var a=0;a<En.length&&i!==0&&i<En[a].priority;a++);En.splice(a,0,r),a===0&&co(r)}};function Hh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Zc(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function cy(){}function oT(r,i,a,d,f){if(f){if(typeof d=="function"){var m=d;d=function(){var W=Xc(E);m.call(W)}}var E=oy(i,d,r,0,null,!1,!1,"",cy);return r._reactRootContainer=E,r[$r]=E.current,za(r.nodeType===8?r.parentNode:r),Di(),E}for(;f=r.lastChild;)r.removeChild(f);if(typeof d=="function"){var b=d;d=function(){var W=Xc(L);b.call(W)}}var L=qh(r,0,!1,null,null,!1,!1,"",cy);return r._reactRootContainer=L,r[$r]=L.current,za(r.nodeType===8?r.parentNode:r),Di(function(){Jc(i,L,a,d)}),L}function eu(r,i,a,d,f){var m=a._reactRootContainer;if(m){var E=m;if(typeof f=="function"){var b=f;f=function(){var L=Xc(E);b.call(L)}}Jc(i,E,r,f)}else E=oT(a,i,r,f,d);return Xc(E)}xa=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var a=Xe(i.pendingLanes);a!==0&&(Ra(i,a|1),pn(i,rt()),(Qe&6)===0&&(Mo=rt()+500,Cs()))}break;case 13:Di(function(){var d=Kr(r,1);if(d!==null){var f=an();Zn(d,r,1,f)}}),$h(r,1)}},ao=function(r){if(r.tag===13){var i=Kr(r,134217728);if(i!==null){var a=an();Zn(i,r,134217728,a)}$h(r,134217728)}},ba=function(r){if(r.tag===13){var i=Ns(r),a=Kr(r,i);if(a!==null){var d=an();Zn(a,r,i,d)}$h(r,i)}},Pa=function(){return $e},ka=function(r,i){var a=$e;try{return $e=r,i()}finally{$e=a}},Or=function(r,i,a){switch(i){case"input":if(qn(r,a),i=a.name,a.type==="radio"&&i!=null){for(a=r;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var d=a[i];if(d!==r&&d.form===r.form){var f=yc(d);if(!f)throw Error(t(90));cn(d),qn(d,f)}}}break;case"textarea":Mt(r,a);break;case"select":i=a.value,i!=null&&yn(r,!!a.multiple,i,!1)}},Wl=Mh,Hl=Di;var aT={usingClientEntryPoint:!1,Events:[Wa,So,yc,hs,fs,Mh]},il={findFiberByHostInstance:Ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lT={bundleType:il.bundleType,version:il.version,rendererPackageName:il.rendererPackageName,rendererConfig:il.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:q.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Zl(r),r===null?null:r.stateNode},findFiberByHostInstance:il.findFiberByHostInstance||iT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tu.isDisabled&&tu.supportsFiber)try{gi=tu.inject(lT),vn=tu}catch{}}return mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aT,mn.createPortal=function(r,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hh(i))throw Error(t(200));return sT(r,i,null,a)},mn.createRoot=function(r,i){if(!Hh(r))throw Error(t(299));var a=!1,d="",f=ly;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onRecoverableError!==void 0&&(f=i.onRecoverableError)),i=qh(r,1,!1,null,null,a,!1,d,f),r[$r]=i.current,za(r.nodeType===8?r.parentNode:r),new Wh(i)},mn.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Zl(i),r=r===null?null:r.stateNode,r},mn.flushSync=function(r){return Di(r)},mn.hydrate=function(r,i,a){if(!Zc(i))throw Error(t(200));return eu(null,r,i,!0,a)},mn.hydrateRoot=function(r,i,a){if(!Hh(r))throw Error(t(405));var d=a!=null&&a.hydratedSources||null,f=!1,m="",E=ly;if(a!=null&&(a.unstable_strictMode===!0&&(f=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onRecoverableError!==void 0&&(E=a.onRecoverableError)),i=oy(i,null,r,1,a??null,f,!1,m,E),r[$r]=i.current,za(r),d)for(r=0;r<d.length;r++)a=d[r],f=a._getVersion,f=f(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,f]:i.mutableSourceEagerHydrationData.push(a,f);return new Yc(i)},mn.render=function(r,i,a){if(!Zc(i))throw Error(t(200));return eu(null,r,i,!1,a)},mn.unmountComponentAtNode=function(r){if(!Zc(r))throw Error(t(40));return r._reactRootContainer?(Di(function(){eu(null,null,r,!1,function(){r._reactRootContainer=null,r[$r]=null})}),!0):!1},mn.unstable_batchedUpdates=Mh,mn.unstable_renderSubtreeIntoContainer=function(r,i,a,d){if(!Zc(a))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return eu(r,i,a,!1,d)},mn.version="18.3.1-next-f1338f8080-20240426",mn}var yy;function uv(){if(yy)return Qh.exports;yy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Qh.exports=yT(),Qh.exports}var _y;function _T(){if(_y)return nu;_y=1;var n=uv();return nu.createRoot=n.createRoot,nu.hydrateRoot=n.hydrateRoot,nu}var vT=_T();const wT=cv(vT);uv();function yl(){return yl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},yl.apply(this,arguments)}var Us;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Us||(Us={}));const vy="popstate";function ET(n){n===void 0&&(n={});function e(o,l){let{pathname:u="/",search:h="",hash:p=""}=Xi(o.location.hash.substr(1));return!u.startsWith("/")&&!u.startsWith(".")&&(u="/"+u),pf("",{pathname:u,search:h,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(o,l){let u=o.document.querySelector("base"),h="";if(u&&u.getAttribute("href")){let p=o.location.href,y=p.indexOf("#");h=y===-1?p:p.slice(0,y)}return h+"#"+(typeof l=="string"?l:Cu(l))}function s(o,l){Ju(o.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(l)+")")}return IT(e,t,s,n)}function Et(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Ju(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function TT(){return Math.random().toString(36).substr(2,8)}function wy(n,e){return{usr:n.state,key:n.key,idx:e}}function pf(n,e,t,s){return t===void 0&&(t=null),yl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Xi(e):e,{state:t,key:e&&e.key||s||TT()})}function Cu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Xi(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function IT(n,e,t,s){s===void 0&&(s={});let{window:o=document.defaultView,v5Compat:l=!1}=s,u=o.history,h=Us.Pop,p=null,y=w();y==null&&(y=0,u.replaceState(yl({},u.state,{idx:y}),""));function w(){return(u.state||{idx:null}).idx}function T(){h=Us.Pop;let O=w(),Z=O==null?null:O-y;y=O,p&&p({action:h,location:j.location,delta:Z})}function C(O,Z){h=Us.Push;let G=pf(j.location,O,Z);t&&t(G,O),y=w()+1;let X=wy(G,y),q=j.createHref(G);try{u.pushState(X,"",q)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;o.location.assign(q)}l&&p&&p({action:h,location:j.location,delta:1})}function k(O,Z){h=Us.Replace;let G=pf(j.location,O,Z);t&&t(G,O),y=w();let X=wy(G,y),q=j.createHref(G);u.replaceState(X,"",q),l&&p&&p({action:h,location:j.location,delta:0})}function $(O){let Z=o.location.origin!=="null"?o.location.origin:o.location.href,G=typeof O=="string"?O:Cu(O);return G=G.replace(/ $/,"%20"),Et(Z,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,Z)}let j={get action(){return h},get location(){return n(o,u)},listen(O){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(vy,T),p=O,()=>{o.removeEventListener(vy,T),p=null}},createHref(O){return e(o,O)},createURL:$,encodeLocation(O){let Z=$(O);return{pathname:Z.pathname,search:Z.search,hash:Z.hash}},push:C,replace:k,go(O){return u.go(O)}};return j}var Ey;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Ey||(Ey={}));function ST(n,e,t){return t===void 0&&(t="/"),AT(n,e,t)}function AT(n,e,t,s){let o=typeof e=="string"?Xi(e):e,l=$f(o.pathname||"/",t);if(l==null)return null;let u=dv(n);CT(u);let h=null;for(let p=0;h==null&&p<u.length;++p){let y=LT(l);h=VT(u[p],y)}return h}function dv(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let o=(l,u,h)=>{let p={relativePath:h===void 0?l.path||"":h,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};p.relativePath.startsWith("/")&&(Et(p.relativePath.startsWith(s),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(s.length));let y=qs([s,p.relativePath]),w=t.concat(p);l.children&&l.children.length>0&&(Et(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),dv(l.children,e,w,y)),!(l.path==null&&!l.index)&&e.push({path:y,score:DT(y,l.index),routesMeta:w})};return n.forEach((l,u)=>{var h;if(l.path===""||!((h=l.path)!=null&&h.includes("?")))o(l,u);else for(let p of hv(l.path))o(l,u,p)}),e}function hv(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,o=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return o?[l,""]:[l];let u=hv(s.join("/")),h=[];return h.push(...u.map(p=>p===""?l:[l,p].join("/"))),o&&h.push(...u),h.map(p=>n.startsWith("/")&&p===""?"/":p)}function CT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:OT(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const RT=/^:[\w-]+$/,xT=3,bT=2,PT=1,kT=10,NT=-2,Ty=n=>n==="*";function DT(n,e){let t=n.split("/"),s=t.length;return t.some(Ty)&&(s+=NT),e&&(s+=bT),t.filter(o=>!Ty(o)).reduce((o,l)=>o+(RT.test(l)?xT:l===""?PT:kT),s)}function OT(n,e){return n.length===e.length&&n.slice(0,-1).every((s,o)=>s===e[o])?n[n.length-1]-e[e.length-1]:0}function VT(n,e,t){let{routesMeta:s}=n,o={},l="/",u=[];for(let h=0;h<s.length;++h){let p=s[h],y=h===s.length-1,w=l==="/"?e:e.slice(l.length)||"/",T=jT({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},w),C=p.route;if(!T)return null;Object.assign(o,T.params),u.push({params:o,pathname:qs([l,T.pathname]),pathnameBase:qT(qs([l,T.pathnameBase])),route:C}),T.pathnameBase!=="/"&&(l=qs([l,T.pathnameBase]))}return u}function jT(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=MT(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let l=o[0],u=l.replace(/(.)\/+$/,"$1"),h=o.slice(1);return{params:s.reduce((y,w,T)=>{let{paramName:C,isOptional:k}=w;if(C==="*"){let j=h[T]||"";u=l.slice(0,l.length-j.length).replace(/(.)\/+$/,"$1")}const $=h[T];return k&&!$?y[C]=void 0:y[C]=($||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:u,pattern:n}}function MT(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Ju(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,p)=>(s.push({paramName:h,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function LT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ju(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function $f(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const FT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,UT=n=>FT.test(n);function BT(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:o=""}=typeof n=="string"?Xi(n):n,l;if(t)if(UT(t))l=t;else{if(t.includes("//")){let u=t;t=t.replace(/\/\/+/g,"/"),Ju(!1,"Pathnames cannot have embedded double slashes - normalizing "+(u+" -> "+t))}t.startsWith("/")?l=Iy(t.substring(1),"/"):l=Iy(t,e)}else l=e;return{pathname:l,search:$T(s),hash:WT(o)}}function Iy(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Yh(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Wf(n,e){let t=zT(n);return e?t.map((s,o)=>o===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function Hf(n,e,t,s){s===void 0&&(s=!1);let o;typeof n=="string"?o=Xi(n):(o=yl({},n),Et(!o.pathname||!o.pathname.includes("?"),Yh("?","pathname","search",o)),Et(!o.pathname||!o.pathname.includes("#"),Yh("#","pathname","hash",o)),Et(!o.search||!o.search.includes("#"),Yh("#","search","hash",o)));let l=n===""||o.pathname==="",u=l?"/":o.pathname,h;if(u==null)h=t;else{let T=e.length-1;if(!s&&u.startsWith("..")){let C=u.split("/");for(;C[0]==="..";)C.shift(),T-=1;o.pathname=C.join("/")}h=T>=0?e[T]:"/"}let p=BT(o,h),y=u&&u!=="/"&&u.endsWith("/"),w=(l||u===".")&&t.endsWith("/");return!p.pathname.endsWith("/")&&(y||w)&&(p.pathname+="/"),p}const qs=n=>n.join("/").replace(/\/\/+/g,"/"),qT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),$T=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,WT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function HT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const fv=["post","put","patch","delete"];new Set(fv);const GT=["get",...fv];new Set(GT);function _l(){return _l=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},_l.apply(this,arguments)}const Gf=ue.createContext(null),KT=ue.createContext(null),si=ue.createContext(null),Xu=ue.createContext(null),is=ue.createContext({outlet:null,matches:[],isDataRoute:!1}),pv=ue.createContext(null);function QT(n,e){let{relative:t}=e===void 0?{}:e;oa()||Et(!1);let{basename:s,navigator:o}=ue.useContext(si),{hash:l,pathname:u,search:h}=yv(n,{relative:t}),p=u;return s!=="/"&&(p=u==="/"?s:qs([s,u])),o.createHref({pathname:p,search:h,hash:l})}function oa(){return ue.useContext(Xu)!=null}function aa(){return oa()||Et(!1),ue.useContext(Xu).location}function mv(n){ue.useContext(si).static||ue.useLayoutEffect(n)}function ii(){let{isDataRoute:n}=ue.useContext(is);return n?lI():JT()}function JT(){oa()||Et(!1);let n=ue.useContext(Gf),{basename:e,future:t,navigator:s}=ue.useContext(si),{matches:o}=ue.useContext(is),{pathname:l}=aa(),u=JSON.stringify(Wf(o,t.v7_relativeSplatPath)),h=ue.useRef(!1);return mv(()=>{h.current=!0}),ue.useCallback(function(y,w){if(w===void 0&&(w={}),!h.current)return;if(typeof y=="number"){s.go(y);return}let T=Hf(y,JSON.parse(u),l,w.relative==="path");n==null&&e!=="/"&&(T.pathname=T.pathname==="/"?e:qs([e,T.pathname])),(w.replace?s.replace:s.push)(T,w.state,w)},[e,s,u,l,n])}function gv(){let{matches:n}=ue.useContext(is),e=n[n.length-1];return e?e.params:{}}function yv(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=ue.useContext(si),{matches:o}=ue.useContext(is),{pathname:l}=aa(),u=JSON.stringify(Wf(o,s.v7_relativeSplatPath));return ue.useMemo(()=>Hf(n,JSON.parse(u),l,t==="path"),[n,u,l,t])}function XT(n,e){return YT(n,e)}function YT(n,e,t,s){oa()||Et(!1);let{navigator:o}=ue.useContext(si),{matches:l}=ue.useContext(is),u=l[l.length-1],h=u?u.params:{};u&&u.pathname;let p=u?u.pathnameBase:"/";u&&u.route;let y=aa(),w;if(e){var T;let O=typeof e=="string"?Xi(e):e;p==="/"||(T=O.pathname)!=null&&T.startsWith(p)||Et(!1),w=O}else w=y;let C=w.pathname||"/",k=C;if(p!=="/"){let O=p.replace(/^\//,"").split("/");k="/"+C.replace(/^\//,"").split("/").slice(O.length).join("/")}let $=ST(n,{pathname:k}),j=rI($&&$.map(O=>Object.assign({},O,{params:Object.assign({},h,O.params),pathname:qs([p,o.encodeLocation?o.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?p:qs([p,o.encodeLocation?o.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),l,t,s);return e&&j?ue.createElement(Xu.Provider,{value:{location:_l({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:Us.Pop}},j):j}function ZT(){let n=aI(),e=HT(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ue.createElement(ue.Fragment,null,ue.createElement("h2",null,"Unexpected Application Error!"),ue.createElement("h3",{style:{fontStyle:"italic"}},e),t?ue.createElement("pre",{style:o},t):null,null)}const eI=ue.createElement(ZT,null);class tI extends ue.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?ue.createElement(is.Provider,{value:this.props.routeContext},ue.createElement(pv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function nI(n){let{routeContext:e,match:t,children:s}=n,o=ue.useContext(Gf);return o&&o.static&&o.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=t.route.id),ue.createElement(is.Provider,{value:e},s)}function rI(n,e,t,s){var o;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,h=(o=t)==null?void 0:o.errors;if(h!=null){let w=u.findIndex(T=>T.route.id&&h?.[T.route.id]!==void 0);w>=0||Et(!1),u=u.slice(0,Math.min(u.length,w+1))}let p=!1,y=-1;if(t&&s&&s.v7_partialHydration)for(let w=0;w<u.length;w++){let T=u[w];if((T.route.HydrateFallback||T.route.hydrateFallbackElement)&&(y=w),T.route.id){let{loaderData:C,errors:k}=t,$=T.route.loader&&C[T.route.id]===void 0&&(!k||k[T.route.id]===void 0);if(T.route.lazy||$){p=!0,y>=0?u=u.slice(0,y+1):u=[u[0]];break}}}return u.reduceRight((w,T,C)=>{let k,$=!1,j=null,O=null;t&&(k=h&&T.route.id?h[T.route.id]:void 0,j=T.route.errorElement||eI,p&&(y<0&&C===0?(cI("route-fallback"),$=!0,O=null):y===C&&($=!0,O=T.route.hydrateFallbackElement||null)));let Z=e.concat(u.slice(0,C+1)),G=()=>{let X;return k?X=j:$?X=O:T.route.Component?X=ue.createElement(T.route.Component,null):T.route.element?X=T.route.element:X=w,ue.createElement(nI,{match:T,routeContext:{outlet:w,matches:Z,isDataRoute:t!=null},children:X})};return t&&(T.route.ErrorBoundary||T.route.errorElement||C===0)?ue.createElement(tI,{location:t.location,revalidation:t.revalidation,component:j,error:k,children:G(),routeContext:{outlet:null,matches:Z,isDataRoute:!0}}):G()},null)}var _v=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(_v||{}),vv=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(vv||{});function sI(n){let e=ue.useContext(Gf);return e||Et(!1),e}function iI(n){let e=ue.useContext(KT);return e||Et(!1),e}function oI(n){let e=ue.useContext(is);return e||Et(!1),e}function wv(n){let e=oI(),t=e.matches[e.matches.length-1];return t.route.id||Et(!1),t.route.id}function aI(){var n;let e=ue.useContext(pv),t=iI(),s=wv();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function lI(){let{router:n}=sI(_v.UseNavigateStable),e=wv(vv.UseNavigateStable),t=ue.useRef(!1);return mv(()=>{t.current=!0}),ue.useCallback(function(o,l){l===void 0&&(l={}),t.current&&(typeof o=="number"?n.navigate(o):n.navigate(o,_l({fromRouteId:e},l)))},[n,e])}const Sy={};function cI(n,e,t){Sy[n]||(Sy[n]=!0)}function uI(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function mf(n){let{to:e,replace:t,state:s,relative:o}=n;oa()||Et(!1);let{future:l,static:u}=ue.useContext(si),{matches:h}=ue.useContext(is),{pathname:p}=aa(),y=ii(),w=Hf(e,Wf(h,l.v7_relativeSplatPath),p,o==="path"),T=JSON.stringify(w);return ue.useEffect(()=>y(JSON.parse(T),{replace:t,state:s,relative:o}),[y,T,o,t,s]),null}function xn(n){Et(!1)}function dI(n){let{basename:e="/",children:t=null,location:s,navigationType:o=Us.Pop,navigator:l,static:u=!1,future:h}=n;oa()&&Et(!1);let p=e.replace(/^\/*/,"/"),y=ue.useMemo(()=>({basename:p,navigator:l,static:u,future:_l({v7_relativeSplatPath:!1},h)}),[p,h,l,u]);typeof s=="string"&&(s=Xi(s));let{pathname:w="/",search:T="",hash:C="",state:k=null,key:$="default"}=s,j=ue.useMemo(()=>{let O=$f(w,p);return O==null?null:{location:{pathname:O,search:T,hash:C,state:k,key:$},navigationType:o}},[p,w,T,C,k,$,o]);return j==null?null:ue.createElement(si.Provider,{value:y},ue.createElement(Xu.Provider,{children:t,value:j}))}function hI(n){let{children:e,location:t}=n;return XT(gf(e),t)}new Promise(()=>{});function gf(n,e){e===void 0&&(e=[]);let t=[];return ue.Children.forEach(n,(s,o)=>{if(!ue.isValidElement(s))return;let l=[...e,o];if(s.type===ue.Fragment){t.push.apply(t,gf(s.props.children,l));return}s.type!==xn&&Et(!1),!s.props.index||!s.props.children||Et(!1);let u={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=gf(s.props.children,l)),t.push(u)}),t}function yf(){return yf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},yf.apply(this,arguments)}function fI(n,e){if(n==null)return{};var t={},s=Object.keys(n),o,l;for(l=0;l<s.length;l++)o=s[l],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function pI(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function mI(n,e){return n.button===0&&(!e||e==="_self")&&!pI(n)}function _f(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(o=>[t,o]):[[t,s]])},[]))}function gI(n,e){let t=_f(n);return e&&e.forEach((s,o)=>{t.has(o)||e.getAll(o).forEach(l=>{t.append(o,l)})}),t}const yI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],_I="6";try{window.__reactRouterVersion=_I}catch{}const vI="startTransition",Ay=pT[vI];function wI(n){let{basename:e,children:t,future:s,window:o}=n,l=ue.useRef();l.current==null&&(l.current=ET({window:o,v5Compat:!0}));let u=l.current,[h,p]=ue.useState({action:u.action,location:u.location}),{v7_startTransition:y}=s||{},w=ue.useCallback(T=>{y&&Ay?Ay(()=>p(T)):p(T)},[p,y]);return ue.useLayoutEffect(()=>u.listen(w),[u,w]),ue.useEffect(()=>uI(s),[s]),ue.createElement(dI,{basename:e,children:t,location:h.location,navigationType:h.action,navigator:u,future:s})}const EI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mi=ue.forwardRef(function(e,t){let{onClick:s,relative:o,reloadDocument:l,replace:u,state:h,target:p,to:y,preventScrollReset:w,viewTransition:T}=e,C=fI(e,yI),{basename:k}=ue.useContext(si),$,j=!1;if(typeof y=="string"&&TI.test(y)&&($=y,EI))try{let X=new URL(window.location.href),q=y.startsWith("//")?new URL(X.protocol+y):new URL(y),M=$f(q.pathname,k);q.origin===X.origin&&M!=null?y=M+q.search+q.hash:j=!0}catch{}let O=QT(y,{relative:o}),Z=II(y,{replace:u,state:h,target:p,preventScrollReset:w,relative:o,viewTransition:T});function G(X){s&&s(X),X.defaultPrevented||Z(X)}return ue.createElement("a",yf({},C,{href:$||O,onClick:j||l?s:G,ref:t,target:p}))});var Cy;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Cy||(Cy={}));var Ry;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Ry||(Ry={}));function II(n,e){let{target:t,replace:s,state:o,preventScrollReset:l,relative:u,viewTransition:h}=e===void 0?{}:e,p=ii(),y=aa(),w=yv(n,{relative:u});return ue.useCallback(T=>{if(mI(T,t)){T.preventDefault();let C=s!==void 0?s:Cu(y)===Cu(w);p(n,{replace:C,state:o,preventScrollReset:l,relative:u,viewTransition:h})}},[y,p,w,s,o,t,n,l,u,h])}function SI(n){let e=ue.useRef(_f(n)),t=ue.useRef(!1),s=aa(),o=ue.useMemo(()=>gI(s.search,t.current?null:e.current),[s.search]),l=ii(),u=ue.useCallback((h,p)=>{const y=_f(typeof h=="function"?h(o):h);t.current=!0,l("?"+y,p)},[l,o]);return[o,u]}const AI=()=>{};var xy={};const Ev=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let o=n.charCodeAt(s);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},CI=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const o=n[t++];if(o<128)e[s++]=String.fromCharCode(o);else if(o>191&&o<224){const l=n[t++];e[s++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=n[t++],u=n[t++],h=n[t++],p=((o&7)<<18|(l&63)<<12|(u&63)<<6|h&63)-65536;e[s++]=String.fromCharCode(55296+(p>>10)),e[s++]=String.fromCharCode(56320+(p&1023))}else{const l=n[t++],u=n[t++];e[s++]=String.fromCharCode((o&15)<<12|(l&63)<<6|u&63)}}return e.join("")},Tv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let o=0;o<n.length;o+=3){const l=n[o],u=o+1<n.length,h=u?n[o+1]:0,p=o+2<n.length,y=p?n[o+2]:0,w=l>>2,T=(l&3)<<4|h>>4;let C=(h&15)<<2|y>>6,k=y&63;p||(k=64,u||(C=64)),s.push(t[w],t[T],t[C],t[k])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Ev(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):CI(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let o=0;o<n.length;){const l=t[n.charAt(o++)],h=o<n.length?t[n.charAt(o)]:0;++o;const y=o<n.length?t[n.charAt(o)]:64;++o;const T=o<n.length?t[n.charAt(o)]:64;if(++o,l==null||h==null||y==null||T==null)throw new RI;const C=l<<2|h>>4;if(s.push(C),y!==64){const k=h<<4&240|y>>2;if(s.push(k),T!==64){const $=y<<6&192|T;s.push($)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class RI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xI=function(n){const e=Ev(n);return Tv.encodeByteArray(e,!0)},Ru=function(n){return xI(n).replace(/\./g,"")},Iv=function(n){try{return Tv.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function bI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const PI=()=>bI().__FIREBASE_DEFAULTS__,kI=()=>{if(typeof process>"u"||typeof xy>"u")return;const n=xy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},NI=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Iv(n[1]);return e&&JSON.parse(e)},Yu=()=>{try{return AI()||PI()||kI()||NI()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Sv=n=>Yu()?.emulatorHosts?.[n],DI=n=>{const e=Sv(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},Av=()=>Yu()?.config,Cv=n=>Yu()?.[`_${n}`];class OI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}function la(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Rv(n){return(await fetch(n,{credentials:"include"})).ok}function VI(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",o=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${s}`,aud:s,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ru(JSON.stringify(t)),Ru(JSON.stringify(u)),""].join(".")}const ul={};function jI(){const n={prod:[],emulator:[]};for(const e of Object.keys(ul))ul[e]?n.emulator.push(e):n.prod.push(e);return n}function MI(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let by=!1;function xv(n,e){if(typeof window>"u"||typeof document>"u"||!la(window.location.host)||ul[n]===e||ul[n]||by)return;ul[n]=e;function t(C){return`__firebase__banner__${C}`}const s="__firebase__banner",l=jI().prod.length>0;function u(){const C=document.getElementById(s);C&&C.remove()}function h(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function p(C,k){C.setAttribute("width","24"),C.setAttribute("id",k),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function y(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{by=!0,u()},C}function w(C,k){C.setAttribute("id",k),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function T(){const C=MI(s),k=t("text"),$=document.getElementById(k)||document.createElement("span"),j=t("learnmore"),O=document.getElementById(j)||document.createElement("a"),Z=t("preprendIcon"),G=document.getElementById(Z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const X=C.element;h(X),w(O,j);const q=y();p(G,Z),X.append(G,$,O,q),document.body.appendChild(X)}l?($.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,$.innerText="Preview backend running in this workspace."),$.setAttribute("id",k)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}function sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function LI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sn())}function FI(){const n=Yu()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function UI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BI(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function zI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function qI(){const n=sn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function $I(){return!FI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function WI(){try{return typeof indexedDB=="object"}catch{return!1}}function HI(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(s);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const GI="FirebaseError";class os extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=GI,Object.setPrototypeOf(this,os.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,kl.prototype.create)}}class kl{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},o=`${this.service}/${e}`,l=this.errors[e],u=l?KI(l,s):"Error",h=`${this.serviceName}: ${u} (${o}).`;return new os(o,h,s)}}function KI(n,e){return n.replace(QI,(t,s)=>{const o=e[s];return o!=null?String(o):`<${s}?>`})}const QI=/\{\$([^}]+)}/g;function JI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Hi(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const o of t){if(!s.includes(o))return!1;const l=n[o],u=e[o];if(Py(l)&&Py(u)){if(!Hi(l,u))return!1}else if(l!==u)return!1}for(const o of s)if(!t.includes(o))return!1;return!0}function Py(n){return n!==null&&typeof n=="object"}function Nl(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function XI(n,e){const t=new YI(n,e);return t.subscribe.bind(t)}class YI{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let o;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");ZI(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:s},o.next===void 0&&(o.next=Zh),o.error===void 0&&(o.error=Zh),o.complete===void 0&&(o.complete=Zh);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZI(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Zh(){}function Rt(n){return n&&n._delegate?n._delegate:n}class Gi{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Fi="[DEFAULT]";class eS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new OI;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&s.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(nS(e))try{this.getOrInitializeService({instanceIdentifier:Fi})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:o});s.resolve(l)}catch{}}}}clearInstance(e=Fi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fi){return this.instances.has(e)}getOptions(e=Fi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(l);s===h&&u.resolve(o)}return o}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(s)??new Set;o.add(e),this.onInitCallbacks.set(s,o);const l=this.instances.get(s);return l&&e(l,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const o of s)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:tS(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Fi){return this.component?this.component.multipleInstances?e:Fi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tS(n){return n===Fi?void 0:n}function nS(n){return n.instantiationMode==="EAGER"}class rS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new eS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Be||(Be={}));const sS={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},iS=Be.INFO,oS={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},aS=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),o=oS[e];if(o)console[o](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kf{constructor(e){this.name=e,this._logLevel=iS,this._logHandler=aS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?sS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const lS=(n,e)=>e.some(t=>n instanceof t);let ky,Ny;function cS(){return ky||(ky=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uS(){return Ny||(Ny=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const bv=new WeakMap,vf=new WeakMap,Pv=new WeakMap,ef=new WeakMap,Qf=new WeakMap;function dS(n){const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t($s(n.result)),o()},u=()=>{s(n.error),o()};n.addEventListener("success",l),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&bv.set(t,n)}).catch(()=>{}),Qf.set(e,n),e}function hS(n){if(vf.has(n))return;const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),o()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});vf.set(n,e)}let wf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return vf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Pv.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $s(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function fS(n){wf=n(wf)}function pS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(tf(this),e,...t);return Pv.set(s,e.sort?e.sort():[e]),$s(s)}:uS().includes(n)?function(...e){return n.apply(tf(this),e),$s(bv.get(this))}:function(...e){return $s(n.apply(tf(this),e))}}function mS(n){return typeof n=="function"?pS(n):(n instanceof IDBTransaction&&hS(n),lS(n,cS())?new Proxy(n,wf):n)}function $s(n){if(n instanceof IDBRequest)return dS(n);if(ef.has(n))return ef.get(n);const e=mS(n);return e!==n&&(ef.set(n,e),Qf.set(e,n)),e}const tf=n=>Qf.get(n);function gS(n,e,{blocked:t,upgrade:s,blocking:o,terminated:l}={}){const u=indexedDB.open(n,e),h=$s(u);return s&&u.addEventListener("upgradeneeded",p=>{s($s(u.result),p.oldVersion,p.newVersion,$s(u.transaction),p)}),t&&u.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),h.then(p=>{l&&p.addEventListener("close",()=>l()),o&&p.addEventListener("versionchange",y=>o(y.oldVersion,y.newVersion,y))}).catch(()=>{}),h}const yS=["get","getKey","getAll","getAllKeys","count"],_S=["put","add","delete","clear"],nf=new Map;function Dy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(nf.get(e))return nf.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,o=_S.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(o||yS.includes(t)))return;const l=async function(u,...h){const p=this.transaction(u,o?"readwrite":"readonly");let y=p.store;return s&&(y=y.index(h.shift())),(await Promise.all([y[t](...h),o&&p.done]))[0]};return nf.set(e,l),l}fS(n=>({...n,get:(e,t,s)=>Dy(e,t)||n.get(e,t,s),has:(e,t)=>!!Dy(e,t)||n.has(e,t)}));class vS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wS(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function wS(n){return n.getComponent()?.type==="VERSION"}const Ef="@firebase/app",Oy="0.14.6";const ts=new Kf("@firebase/app"),ES="@firebase/app-compat",TS="@firebase/analytics-compat",IS="@firebase/analytics",SS="@firebase/app-check-compat",AS="@firebase/app-check",CS="@firebase/auth",RS="@firebase/auth-compat",xS="@firebase/database",bS="@firebase/data-connect",PS="@firebase/database-compat",kS="@firebase/functions",NS="@firebase/functions-compat",DS="@firebase/installations",OS="@firebase/installations-compat",VS="@firebase/messaging",jS="@firebase/messaging-compat",MS="@firebase/performance",LS="@firebase/performance-compat",FS="@firebase/remote-config",US="@firebase/remote-config-compat",BS="@firebase/storage",zS="@firebase/storage-compat",qS="@firebase/firestore",$S="@firebase/ai",WS="@firebase/firestore-compat",HS="firebase",GS="12.6.0";const Tf="[DEFAULT]",KS={[Ef]:"fire-core",[ES]:"fire-core-compat",[IS]:"fire-analytics",[TS]:"fire-analytics-compat",[AS]:"fire-app-check",[SS]:"fire-app-check-compat",[CS]:"fire-auth",[RS]:"fire-auth-compat",[xS]:"fire-rtdb",[bS]:"fire-data-connect",[PS]:"fire-rtdb-compat",[kS]:"fire-fn",[NS]:"fire-fn-compat",[DS]:"fire-iid",[OS]:"fire-iid-compat",[VS]:"fire-fcm",[jS]:"fire-fcm-compat",[MS]:"fire-perf",[LS]:"fire-perf-compat",[FS]:"fire-rc",[US]:"fire-rc-compat",[BS]:"fire-gcs",[zS]:"fire-gcs-compat",[qS]:"fire-fst",[WS]:"fire-fst-compat",[$S]:"fire-vertex","fire-js":"fire-js",[HS]:"fire-js-all"};const xu=new Map,QS=new Map,If=new Map;function Vy(n,e){try{n.container.addComponent(e)}catch(t){ts.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Xo(n){const e=n.name;if(If.has(e))return ts.debug(`There were multiple attempts to register component ${e}.`),!1;If.set(e,n);for(const t of xu.values())Vy(t,n);for(const t of QS.values())Vy(t,n);return!0}function Jf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function er(n){return n==null?!1:n.settings!==void 0}const JS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ws=new kl("app","Firebase",JS);class XS{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Gi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ws.create("app-deleted",{appName:this._name})}}const ca=GS;function kv(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Tf,automaticDataCollectionEnabled:!0,...e},o=s.name;if(typeof o!="string"||!o)throw Ws.create("bad-app-name",{appName:String(o)});if(t||(t=Av()),!t)throw Ws.create("no-options");const l=xu.get(o);if(l){if(Hi(t,l.options)&&Hi(s,l.config))return l;throw Ws.create("duplicate-app",{appName:o})}const u=new rS(o);for(const p of If.values())u.addComponent(p);const h=new XS(t,s,u);return xu.set(o,h),h}function Nv(n=Tf){const e=xu.get(n);if(!e&&n===Tf&&Av())return kv();if(!e)throw Ws.create("no-app",{appName:n});return e}function Hs(n,e,t){let s=KS[n]??n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const u=[`Unable to register library "${s}" with version "${e}":`];o&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ts.warn(u.join(" "));return}Xo(new Gi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const YS="firebase-heartbeat-database",ZS=1,vl="firebase-heartbeat-store";let rf=null;function Dv(){return rf||(rf=gS(YS,ZS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(vl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ws.create("idb-open",{originalErrorMessage:n.message})})),rf}async function eA(n){try{const t=(await Dv()).transaction(vl),s=await t.objectStore(vl).get(Ov(n));return await t.done,s}catch(e){if(e instanceof os)ts.warn(e.message);else{const t=Ws.create("idb-get",{originalErrorMessage:e?.message});ts.warn(t.message)}}}async function jy(n,e){try{const s=(await Dv()).transaction(vl,"readwrite");await s.objectStore(vl).put(e,Ov(n)),await s.done}catch(t){if(t instanceof os)ts.warn(t.message);else{const s=Ws.create("idb-set",{originalErrorMessage:t?.message});ts.warn(s.message)}}}function Ov(n){return`${n.name}!${n.options.appId}`}const tA=1024,nA=30;class rA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new iA(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=My();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>nA){const o=oA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ts.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=My(),{heartbeatsToSend:t,unsentEntries:s}=sA(this._heartbeatsCache.heartbeats),o=Ru(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return ts.warn(e),""}}}function My(){return new Date().toISOString().substring(0,10)}function sA(n,e=tA){const t=[];let s=n.slice();for(const o of n){const l=t.find(u=>u.agent===o.agent);if(l){if(l.dates.push(o.date),Ly(t)>e){l.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Ly(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class iA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return WI()?HI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await eA(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return jy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return jy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ly(n){return Ru(JSON.stringify({version:2,heartbeats:n})).length}function oA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}function aA(n){Xo(new Gi("platform-logger",e=>new vS(e),"PRIVATE")),Xo(new Gi("heartbeat",e=>new rA(e),"PRIVATE")),Hs(Ef,Oy,n),Hs(Ef,Oy,"esm2020"),Hs("fire-js","")}aA("");function Vv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lA=Vv,jv=new kl("auth","Firebase",Vv());const bu=new Kf("@firebase/auth");function cA(n,...e){bu.logLevel<=Be.WARN&&bu.warn(`Auth (${ca}): ${n}`,...e)}function fu(n,...e){bu.logLevel<=Be.ERROR&&bu.error(`Auth (${ca}): ${n}`,...e)}function kr(n,...e){throw Yf(n,...e)}function nr(n,...e){return Yf(n,...e)}function Xf(n,e,t){const s={...lA(),[e]:t};return new kl("auth","Firebase",s).create(e,{appName:n.name})}function $i(n){return Xf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uA(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&kr(n,"argument-error"),Xf(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Yf(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return jv.create(n,...e)}function De(n,e,...t){if(!n)throw Yf(e,...t)}function Zr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw fu(e),new Error(e)}function ns(n,e){n||Zr(e)}function Sf(){return typeof self<"u"&&self.location?.href||""}function dA(){return Fy()==="http:"||Fy()==="https:"}function Fy(){return typeof self<"u"&&self.location?.protocol||null}function hA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(dA()||BI()||"connection"in navigator)?navigator.onLine:!0}function fA(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Dl{constructor(e,t){this.shortDelay=e,this.longDelay=t,ns(t>e,"Short delay should be less than long delay!"),this.isMobile=LI()||zI()}get(){return hA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Zf(n,e){ns(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Mv{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const pA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const mA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gA=new Dl(3e4,6e4);function ep(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ua(n,e,t,s,o={}){return Lv(n,o,async()=>{let l={},u={};s&&(e==="GET"?u=s:l={body:JSON.stringify(s)});const h=Nl({key:n.config.apiKey,...u}).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:p,...l};return UI()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&la(n.emulatorConfig.host)&&(y.credentials="include"),Mv.fetch()(await Fv(n,n.config.apiHost,t,h),y)})}async function Lv(n,e,t){n._canInitEmulator=!1;const s={...pA,...e};try{const o=new _A(n),l=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw ru(n,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const h=l.ok?u.errorMessage:u.error.message,[p,y]=h.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw ru(n,"credential-already-in-use",u);if(p==="EMAIL_EXISTS")throw ru(n,"email-already-in-use",u);if(p==="USER_DISABLED")throw ru(n,"user-disabled",u);const w=s[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw Xf(n,w,y);kr(n,w)}}catch(o){if(o instanceof os)throw o;kr(n,"network-request-failed",{message:String(o)})}}async function yA(n,e,t,s,o={}){const l=await ua(n,e,t,s,o);return"mfaPendingCredential"in l&&kr(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function Fv(n,e,t,s){const o=`${e}${t}?${s}`,l=n,u=l.config.emulator?Zf(n.config,o):`${n.config.apiScheme}://${o}`;return mA.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}class _A{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(nr(this.auth,"network-request-failed")),gA.get())})}}function ru(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const o=nr(n,e,s);return o.customData._tokenResponse=t,o}async function vA(n,e){return ua(n,"POST","/v1/accounts:delete",e)}async function Pu(n,e){return ua(n,"POST","/v1/accounts:lookup",e)}function dl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function wA(n,e=!1){const t=Rt(n),s=await t.getIdToken(e),o=tp(s);De(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const l=typeof o.firebase=="object"?o.firebase:void 0,u=l?.sign_in_provider;return{claims:o,token:s,authTime:dl(sf(o.auth_time)),issuedAtTime:dl(sf(o.iat)),expirationTime:dl(sf(o.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function sf(n){return Number(n)*1e3}function tp(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return fu("JWT malformed, contained fewer than 3 sections"),null;try{const o=Iv(t);return o?JSON.parse(o):(fu("Failed to decode base64 JWT payload"),null)}catch(o){return fu("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Uy(n){const e=tp(n);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function wl(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof os&&EA(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function EA({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class TA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Af{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=dl(this.lastLoginAt),this.creationTime=dl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ku(n){const e=n.auth,t=await n.getIdToken(),s=await wl(n,Pu(e,{idToken:t}));De(s?.users.length,e,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const l=o.providerUserInfo?.length?Uv(o.providerUserInfo):[],u=SA(n.providerData,l),h=n.isAnonymous,p=!(n.email&&o.passwordHash)&&!u?.length,y=h?p:!1,w={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Af(o.createdAt,o.lastLoginAt),isAnonymous:y};Object.assign(n,w)}async function IA(n){const e=Rt(n);await ku(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function SA(n,e){return[...n.filter(s=>!e.some(o=>o.providerId===s.providerId)),...e]}function Uv(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function AA(n,e){const t=await Lv(n,{},async()=>{const s=Nl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:l}=n.config,u=await Fv(n,o,"/v1/token",`key=${l}`),h=await n._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:h,body:s};return n.emulatorConfig&&la(n.emulatorConfig.host)&&(p.credentials="include"),Mv.fetch()(u,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function CA(n,e){return ua(n,"POST","/v2/accounts:revokeToken",ep(n,e))}class Go{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Uy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");const t=Uy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:o,expiresIn:l}=await AA(e,t);this.updateTokensAndExpiration(s,o,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:o,expirationTime:l}=t,u=new Go;return s&&(De(typeof s=="string","internal-error",{appName:e}),u.refreshToken=s),o&&(De(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),l&&(De(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Go,this.toJSON())}_performRefresh(){return Zr("not implemented")}}function js(n,e){De(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class tr{constructor({uid:e,auth:t,stsTokenManager:s,...o}){this.providerId="firebase",this.proactiveRefresh=new TA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Af(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await wl(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return wA(this,e)}reload(){return IA(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new tr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await ku(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(er(this.auth.app))return Promise.reject($i(this.auth));const e=await this.getIdToken();return await wl(this,vA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,o=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,h=t.tenantId??void 0,p=t._redirectEventId??void 0,y=t.createdAt??void 0,w=t.lastLoginAt??void 0,{uid:T,emailVerified:C,isAnonymous:k,providerData:$,stsTokenManager:j}=t;De(T&&j,e,"internal-error");const O=Go.fromJSON(this.name,j);De(typeof T=="string",e,"internal-error"),js(s,e.name),js(o,e.name),De(typeof C=="boolean",e,"internal-error"),De(typeof k=="boolean",e,"internal-error"),js(l,e.name),js(u,e.name),js(h,e.name),js(p,e.name),js(y,e.name),js(w,e.name);const Z=new tr({uid:T,auth:e,email:o,emailVerified:C,displayName:s,isAnonymous:k,photoURL:u,phoneNumber:l,tenantId:h,stsTokenManager:O,createdAt:y,lastLoginAt:w});return $&&Array.isArray($)&&(Z.providerData=$.map(G=>({...G}))),p&&(Z._redirectEventId=p),Z}static async _fromIdTokenResponse(e,t,s=!1){const o=new Go;o.updateFromServerResponse(t);const l=new tr({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:s});return await ku(l),l}static async _fromGetAccountInfoResponse(e,t,s){const o=t.users[0];De(o.localId!==void 0,"internal-error");const l=o.providerUserInfo!==void 0?Uv(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!l?.length,h=new Go;h.updateFromIdToken(s);const p=new tr({uid:o.localId,auth:e,stsTokenManager:h,isAnonymous:u}),y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new Af(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!l?.length};return Object.assign(p,y),p}}const By=new Map;function es(n){ns(n instanceof Function,"Expected a class definition");let e=By.get(n);return e?(ns(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,By.set(n,e),e)}class Bv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Bv.type="NONE";const zy=Bv;function pu(n,e,t){return`firebase:${n}:${e}:${t}`}class Ko{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:o,name:l}=this.auth;this.fullUserKey=pu(this.userKey,o.apiKey,l),this.fullPersistenceKey=pu("persistence",o.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Pu(this.auth,{idToken:e}).catch(()=>{});return t?tr._fromGetAccountInfoResponse(this.auth,t,e):null}return tr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Ko(es(zy),e,s);const o=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=o[0]||es(zy);const u=pu(s,e.config.apiKey,e.name);let h=null;for(const y of t)try{const w=await y._get(u);if(w){let T;if(typeof w=="string"){const C=await Pu(e,{idToken:w}).catch(()=>{});if(!C)break;T=await tr._fromGetAccountInfoResponse(e,C,w)}else T=tr._fromJSON(e,w);y!==l&&(h=T),l=y;break}}catch{}const p=o.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new Ko(l,e,s):(l=p[0],h&&await l._set(u,h.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(u)}catch{}})),new Ko(l,e,s))}}function qy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Wv(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(zv(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Gv(e))return"Blackberry";if(Kv(e))return"Webos";if(qv(e))return"Safari";if((e.includes("chrome/")||$v(e))&&!e.includes("edge/"))return"Chrome";if(Hv(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function zv(n=sn()){return/firefox\//i.test(n)}function qv(n=sn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $v(n=sn()){return/crios\//i.test(n)}function Wv(n=sn()){return/iemobile/i.test(n)}function Hv(n=sn()){return/android/i.test(n)}function Gv(n=sn()){return/blackberry/i.test(n)}function Kv(n=sn()){return/webos/i.test(n)}function np(n=sn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function RA(n=sn()){return np(n)&&!!window.navigator?.standalone}function xA(){return qI()&&document.documentMode===10}function Qv(n=sn()){return np(n)||Hv(n)||Kv(n)||Gv(n)||/windows phone/i.test(n)||Wv(n)}function Jv(n,e=[]){let t;switch(n){case"Browser":t=qy(sn());break;case"Worker":t=`${qy(sn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ca}/${s}`}class bA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((u,h)=>{try{const p=e(l);u(p)}catch(p){h(p)}});s.onAbort=t,this.queue.push(s);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function PA(n,e={}){return ua(n,"GET","/v2/passwordPolicy",ep(n,e))}const kA=6;class NA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??kA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let o=0;o<e.length;o++)s=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,o,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class DA{constructor(e,t,s,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $y(this),this.idTokenSubscription=new $y(this),this.beforeStateQueue=new bA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=es(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ko.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Pu(this,{idToken:e}),s=await tr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(er(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=s?._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===u)&&h?.user&&(s=h.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ku(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(er(this.app))return Promise.reject($i(this));const t=e?Rt(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return er(this.app)?Promise.reject($i(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return er(this.app)?Promise.reject($i(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(es(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await PA(this),t=new NA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new kl("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await CA(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&es(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await Ko.create(this,[es(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,o){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(h,this,"internal-error"),h.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,s,o);return()=>{u=!0,p()}}else{const p=e.addObserver(t);return()=>{u=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Jv(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&cA(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Zu(n){return Rt(n)}class $y{constructor(e){this.auth=e,this.observer=null,this.addObserver=XI(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let rp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function OA(n){rp=n}function VA(n){return rp.loadJS(n)}function jA(){return rp.gapiScript}function MA(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function LA(n,e){const t=Jf(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),l=t.getOptions();if(Hi(l,e??{}))return o;kr(o,"already-initialized")}return t.initialize({options:e})}function FA(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(es);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function UA(n,e,t){const s=Zu(n);De(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const o=!1,l=Xv(e),{host:u,port:h}=BA(e),p=h===null?"":`:${h}`,y={url:`${l}//${u}${p}/`},w=Object.freeze({host:u,port:h,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!s._canInitEmulator){De(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),De(Hi(y,s.config.emulator)&&Hi(w,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=y,s.emulatorConfig=w,s.settings.appVerificationDisabledForTesting=!0,la(u)?(Rv(`${l}//${u}${p}`),xv("Auth",!0)):zA()}function Xv(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function BA(n){const e=Xv(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(s);if(o){const l=o[1];return{host:l,port:Wy(s.substr(l.length+1))}}else{const[l,u]=s.split(":");return{host:l,port:Wy(u)}}}function Wy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function zA(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Yv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Zr("not implemented")}_getIdTokenResponse(e){return Zr("not implemented")}_linkToIdToken(e,t){return Zr("not implemented")}_getReauthenticationResolver(e){return Zr("not implemented")}}async function Qo(n,e){return yA(n,"POST","/v1/accounts:signInWithIdp",ep(n,e))}const qA="http://localhost";class Ki extends Yv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ki(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):kr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:o,...l}=t;if(!s||!o)return null;const u=new Ki(s,o);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Qo(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Qo(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qo(e,t)}buildRequest(){const e={requestUri:qA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Nl(t)}return e}}class sp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ol extends sp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ms extends Ol{constructor(){super("facebook.com")}static credential(e){return Ki._fromParams({providerId:Ms.PROVIDER_ID,signInMethod:Ms.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ms.credentialFromTaggedObject(e)}static credentialFromError(e){return Ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ms.credential(e.oauthAccessToken)}catch{return null}}}Ms.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ms.PROVIDER_ID="facebook.com";class Yr extends Ol{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ki._fromParams({providerId:Yr.PROVIDER_ID,signInMethod:Yr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Yr.credentialFromTaggedObject(e)}static credentialFromError(e){return Yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Yr.credential(t,s)}catch{return null}}}Yr.GOOGLE_SIGN_IN_METHOD="google.com";Yr.PROVIDER_ID="google.com";class Ls extends Ol{constructor(){super("github.com")}static credential(e){return Ki._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ls.credential(e.oauthAccessToken)}catch{return null}}}Ls.GITHUB_SIGN_IN_METHOD="github.com";Ls.PROVIDER_ID="github.com";class Fs extends Ol{constructor(){super("twitter.com")}static credential(e,t){return Ki._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Fs.credential(t,s)}catch{return null}}}Fs.TWITTER_SIGN_IN_METHOD="twitter.com";Fs.PROVIDER_ID="twitter.com";class Yo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,o=!1){const l=await tr._fromIdTokenResponse(e,s,o),u=Hy(s);return new Yo({user:l,providerId:u,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const o=Hy(s);return new Yo({user:e,providerId:o,_tokenResponse:s,operationType:t})}}function Hy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Nu extends os{constructor(e,t,s,o){super(t.code,t.message),this.operationType=s,this.user=o,Object.setPrototypeOf(this,Nu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,o){return new Nu(e,t,s,o)}}function Zv(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Nu._fromErrorAndOperation(n,l,e,s):l})}async function $A(n,e,t=!1){const s=await wl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Yo._forOperation(n,"link",s)}async function WA(n,e,t=!1){const{auth:s}=n;if(er(s.app))return Promise.reject($i(s));const o="reauthenticate";try{const l=await wl(n,Zv(s,o,e,n),t);De(l.idToken,s,"internal-error");const u=tp(l.idToken);De(u,s,"internal-error");const{sub:h}=u;return De(n.uid===h,s,"user-mismatch"),Yo._forOperation(n,o,l)}catch(l){throw l?.code==="auth/user-not-found"&&kr(s,"user-mismatch"),l}}async function HA(n,e,t=!1){if(er(n.app))return Promise.reject($i(n));const s="signIn",o=await Zv(n,s,e),l=await Yo._fromIdTokenResponse(n,s,o);return t||await n._updateCurrentUser(l.user),l}function GA(n,e,t,s){return Rt(n).onIdTokenChanged(e,t,s)}function KA(n,e,t){return Rt(n).beforeAuthStateChanged(e,t)}function QA(n,e,t,s){return Rt(n).onAuthStateChanged(e,t,s)}function JA(n){return Rt(n).signOut()}const Du="__sak";class ew{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Du,"1"),this.storage.removeItem(Du),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const XA=1e3,YA=10;class tw extends ew{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Qv(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),o=this.localCache[t];s!==o&&e(t,o,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,h,p)=>{this.notifyListeners(u,p)});return}const s=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(s);!t&&this.localCache[s]===u||this.notifyListeners(s,u)},l=this.storage.getItem(s);xA()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,YA):o()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},XA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}tw.type="LOCAL";const ZA=tw;class nw extends ew{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}nw.type="SESSION";const rw=nw;function e1(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ed{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const s=new ed(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:o,data:l}=t.data,u=this.handlersMap[o];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const h=Array.from(u).map(async y=>y(t.origin,l)),p=await e1(h);t.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ed.receivers=[];function ip(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}class t1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let l,u;return new Promise((h,p)=>{const y=ip("",20);o.port1.start();const w=setTimeout(()=>{p(new Error("unsupported_event"))},s);u={messageChannel:o,onMessage(T){const C=T;if(C.data.eventId===y)switch(C.data.status){case"ack":clearTimeout(w),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),h(C.data.response);break;default:clearTimeout(w),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function Cr(){return window}function n1(n){Cr().location.href=n}function sw(){return typeof Cr().WorkerGlobalScope<"u"&&typeof Cr().importScripts=="function"}async function r1(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function s1(){return navigator?.serviceWorker?.controller||null}function i1(){return sw()?self:null}const iw="firebaseLocalStorageDb",o1=1,Ou="firebaseLocalStorage",ow="fbase_key";class Vl{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function td(n,e){return n.transaction([Ou],e?"readwrite":"readonly").objectStore(Ou)}function a1(){const n=indexedDB.deleteDatabase(iw);return new Vl(n).toPromise()}function Cf(){const n=indexedDB.open(iw,o1);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Ou,{keyPath:ow})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Ou)?e(s):(s.close(),await a1(),e(await Cf()))})})}async function Gy(n,e,t){const s=td(n,!0).put({[ow]:e,value:t});return new Vl(s).toPromise()}async function l1(n,e){const t=td(n,!1).get(e),s=await new Vl(t).toPromise();return s===void 0?null:s.value}function Ky(n,e){const t=td(n,!0).delete(e);return new Vl(t).toPromise()}const c1=800,u1=3;class aw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Cf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>u1)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ed._getInstance(i1()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await r1(),!this.activeServiceWorker)return;this.sender=new t1(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||s1()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Cf();return await Gy(e,Du,"1"),await Ky(e,Du),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Gy(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>l1(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Ky(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const l=td(o,!1).getAll();return new Vl(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:o,value:l}of e)s.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(l)&&(this.notifyListeners(o,l),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!s.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),c1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}aw.type="LOCAL";const d1=aw;new Dl(3e4,6e4);function lw(n,e){return e?es(e):(De(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class op extends Yv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function h1(n){return HA(n.auth,new op(n),n.bypassAuthState)}function f1(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),WA(t,new op(n),n.bypassAuthState)}async function p1(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),$A(t,new op(n),n.bypassAuthState)}class cw{constructor(e,t,s,o,l=!1){this.auth=e,this.resolver=s,this.user=o,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:o,tenantId:l,error:u,type:h}=e;if(u){this.reject(u);return}const p={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(p))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return h1;case"linkViaPopup":case"linkViaRedirect":return p1;case"reauthViaPopup":case"reauthViaRedirect":return f1;default:kr(this.auth,"internal-error")}}resolve(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const m1=new Dl(2e3,1e4);async function g1(n,e,t){if(er(n.app))return Promise.reject(nr(n,"operation-not-supported-in-this-environment"));const s=Zu(n);uA(n,e,sp);const o=lw(s,t);return new Bi(s,"signInViaPopup",e,o).executeNotNull()}class Bi extends cw{constructor(e,t,s,o,l){super(e,t,o,l),this.provider=s,this.authWindow=null,this.pollId=null,Bi.currentPopupAction&&Bi.currentPopupAction.cancel(),Bi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){ns(this.filter.length===1,"Popup operations only handle one event");const e=ip();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(nr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(nr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bi.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,m1.get())};e()}}Bi.currentPopupAction=null;const y1="pendingRedirect",mu=new Map;class _1 extends cw{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=mu.get(this.auth._key());if(!e){try{const s=await v1(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}mu.set(this.auth._key(),e)}return this.bypassAuthState||mu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function v1(n,e){const t=T1(e),s=E1(n);if(!await s._isAvailable())return!1;const o=await s._get(t)==="true";return await s._remove(t),o}function w1(n,e){mu.set(n._key(),e)}function E1(n){return es(n._redirectPersistence)}function T1(n){return pu(y1,n.config.apiKey,n.name)}async function I1(n,e,t=!1){if(er(n.app))return Promise.reject($i(n));const s=Zu(n),o=lw(s,e),u=await new _1(s,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await s._persistUserIfCurrent(u.user),await s._setRedirectUser(null,e)),u}const S1=600*1e3;class A1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!C1(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!uw(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(nr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=S1&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qy(e))}saveEventToCache(e){this.cachedEventUids.add(Qy(e)),this.lastProcessedEventTime=Date.now()}}function Qy(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function uw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function C1(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return uw(n);default:return!1}}async function R1(n,e={}){return ua(n,"GET","/v1/projects",e)}const x1=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,b1=/^https?/;async function P1(n){if(n.config.emulator)return;const{authorizedDomains:e}=await R1(n);for(const t of e)try{if(k1(t))return}catch{}kr(n,"unauthorized-domain")}function k1(n){const e=Sf(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===s}if(!b1.test(t))return!1;if(x1.test(n))return s===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)}const N1=new Dl(3e4,6e4);function Jy(){const n=Cr().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function D1(n){return new Promise((e,t)=>{function s(){Jy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Jy(),t(nr(n,"network-request-failed"))},timeout:N1.get()})}if(Cr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Cr().gapi?.load)s();else{const o=MA("iframefcb");return Cr()[o]=()=>{gapi.load?s():t(nr(n,"network-request-failed"))},VA(`${jA()}?onload=${o}`).catch(l=>t(l))}}).catch(e=>{throw gu=null,e})}let gu=null;function O1(n){return gu=gu||D1(n),gu}const V1=new Dl(5e3,15e3),j1="__/auth/iframe",M1="emulator/auth/iframe",L1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},F1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function U1(n){const e=n.config;De(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Zf(e,M1):`https://${n.config.authDomain}/${j1}`,s={apiKey:e.apiKey,appName:n.name,v:ca},o=F1.get(n.config.apiHost);o&&(s.eid=o);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${Nl(s).slice(1)}`}async function B1(n){const e=await O1(n),t=Cr().gapi;return De(t,n,"internal-error"),e.open({where:document.body,url:U1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:L1,dontclear:!0},s=>new Promise(async(o,l)=>{await s.restyle({setHideOnLeave:!1});const u=nr(n,"network-request-failed"),h=Cr().setTimeout(()=>{l(u)},V1.get());function p(){Cr().clearTimeout(h),o(s)}s.ping(p).then(p,()=>{l(u)})}))}const z1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},q1=500,$1=600,W1="_blank",H1="http://localhost";class Xy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function G1(n,e,t,s=q1,o=$1){const l=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-s)/2,0).toString();let h="";const p={...z1,width:s.toString(),height:o.toString(),top:l,left:u},y=sn().toLowerCase();t&&(h=$v(y)?W1:t),zv(y)&&(e=e||H1,p.scrollbars="yes");const w=Object.entries(p).reduce((C,[k,$])=>`${C}${k}=${$},`,"");if(RA(y)&&h!=="_self")return K1(e||"",h),new Xy(null);const T=window.open(e||"",h,w);De(T,n,"popup-blocked");try{T.focus()}catch{}return new Xy(T)}function K1(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}const Q1="__/auth/handler",J1="emulator/auth/handler",X1=encodeURIComponent("fac");async function Yy(n,e,t,s,o,l){De(n.config.authDomain,n,"auth-domain-config-required"),De(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:ca,eventId:o};if(e instanceof sp){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",JI(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,T]of Object.entries({}))u[w]=T}if(e instanceof Ol){const w=e.getScopes().filter(T=>T!=="");w.length>0&&(u.scopes=w.join(","))}n.tenantId&&(u.tid=n.tenantId);const h=u;for(const w of Object.keys(h))h[w]===void 0&&delete h[w];const p=await n._getAppCheckToken(),y=p?`#${X1}=${encodeURIComponent(p)}`:"";return`${Y1(n)}?${Nl(h).slice(1)}${y}`}function Y1({config:n}){return n.emulator?Zf(n,J1):`https://${n.authDomain}/${Q1}`}const of="webStorageSupport";class Z1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rw,this._completeRedirectFn=I1,this._overrideRedirectResult=w1}async _openPopup(e,t,s,o){ns(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await Yy(e,t,s,Sf(),o);return G1(e,l,ip())}async _openRedirect(e,t,s,o){await this._originValidation(e);const l=await Yy(e,t,s,Sf(),o);return n1(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:l}=this.eventManagers[t];return o?Promise.resolve(o):(ns(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await B1(e),s=new A1(e);return t.register("authEvent",o=>(De(o?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(of,{type:of},o=>{const l=o?.[0]?.[of];l!==void 0&&t(!!l),kr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=P1(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Qv()||qv()||np()}}const eC=Z1;var Zy="@firebase/auth",e_="1.12.0";class tC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function nC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rC(n){Xo(new Gi("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=s.options;De(u&&!u.includes(":"),"invalid-api-key",{appName:s.name});const p={apiKey:u,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Jv(n)},y=new DA(s,o,l,p);return FA(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Xo(new Gi("auth-internal",e=>{const t=Zu(e.getProvider("auth").getImmediate());return(s=>new tC(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Hs(Zy,e_,nC(n)),Hs(Zy,e_,"esm2020")}const sC=300,iC=Cv("authIdTokenMaxAge")||sC;let t_=null;const oC=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>iC)return;const o=t?.token;t_!==o&&(t_=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function aC(n=Nv()){const e=Jf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=LA(n,{popupRedirectResolver:eC,persistence:[d1,ZA,rw]}),s=Cv("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const u=oC(l.toString());KA(t,u,()=>u(t.currentUser)),GA(t,h=>u(h))}}const o=Sv("auth");return o&&UA(t,`http://${o}`),t}function lC(){return document.getElementsByTagName("head")?.[0]??document}OA({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=o=>{const l=nr("internal-error");l.customData=o,t(l)},s.type="text/javascript",s.charset="UTF-8",lC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rC("Browser");var n_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Gs,dw;(function(){var n;function e(I,S){function R(){}R.prototype=S.prototype,I.F=S.prototype,I.prototype=new R,I.prototype.constructor=I,I.D=function(V,N,P){for(var x=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)x[ge-2]=arguments[ge];return S.prototype[N].apply(V,x)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(I,S,R){R||(R=0);const V=Array(16);if(typeof S=="string")for(var N=0;N<16;++N)V[N]=S.charCodeAt(R++)|S.charCodeAt(R++)<<8|S.charCodeAt(R++)<<16|S.charCodeAt(R++)<<24;else for(N=0;N<16;++N)V[N]=S[R++]|S[R++]<<8|S[R++]<<16|S[R++]<<24;S=I.g[0],R=I.g[1],N=I.g[2];let P=I.g[3],x;x=S+(P^R&(N^P))+V[0]+3614090360&4294967295,S=R+(x<<7&4294967295|x>>>25),x=P+(N^S&(R^N))+V[1]+3905402710&4294967295,P=S+(x<<12&4294967295|x>>>20),x=N+(R^P&(S^R))+V[2]+606105819&4294967295,N=P+(x<<17&4294967295|x>>>15),x=R+(S^N&(P^S))+V[3]+3250441966&4294967295,R=N+(x<<22&4294967295|x>>>10),x=S+(P^R&(N^P))+V[4]+4118548399&4294967295,S=R+(x<<7&4294967295|x>>>25),x=P+(N^S&(R^N))+V[5]+1200080426&4294967295,P=S+(x<<12&4294967295|x>>>20),x=N+(R^P&(S^R))+V[6]+2821735955&4294967295,N=P+(x<<17&4294967295|x>>>15),x=R+(S^N&(P^S))+V[7]+4249261313&4294967295,R=N+(x<<22&4294967295|x>>>10),x=S+(P^R&(N^P))+V[8]+1770035416&4294967295,S=R+(x<<7&4294967295|x>>>25),x=P+(N^S&(R^N))+V[9]+2336552879&4294967295,P=S+(x<<12&4294967295|x>>>20),x=N+(R^P&(S^R))+V[10]+4294925233&4294967295,N=P+(x<<17&4294967295|x>>>15),x=R+(S^N&(P^S))+V[11]+2304563134&4294967295,R=N+(x<<22&4294967295|x>>>10),x=S+(P^R&(N^P))+V[12]+1804603682&4294967295,S=R+(x<<7&4294967295|x>>>25),x=P+(N^S&(R^N))+V[13]+4254626195&4294967295,P=S+(x<<12&4294967295|x>>>20),x=N+(R^P&(S^R))+V[14]+2792965006&4294967295,N=P+(x<<17&4294967295|x>>>15),x=R+(S^N&(P^S))+V[15]+1236535329&4294967295,R=N+(x<<22&4294967295|x>>>10),x=S+(N^P&(R^N))+V[1]+4129170786&4294967295,S=R+(x<<5&4294967295|x>>>27),x=P+(R^N&(S^R))+V[6]+3225465664&4294967295,P=S+(x<<9&4294967295|x>>>23),x=N+(S^R&(P^S))+V[11]+643717713&4294967295,N=P+(x<<14&4294967295|x>>>18),x=R+(P^S&(N^P))+V[0]+3921069994&4294967295,R=N+(x<<20&4294967295|x>>>12),x=S+(N^P&(R^N))+V[5]+3593408605&4294967295,S=R+(x<<5&4294967295|x>>>27),x=P+(R^N&(S^R))+V[10]+38016083&4294967295,P=S+(x<<9&4294967295|x>>>23),x=N+(S^R&(P^S))+V[15]+3634488961&4294967295,N=P+(x<<14&4294967295|x>>>18),x=R+(P^S&(N^P))+V[4]+3889429448&4294967295,R=N+(x<<20&4294967295|x>>>12),x=S+(N^P&(R^N))+V[9]+568446438&4294967295,S=R+(x<<5&4294967295|x>>>27),x=P+(R^N&(S^R))+V[14]+3275163606&4294967295,P=S+(x<<9&4294967295|x>>>23),x=N+(S^R&(P^S))+V[3]+4107603335&4294967295,N=P+(x<<14&4294967295|x>>>18),x=R+(P^S&(N^P))+V[8]+1163531501&4294967295,R=N+(x<<20&4294967295|x>>>12),x=S+(N^P&(R^N))+V[13]+2850285829&4294967295,S=R+(x<<5&4294967295|x>>>27),x=P+(R^N&(S^R))+V[2]+4243563512&4294967295,P=S+(x<<9&4294967295|x>>>23),x=N+(S^R&(P^S))+V[7]+1735328473&4294967295,N=P+(x<<14&4294967295|x>>>18),x=R+(P^S&(N^P))+V[12]+2368359562&4294967295,R=N+(x<<20&4294967295|x>>>12),x=S+(R^N^P)+V[5]+4294588738&4294967295,S=R+(x<<4&4294967295|x>>>28),x=P+(S^R^N)+V[8]+2272392833&4294967295,P=S+(x<<11&4294967295|x>>>21),x=N+(P^S^R)+V[11]+1839030562&4294967295,N=P+(x<<16&4294967295|x>>>16),x=R+(N^P^S)+V[14]+4259657740&4294967295,R=N+(x<<23&4294967295|x>>>9),x=S+(R^N^P)+V[1]+2763975236&4294967295,S=R+(x<<4&4294967295|x>>>28),x=P+(S^R^N)+V[4]+1272893353&4294967295,P=S+(x<<11&4294967295|x>>>21),x=N+(P^S^R)+V[7]+4139469664&4294967295,N=P+(x<<16&4294967295|x>>>16),x=R+(N^P^S)+V[10]+3200236656&4294967295,R=N+(x<<23&4294967295|x>>>9),x=S+(R^N^P)+V[13]+681279174&4294967295,S=R+(x<<4&4294967295|x>>>28),x=P+(S^R^N)+V[0]+3936430074&4294967295,P=S+(x<<11&4294967295|x>>>21),x=N+(P^S^R)+V[3]+3572445317&4294967295,N=P+(x<<16&4294967295|x>>>16),x=R+(N^P^S)+V[6]+76029189&4294967295,R=N+(x<<23&4294967295|x>>>9),x=S+(R^N^P)+V[9]+3654602809&4294967295,S=R+(x<<4&4294967295|x>>>28),x=P+(S^R^N)+V[12]+3873151461&4294967295,P=S+(x<<11&4294967295|x>>>21),x=N+(P^S^R)+V[15]+530742520&4294967295,N=P+(x<<16&4294967295|x>>>16),x=R+(N^P^S)+V[2]+3299628645&4294967295,R=N+(x<<23&4294967295|x>>>9),x=S+(N^(R|~P))+V[0]+4096336452&4294967295,S=R+(x<<6&4294967295|x>>>26),x=P+(R^(S|~N))+V[7]+1126891415&4294967295,P=S+(x<<10&4294967295|x>>>22),x=N+(S^(P|~R))+V[14]+2878612391&4294967295,N=P+(x<<15&4294967295|x>>>17),x=R+(P^(N|~S))+V[5]+4237533241&4294967295,R=N+(x<<21&4294967295|x>>>11),x=S+(N^(R|~P))+V[12]+1700485571&4294967295,S=R+(x<<6&4294967295|x>>>26),x=P+(R^(S|~N))+V[3]+2399980690&4294967295,P=S+(x<<10&4294967295|x>>>22),x=N+(S^(P|~R))+V[10]+4293915773&4294967295,N=P+(x<<15&4294967295|x>>>17),x=R+(P^(N|~S))+V[1]+2240044497&4294967295,R=N+(x<<21&4294967295|x>>>11),x=S+(N^(R|~P))+V[8]+1873313359&4294967295,S=R+(x<<6&4294967295|x>>>26),x=P+(R^(S|~N))+V[15]+4264355552&4294967295,P=S+(x<<10&4294967295|x>>>22),x=N+(S^(P|~R))+V[6]+2734768916&4294967295,N=P+(x<<15&4294967295|x>>>17),x=R+(P^(N|~S))+V[13]+1309151649&4294967295,R=N+(x<<21&4294967295|x>>>11),x=S+(N^(R|~P))+V[4]+4149444226&4294967295,S=R+(x<<6&4294967295|x>>>26),x=P+(R^(S|~N))+V[11]+3174756917&4294967295,P=S+(x<<10&4294967295|x>>>22),x=N+(S^(P|~R))+V[2]+718787259&4294967295,N=P+(x<<15&4294967295|x>>>17),x=R+(P^(N|~S))+V[9]+3951481745&4294967295,I.g[0]=I.g[0]+S&4294967295,I.g[1]=I.g[1]+(N+(x<<21&4294967295|x>>>11))&4294967295,I.g[2]=I.g[2]+N&4294967295,I.g[3]=I.g[3]+P&4294967295}s.prototype.v=function(I,S){S===void 0&&(S=I.length);const R=S-this.blockSize,V=this.C;let N=this.h,P=0;for(;P<S;){if(N==0)for(;P<=R;)o(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<S;)if(V[N++]=I.charCodeAt(P++),N==this.blockSize){o(this,V),N=0;break}}else for(;P<S;)if(V[N++]=I[P++],N==this.blockSize){o(this,V),N=0;break}}this.h=N,this.o+=S},s.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var S=1;S<I.length-8;++S)I[S]=0;S=this.o*8;for(var R=I.length-8;R<I.length;++R)I[R]=S&255,S/=256;for(this.v(I),I=Array(16),S=0,R=0;R<4;++R)for(let V=0;V<32;V+=8)I[S++]=this.g[R]>>>V&255;return I};function l(I,S){var R=h;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=S(I)}function u(I,S){this.h=S;const R=[];let V=!0;for(let N=I.length-1;N>=0;N--){const P=I[N]|0;V&&P==S||(R[N]=P,V=!1)}this.g=R}var h={};function p(I){return-128<=I&&I<128?l(I,function(S){return new u([S|0],S<0?-1:0)}):new u([I|0],I<0?-1:0)}function y(I){if(isNaN(I)||!isFinite(I))return T;if(I<0)return O(y(-I));const S=[];let R=1;for(let V=0;I>=R;V++)S[V]=I/R|0,R*=4294967296;return new u(S,0)}function w(I,S){if(I.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(I.charAt(0)=="-")return O(w(I.substring(1),S));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=y(Math.pow(S,8));let V=T;for(let P=0;P<I.length;P+=8){var N=Math.min(8,I.length-P);const x=parseInt(I.substring(P,P+N),S);N<8?(N=y(Math.pow(S,N)),V=V.j(N).add(y(x))):(V=V.j(R),V=V.add(y(x)))}return V}var T=p(0),C=p(1),k=p(16777216);n=u.prototype,n.m=function(){if(j(this))return-O(this).m();let I=0,S=1;for(let R=0;R<this.g.length;R++){const V=this.i(R);I+=(V>=0?V:4294967296+V)*S,S*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if($(this))return"0";if(j(this))return"-"+O(this).toString(I);const S=y(Math.pow(I,6));var R=this;let V="";for(;;){const N=q(R,S).g;R=Z(R,N.j(S));let P=((R.g.length>0?R.g[0]:R.h)>>>0).toString(I);if(R=N,$(R))return P+V;for(;P.length<6;)P="0"+P;V=P+V}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function $(I){if(I.h!=0)return!1;for(let S=0;S<I.g.length;S++)if(I.g[S]!=0)return!1;return!0}function j(I){return I.h==-1}n.l=function(I){return I=Z(this,I),j(I)?-1:$(I)?0:1};function O(I){const S=I.g.length,R=[];for(let V=0;V<S;V++)R[V]=~I.g[V];return new u(R,~I.h).add(C)}n.abs=function(){return j(this)?O(this):this},n.add=function(I){const S=Math.max(this.g.length,I.g.length),R=[];let V=0;for(let N=0;N<=S;N++){let P=V+(this.i(N)&65535)+(I.i(N)&65535),x=(P>>>16)+(this.i(N)>>>16)+(I.i(N)>>>16);V=x>>>16,P&=65535,x&=65535,R[N]=x<<16|P}return new u(R,R[R.length-1]&-2147483648?-1:0)};function Z(I,S){return I.add(O(S))}n.j=function(I){if($(this)||$(I))return T;if(j(this))return j(I)?O(this).j(O(I)):O(O(this).j(I));if(j(I))return O(this.j(O(I)));if(this.l(k)<0&&I.l(k)<0)return y(this.m()*I.m());const S=this.g.length+I.g.length,R=[];for(var V=0;V<2*S;V++)R[V]=0;for(V=0;V<this.g.length;V++)for(let N=0;N<I.g.length;N++){const P=this.i(V)>>>16,x=this.i(V)&65535,ge=I.i(N)>>>16,Ue=I.i(N)&65535;R[2*V+2*N]+=x*Ue,G(R,2*V+2*N),R[2*V+2*N+1]+=P*Ue,G(R,2*V+2*N+1),R[2*V+2*N+1]+=x*ge,G(R,2*V+2*N+1),R[2*V+2*N+2]+=P*ge,G(R,2*V+2*N+2)}for(I=0;I<S;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=S;I<2*S;I++)R[I]=0;return new u(R,0)};function G(I,S){for(;(I[S]&65535)!=I[S];)I[S+1]+=I[S]>>>16,I[S]&=65535,S++}function X(I,S){this.g=I,this.h=S}function q(I,S){if($(S))throw Error("division by zero");if($(I))return new X(T,T);if(j(I))return S=q(O(I),S),new X(O(S.g),O(S.h));if(j(S))return S=q(I,O(S)),new X(O(S.g),S.h);if(I.g.length>30){if(j(I)||j(S))throw Error("slowDivide_ only works with positive integers.");for(var R=C,V=S;V.l(I)<=0;)R=M(R),V=M(V);var N=H(R,1),P=H(V,1);for(V=H(V,2),R=H(R,2);!$(V);){var x=P.add(V);x.l(I)<=0&&(N=N.add(R),P=x),V=H(V,1),R=H(R,1)}return S=Z(I,N.j(S)),new X(N,S)}for(N=T;I.l(S)>=0;){for(R=Math.max(1,Math.floor(I.m()/S.m())),V=Math.ceil(Math.log(R)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),P=y(R),x=P.j(S);j(x)||x.l(I)>0;)R-=V,P=y(R),x=P.j(S);$(P)&&(P=C),N=N.add(P),I=Z(I,x)}return new X(N,I)}n.B=function(I){return q(this,I).h},n.and=function(I){const S=Math.max(this.g.length,I.g.length),R=[];for(let V=0;V<S;V++)R[V]=this.i(V)&I.i(V);return new u(R,this.h&I.h)},n.or=function(I){const S=Math.max(this.g.length,I.g.length),R=[];for(let V=0;V<S;V++)R[V]=this.i(V)|I.i(V);return new u(R,this.h|I.h)},n.xor=function(I){const S=Math.max(this.g.length,I.g.length),R=[];for(let V=0;V<S;V++)R[V]=this.i(V)^I.i(V);return new u(R,this.h^I.h)};function M(I){const S=I.g.length+1,R=[];for(let V=0;V<S;V++)R[V]=I.i(V)<<1|I.i(V-1)>>>31;return new u(R,I.h)}function H(I,S){const R=S>>5;S%=32;const V=I.g.length-R,N=[];for(let P=0;P<V;P++)N[P]=S>0?I.i(P+R)>>>S|I.i(P+R+1)<<32-S:I.i(P+R);return new u(N,I.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,dw=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=y,u.fromString=w,Gs=u}).apply(typeof n_<"u"?n_:typeof self<"u"?self:typeof window<"u"?window:{});var su=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var hw,al,fw,yu,Rf,pw,mw,gw;(function(){var n,e=Object.defineProperty;function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof su=="object"&&su];for(var g=0;g<c.length;++g){var _=c[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function o(c,g){if(g)e:{var _=s;c=c.split(".");for(var A=0;A<c.length-1;A++){var B=c[A];if(!(B in _))break e;_=_[B]}c=c[c.length-1],A=_[c],g=g(A),g!=A&&g!=null&&e(_,c,{configurable:!0,writable:!0,value:g})}}o("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(c){return c||function(g){var _=[],A;for(A in g)Object.prototype.hasOwnProperty.call(g,A)&&_.push([A,g[A]]);return _}});var l=l||{},u=this||self;function h(c){var g=typeof c;return g=="object"&&c!=null||g=="function"}function p(c,g,_){return c.call.apply(c.bind,arguments)}function y(c,g,_){return y=p,y.apply(null,arguments)}function w(c,g){var _=Array.prototype.slice.call(arguments,1);return function(){var A=_.slice();return A.push.apply(A,arguments),c.apply(this,A)}}function T(c,g){function _(){}_.prototype=g.prototype,c.Z=g.prototype,c.prototype=new _,c.prototype.constructor=c,c.Ob=function(A,B,K){for(var ie=Array(arguments.length-2),je=2;je<arguments.length;je++)ie[je-2]=arguments[je];return g.prototype[B].apply(A,ie)}}var C=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function k(c){const g=c.length;if(g>0){const _=Array(g);for(let A=0;A<g;A++)_[A]=c[A];return _}return[]}function $(c,g){for(let A=1;A<arguments.length;A++){const B=arguments[A];var _=typeof B;if(_=_!="object"?_:B?Array.isArray(B)?"array":_:"null",_=="array"||_=="object"&&typeof B.length=="number"){_=c.length||0;const K=B.length||0;c.length=_+K;for(let ie=0;ie<K;ie++)c[_+ie]=B[ie]}else c.push(B)}}class j{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return this.h>0?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function O(c){u.setTimeout(()=>{throw c},0)}function Z(){var c=I;let g=null;return c.g&&(g=c.g,c.g=c.g.next,c.g||(c.h=null),g.next=null),g}class G{constructor(){this.h=this.g=null}add(g,_){const A=X.get();A.set(g,_),this.h?this.h.next=A:this.g=A,this.h=A}}var X=new j(()=>new q,c=>c.reset());class q{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let M,H=!1,I=new G,S=()=>{const c=Promise.resolve(void 0);M=()=>{c.then(R)}};function R(){for(var c;c=Z();){try{c.h.call(c.g)}catch(_){O(_)}var g=X;g.j(c),g.h<100&&(g.h++,c.next=g.g,g.g=c)}H=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(c,g){this.type=c,this.g=this.target=g,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var P=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var c=!1,g=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const _=()=>{};u.addEventListener("test",_,g),u.removeEventListener("test",_,g)}catch{}return c})();function x(c){return/^[\s\xa0]*$/.test(c)}function ge(c,g){N.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,g)}T(ge,N),ge.prototype.init=function(c,g){const _=this.type=c.type,A=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=g,g=c.relatedTarget,g||(_=="mouseover"?g=c.fromElement:_=="mouseout"&&(g=c.toElement)),this.relatedTarget=g,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&ge.Z.h.call(this)},ge.prototype.h=function(){ge.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ue="closure_listenable_"+(Math.random()*1e6|0),Ke=0;function xe(c,g,_,A,B){this.listener=c,this.proxy=null,this.src=g,this.type=_,this.capture=!!A,this.ha=B,this.key=++Ke,this.da=this.fa=!1}function re(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ve(c,g,_){for(const A in c)g.call(_,c[A],A,c)}function ae(c,g){for(const _ in c)g.call(void 0,c[_],_,c)}function D(c){const g={};for(const _ in c)g[_]=c[_];return g}const Q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(c,g){let _,A;for(let B=1;B<arguments.length;B++){A=arguments[B];for(_ in A)c[_]=A[_];for(let K=0;K<Q.length;K++)_=Q[K],Object.prototype.hasOwnProperty.call(A,_)&&(c[_]=A[_])}}function we(c){this.src=c,this.g={},this.h=0}we.prototype.add=function(c,g,_,A,B){const K=c.toString();c=this.g[K],c||(c=this.g[K]=[],this.h++);const ie=pe(c,g,A,B);return ie>-1?(g=c[ie],_||(g.fa=!1)):(g=new xe(g,this.src,K,!!A,B),g.fa=_,c.push(g)),g};function Te(c,g){const _=g.type;if(_ in c.g){var A=c.g[_],B=Array.prototype.indexOf.call(A,g,void 0),K;(K=B>=0)&&Array.prototype.splice.call(A,B,1),K&&(re(g),c.g[_].length==0&&(delete c.g[_],c.h--))}}function pe(c,g,_,A){for(let B=0;B<c.length;++B){const K=c[B];if(!K.da&&K.listener==g&&K.capture==!!_&&K.ha==A)return B}return-1}var Ve="closure_lm_"+(Math.random()*1e6|0),ke={};function Le(c,g,_,A,B){if(Array.isArray(g)){for(let K=0;K<g.length;K++)Le(c,g[K],_,A,B);return null}return _=ir(_),c&&c[Ue]?c.J(g,_,h(A)?!!A.capture:!1,B):Pe(c,g,_,!1,A,B)}function Pe(c,g,_,A,B,K){if(!g)throw Error("Invalid event type");const ie=h(B)?!!B.capture:!!B;let je=Qt(c);if(je||(c[Ve]=je=new we(c)),_=je.add(g,_,A,ie,K),_.proxy)return _;if(A=lt(),_.proxy=A,A.src=c,A.listener=_,c.addEventListener)P||(B=ie),B===void 0&&(B=!1),c.addEventListener(g.toString(),A,B);else if(c.attachEvent)c.attachEvent(Gt(g.toString()),A);else if(c.addListener&&c.removeListener)c.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return _}function lt(){function c(_){return g.call(c.src,c.listener,_)}const g=Kt;return c}function cn(c,g,_,A,B){if(Array.isArray(g))for(var K=0;K<g.length;K++)cn(c,g[K],_,A,B);else A=h(A)?!!A.capture:!!A,_=ir(_),c&&c[Ue]?(c=c.i,K=String(g).toString(),K in c.g&&(g=c.g[K],_=pe(g,_,A,B),_>-1&&(re(g[_]),Array.prototype.splice.call(g,_,1),g.length==0&&(delete c.g[K],c.h--)))):c&&(c=Qt(c))&&(g=c.g[g.toString()],c=-1,g&&(c=pe(g,_,A,B)),(_=c>-1?g[c]:null)&&Ht(_))}function Ht(c){if(typeof c!="number"&&c&&!c.da){var g=c.src;if(g&&g[Ue])Te(g.i,c);else{var _=c.type,A=c.proxy;g.removeEventListener?g.removeEventListener(_,A,c.capture):g.detachEvent?g.detachEvent(Gt(_),A):g.addListener&&g.removeListener&&g.removeListener(A),(_=Qt(g))?(Te(_,c),_.h==0&&(_.src=null,g[Ve]=null)):re(c)}}}function Gt(c){return c in ke?ke[c]:ke[c]="on"+c}function Kt(c,g){if(c.da)c=!0;else{g=new ge(g,this);const _=c.listener,A=c.ha||c.src;c.fa&&Ht(c),c=_.call(A,g)}return c}function Qt(c){return c=c[Ve],c instanceof we?c:null}var qn="__closure_events_fn_"+(Math.random()*1e9>>>0);function ir(c){return typeof c=="function"?c:(c[qn]||(c[qn]=function(g){return c.handleEvent(g)}),c[qn])}function ct(){V.call(this),this.i=new we(this),this.M=this,this.G=null}T(ct,V),ct.prototype[Ue]=!0,ct.prototype.removeEventListener=function(c,g,_,A){cn(this,c,g,_,A)};function ut(c,g){var _,A=c.G;if(A)for(_=[];A;A=A.G)_.push(A);if(c=c.M,A=g.type||g,typeof g=="string")g=new N(g,c);else if(g instanceof N)g.target=g.target||c;else{var B=g;g=new N(A,c),fe(g,B)}B=!0;let K,ie;if(_)for(ie=_.length-1;ie>=0;ie--)K=g.g=_[ie],B=yn(K,A,!0,g)&&B;if(K=g.g=c,B=yn(K,A,!0,g)&&B,B=yn(K,A,!1,g)&&B,_)for(ie=0;ie<_.length;ie++)K=g.g=_[ie],B=yn(K,A,!1,g)&&B}ct.prototype.N=function(){if(ct.Z.N.call(this),this.i){var c=this.i;for(const g in c.g){const _=c.g[g];for(let A=0;A<_.length;A++)re(_[A]);delete c.g[g],c.h--}}this.G=null},ct.prototype.J=function(c,g,_,A){return this.i.add(String(c),g,!1,_,A)},ct.prototype.K=function(c,g,_,A){return this.i.add(String(c),g,!0,_,A)};function yn(c,g,_,A){if(g=c.i.g[String(g)],!g)return!0;g=g.concat();let B=!0;for(let K=0;K<g.length;++K){const ie=g[K];if(ie&&!ie.da&&ie.capture==_){const je=ie.listener,_t=ie.ha||ie.src;ie.fa&&Te(c.i,ie),B=je.call(_t,A)!==!1&&B}}return B&&!A.defaultPrevented}function ui(c,g){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=y(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(g)>2147483647?-1:u.setTimeout(c,g||0)}function Ie(c){c.g=ui(()=>{c.g=null,c.i&&(c.i=!1,Ie(c))},c.l);const g=c.h;c.h=null,c.m.apply(null,g)}class Mt extends V{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Ie(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function We(c){V.call(this),this.h=c,this.g={}}T(We,V);var $n=[];function _n(c){ve(c.g,function(g,_){this.g.hasOwnProperty(_)&&Ht(g)},c),c.g={}}We.prototype.N=function(){We.Z.N.call(this),_n(this)},We.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Jt=u.JSON.stringify,or=u.JSON.parse,di=class{stringify(c){return u.JSON.stringify(c,void 0)}parse(c){return u.JSON.parse(c,void 0)}};function cs(){}function $l(){}var us={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function eo(){N.call(this,"d")}T(eo,N);function ya(){N.call(this,"c")}T(ya,N);var Wn={},to=null;function ds(){return to=to||new ct}Wn.Ia="serverreachability";function no(c){N.call(this,Wn.Ia,c)}T(no,N);function Or(c){const g=ds();ut(g,new no(g))}Wn.STAT_EVENT="statevent";function Vr(c,g){N.call(this,Wn.STAT_EVENT,c),this.stat=g}T(Vr,N);function pt(c){const g=ds();ut(g,new Vr(g,c))}Wn.Ja="timingevent";function _a(c,g){N.call(this,Wn.Ja,c),this.size=g}T(_a,N);function hs(c,g){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){c()},g)}function fs(){this.g=!0}fs.prototype.ua=function(){this.g=!1};function Wl(c,g,_,A,B,K){c.info(function(){if(c.g)if(K){var ie="",je=K.split("&");for(let Ze=0;Ze<je.length;Ze++){var _t=je[Ze].split("=");if(_t.length>1){const Tt=_t[0];_t=_t[1];const Sn=Tt.split("_");ie=Sn.length>=2&&Sn[1]=="type"?ie+(Tt+"="+_t+"&"):ie+(Tt+"=redacted&")}}}else ie=null;else ie=K;return"XMLHTTP REQ ("+A+") [attempt "+B+"]: "+g+`
`+_+`
`+ie})}function Hl(c,g,_,A,B,K,ie){c.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+B+"]: "+g+`
`+_+`
`+K+" "+ie})}function ar(c,g,_,A){c.info(function(){return"XMLHTTP TEXT ("+g+"): "+hi(c,_)+(A?" "+A:"")})}function Gl(c,g){c.info(function(){return"TIMEOUT: "+g})}fs.prototype.info=function(){};function hi(c,g){if(!c.g)return g;if(!g)return null;try{const K=JSON.parse(g);if(K){for(c=0;c<K.length;c++)if(Array.isArray(K[c])){var _=K[c];if(!(_.length<2)){var A=_[1];if(Array.isArray(A)&&!(A.length<1)){var B=A[0];if(B!="noop"&&B!="stop"&&B!="close")for(let ie=1;ie<A.length;ie++)A[ie]=""}}}}return Jt(K)}catch{return g}}var ps={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ms={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Kl;function jr(){}T(jr,cs),jr.prototype.g=function(){return new XMLHttpRequest},Kl=new jr;function lr(c){return encodeURIComponent(String(c))}function ro(c){var g=1;c=c.split(":");const _=[];for(;g>0&&c.length;)_.push(c.shift()),g--;return c.length&&_.push(c.join(":")),_}function Nn(c,g,_,A){this.j=c,this.i=g,this.l=_,this.S=A||1,this.V=new We(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ql}function Ql(){this.i=null,this.g="",this.h=!1}var Jl={},va={};function Hn(c,g,_){c.M=1,c.A=Lr(Dn(g)),c.u=_,c.R=!0,wa(c,null)}function wa(c,g){c.F=Date.now(),fi(c),c.B=Dn(c.A);var _=c.B,A=c.S;Array.isArray(A)||(A=[String(A)]),Pa(_.i,"t",A),c.C=0,_=c.j.L,c.h=new Ql,c.g=oc(c.j,_?g:null,!c.u),c.P>0&&(c.O=new Mt(y(c.Y,c,c.g),c.P)),g=c.V,_=c.g,A=c.ba;var B="readystatechange";Array.isArray(B)||(B&&($n[0]=B.toString()),B=$n);for(let K=0;K<B.length;K++){const ie=Le(_,B[K],A||g.handleEvent,!1,g.h||g);if(!ie)break;g.g[ie.key]=ie}g=c.J?D(c.J):{},c.u?(c.v||(c.v="POST"),g["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,g)):(c.v="GET",c.g.ea(c.B,c.v,null,g)),Or(),Wl(c.i,c.v,c.B,c.l,c.S,c.u)}Nn.prototype.ba=function(c){c=c.target;const g=this.O;g&&mr(c)==3?g.j():this.Y(c)},Nn.prototype.Y=function(c){try{if(c==this.g)e:{const je=mr(this.g),_t=this.g.ya(),Ze=this.g.ca();if(!(je<3)&&(je!=3||this.g&&(this.h.h||this.g.la()||sc(this.g)))){this.K||je!=4||_t==7||(_t==8||Ze<=0?Or(3):Or(2)),so(this);var g=this.g.ca();this.X=g;var _=Xl(this);if(this.o=g==200,Hl(this.i,this.v,this.B,this.l,this.S,je,g),this.o){if(this.U&&!this.L){t:{if(this.g){var A,B=this.g;if((A=B.g?B.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(A)){var K=A;break t}}K=null}if(c=K)ar(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,rt(this,c);else{this.o=!1,this.m=3,pt(12),Mr(this),pi(this);break e}}if(this.R){c=!0;let Tt;for(;!this.K&&this.C<_.length;)if(Tt=Zl(this,_),Tt==va){je==4&&(this.m=4,pt(14),c=!1),ar(this.i,this.l,null,"[Incomplete Response]");break}else if(Tt==Jl){this.m=4,pt(15),ar(this.i,this.l,_,"[Invalid Chunk]"),c=!1;break}else ar(this.i,this.l,Tt,null),rt(this,Tt);if(Yl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),je!=4||_.length!=0||this.h.h||(this.m=1,pt(16),c=!1),this.o=this.o&&c,!c)ar(this.i,this.l,_,"[Invalid Chunked Response]"),Mr(this),pi(this);else if(_.length>0&&!this.W){this.W=!0;var ie=this.j;ie.g==this&&ie.aa&&!ie.P&&(ie.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),Ii(ie),ie.P=!0,pt(11))}}else ar(this.i,this.l,_,null),rt(this,_);je==4&&Mr(this),this.o&&!this.K&&(je==4?mo(this.j,this):(this.o=!1,fi(this)))}else Na(this.g),g==400&&_.indexOf("Unknown SID")>0?(this.m=3,pt(12)):(this.m=0,pt(13)),Mr(this),pi(this)}}}catch{}};function Xl(c){if(!Yl(c))return c.g.la();const g=sc(c.g);if(g==="")return"";let _="";const A=g.length,B=mr(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Mr(c),pi(c),"";c.h.i=new u.TextDecoder}for(let K=0;K<A;K++)c.h.h=!0,_+=c.h.i.decode(g[K],{stream:!(B&&K==A-1)});return g.length=0,c.h.g+=_,c.C=0,c.h.g}function Yl(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Zl(c,g){var _=c.C,A=g.indexOf(`
`,_);return A==-1?va:(_=Number(g.substring(_,A)),isNaN(_)?Jl:(A+=1,A+_>g.length?va:(g=g.slice(A,A+_),c.C=A+_,g)))}Nn.prototype.cancel=function(){this.K=!0,Mr(this)};function fi(c){c.T=Date.now()+c.H,Ea(c,c.H)}function Ea(c,g){if(c.D!=null)throw Error("WatchDog timer not null");c.D=hs(y(c.aa,c),g)}function so(c){c.D&&(u.clearTimeout(c.D),c.D=null)}Nn.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Gl(this.i,this.B),this.M!=2&&(Or(),pt(17)),Mr(this),this.m=2,pi(this)):Ea(this,this.T-c)};function pi(c){c.j.I==0||c.K||mo(c.j,c)}function Mr(c){so(c);var g=c.O;g&&typeof g.dispose=="function"&&g.dispose(),c.O=null,_n(c.V),c.g&&(g=c.g,c.g=null,g.abort(),g.dispose())}function rt(c,g){try{var _=c.j;if(_.I!=0&&(_.g==c||Ia(_.h,c))){if(!c.L&&Ia(_.h,c)&&_.I==3){try{var A=_.Ba.g.parse(g)}catch{A=null}if(Array.isArray(A)&&A.length==3){var B=A;if(B[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<c.F)po(_),Tn(_);else break e;_r(_),pt(18)}}else _.xa=B[1],0<_.xa-_.K&&B[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=hs(y(_.Va,_),6e3));mi(_.h)<=1&&_.ta&&(_.ta=void 0)}else In(_,11)}else if((c.L||_.g==c)&&po(_),!x(g))for(B=_.Ba.g.parse(g),g=0;g<B.length;g++){let Ze=B[g];const Tt=Ze[0];if(!(Tt<=_.K))if(_.K=Tt,Ze=Ze[1],_.I==2)if(Ze[0]=="c"){_.M=Ze[1],_.ba=Ze[2];const Sn=Ze[3];Sn!=null&&(_.ka=Sn,_.j.info("VER="+_.ka));const qr=Ze[4];qr!=null&&(_.za=qr,_.j.info("SVER="+_.za));const vr=Ze[5];vr!=null&&typeof vr=="number"&&vr>0&&(A=1.5*vr,_.O=A,_.j.info("backChannelRequestTimeoutMs_="+A)),A=_;const wr=c.g;if(wr){const _o=wr.g?wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_o){var K=A.h;K.g||_o.indexOf("spdy")==-1&&_o.indexOf("quic")==-1&&_o.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(oo(K,K.h),K.h=null))}if(A.G){const Va=wr.g?wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Va&&(A.wa=Va,Xe(A.J,A.G,Va))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-c.F,_.j.info("Handshake RTT: "+_.T+"ms")),A=_;var ie=c;if(A.na=Oa(A,A.L?A.ba:null,A.W),ie.L){gi(A.h,ie);var je=ie,_t=A.O;_t&&(je.H=_t),je.D&&(so(je),fi(je)),A.g=ie}else Xt(A);_.i.length>0&&zr(_)}else Ze[0]!="stop"&&Ze[0]!="close"||In(_,7);else _.I==3&&(Ze[0]=="stop"||Ze[0]=="close"?Ze[0]=="stop"?In(_,7):ho(_):Ze[0]!="noop"&&_.l&&_.l.qa(Ze),_.A=0)}}Or(4)}catch{}}var Sd=class{constructor(c,g){this.g=c,this.map=g}};function io(c){this.l=c||10,u.PerformanceNavigationTiming?(c=u.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ta(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function mi(c){return c.h?1:c.g?c.g.size:0}function Ia(c,g){return c.h?c.h==g:c.g?c.g.has(g):!1}function oo(c,g){c.g?c.g.add(g):c.h=g}function gi(c,g){c.h&&c.h==g?c.h=null:c.g&&c.g.has(g)&&c.g.delete(g)}io.prototype.cancel=function(){if(this.i=vn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function vn(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let g=c.i;for(const _ of c.g.values())g=g.concat(_.G);return g}return k(c.i)}var ec=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wn(c,g){if(c){c=c.split("&");for(let _=0;_<c.length;_++){const A=c[_].indexOf("=");let B,K=null;A>=0?(B=c[_].substring(0,A),K=c[_].substring(A+1)):B=c[_],g(B,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function cr(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let g;c instanceof cr?(this.l=c.l,yi(this,c.j),this.o=c.o,this.g=c.g,ur(this,c.u),this.h=c.h,gs(this,ka(c.i)),this.m=c.m):c&&(g=String(c).match(ec))?(this.l=!1,yi(this,g[1]||"",!0),this.o=_i(g[2]||""),this.g=_i(g[3]||"",!0),ur(this,g[4]),this.h=_i(g[5]||"",!0),gs(this,g[6]||"",!0),this.m=_i(g[7]||"")):(this.l=!1,this.i=new $e(null,this.l))}cr.prototype.toString=function(){const c=[];var g=this.j;g&&c.push(vi(g,Aa,!0),":");var _=this.g;return(_||g=="file")&&(c.push("//"),(g=this.o)&&c.push(vi(g,Aa,!0),"@"),c.push(lr(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&c.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&c.push("/"),c.push(vi(_,_.charAt(0)=="/"?wi:Ca,!0))),(_=this.i.toString())&&c.push("?",_),(_=this.m)&&c.push("#",vi(_,Ra)),c.join("")},cr.prototype.resolve=function(c){const g=Dn(this);let _=!!c.j;_?yi(g,c.j):_=!!c.o,_?g.o=c.o:_=!!c.g,_?g.g=c.g:_=c.u!=null;var A=c.h;if(_)ur(g,c.u);else if(_=!!c.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var B=g.h.lastIndexOf("/");B!=-1&&(A=g.h.slice(0,B+1)+A)}if(B=A,B==".."||B==".")A="";else if(B.indexOf("./")!=-1||B.indexOf("/.")!=-1){A=B.lastIndexOf("/",0)==0,B=B.split("/");const K=[];for(let ie=0;ie<B.length;){const je=B[ie++];je=="."?A&&ie==B.length&&K.push(""):je==".."?((K.length>1||K.length==1&&K[0]!="")&&K.pop(),A&&ie==B.length&&K.push("")):(K.push(je),A=!0)}A=K.join("/")}else A=B}return _?g.h=A:_=c.i.toString()!=="",_?gs(g,ka(c.i)):_=!!c.m,_&&(g.m=c.m),g};function Dn(c){return new cr(c)}function yi(c,g,_){c.j=_?_i(g,!0):g,c.j&&(c.j=c.j.replace(/:$/,""))}function ur(c,g){if(g){if(g=Number(g),isNaN(g)||g<0)throw Error("Bad port number "+g);c.u=g}else c.u=null}function gs(c,g,_){g instanceof $e?(c.i=g,lo(c.i,c.l)):(_||(g=vi(g,Ad)),c.i=new $e(g,c.l))}function Xe(c,g,_){c.i.set(g,_)}function Lr(c){return Xe(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function _i(c,g){return c?g?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function vi(c,g,_){return typeof c=="string"?(c=encodeURI(c).replace(g,Sa),_&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Sa(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Aa=/[#\/\?@]/g,Ca=/[#\?:]/g,wi=/[#\?]/g,Ad=/[#\?@]/g,Ra=/#/g;function $e(c,g){this.h=this.g=null,this.i=c||null,this.j=!!g}function dr(c){c.g||(c.g=new Map,c.h=0,c.i&&wn(c.i,function(g,_){c.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=$e.prototype,n.add=function(c,g){dr(this),this.i=null,c=hr(this,c);let _=this.g.get(c);return _||this.g.set(c,_=[]),_.push(g),this.h+=1,this};function xa(c,g){dr(c),g=hr(c,g),c.g.has(g)&&(c.i=null,c.h-=c.g.get(g).length,c.g.delete(g))}function ao(c,g){return dr(c),g=hr(c,g),c.g.has(g)}n.forEach=function(c,g){dr(this),this.g.forEach(function(_,A){_.forEach(function(B){c.call(g,B,A,this)},this)},this)};function ba(c,g){dr(c);let _=[];if(typeof g=="string")ao(c,g)&&(_=_.concat(c.g.get(hr(c,g))));else for(c=Array.from(c.g.values()),g=0;g<c.length;g++)_=_.concat(c[g]);return _}n.set=function(c,g){return dr(this),this.i=null,c=hr(this,c),ao(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[g]),this.h+=1,this},n.get=function(c,g){return c?(c=ba(this,c),c.length>0?String(c[0]):g):g};function Pa(c,g,_){xa(c,g),_.length>0&&(c.i=null,c.g.set(hr(c,g),k(_)),c.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],g=Array.from(this.g.keys());for(let A=0;A<g.length;A++){var _=g[A];const B=lr(_);_=ba(this,_);for(let K=0;K<_.length;K++){let ie=B;_[K]!==""&&(ie+="="+lr(_[K])),c.push(ie)}}return this.i=c.join("&")};function ka(c){const g=new $e;return g.i=c.i,c.g&&(g.g=new Map(c.g),g.h=c.h),g}function hr(c,g){return g=String(g),c.j&&(g=g.toLowerCase()),g}function lo(c,g){g&&!c.j&&(dr(c),c.i=null,c.g.forEach(function(_,A){const B=A.toLowerCase();A!=B&&(xa(this,A),Pa(this,B,_))},c)),c.j=g}function fr(c,g){const _=new fs;if(u.Image){const A=new Image;A.onload=w(Lt,_,"TestLoadImage: loaded",!0,g,A),A.onerror=w(Lt,_,"TestLoadImage: error",!1,g,A),A.onabort=w(Lt,_,"TestLoadImage: abort",!1,g,A),A.ontimeout=w(Lt,_,"TestLoadImage: timeout",!1,g,A),u.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=c}else g(!1)}function pr(c,g){const _=new fs,A=new AbortController,B=setTimeout(()=>{A.abort(),Lt(_,"TestPingServer: timeout",!1,g)},1e4);fetch(c,{signal:A.signal}).then(K=>{clearTimeout(B),K.ok?Lt(_,"TestPingServer: ok",!0,g):Lt(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(B),Lt(_,"TestPingServer: error",!1,g)})}function Lt(c,g,_,A,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),A(_)}catch{}}function Ei(){this.g=new di}function Fr(c){this.i=c.Sb||null,this.h=c.ab||!1}T(Fr,cs),Fr.prototype.g=function(){return new En(this.i,this.h)};function En(c,g){ct.call(this),this.H=c,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}T(En,ct),n=En.prototype,n.open=function(c,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=g,this.readyState=1,Gn(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const g={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(g.body=c),(this.H||u).fetch(new Request(this.D,g)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ys(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Gn(this)),this.g&&(this.readyState=3,Gn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;tc(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function tc(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var g=c.value?c.value:new Uint8Array(0);(g=this.B.decode(g,{stream:!c.done}))&&(this.response=this.responseText+=g)}c.done?ys(this):Gn(this),this.readyState==3&&tc(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,ys(this))},n.Na=function(c){this.g&&(this.response=c,ys(this))},n.ga=function(){this.g&&ys(this)};function ys(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Gn(c)}n.setRequestHeader=function(c,g){this.A.append(c,g)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,c.push(_[0]+": "+_[1]),_=g.next();return c.join(`\r
`)};function Gn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(En.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function nc(c){let g="";return ve(c,function(_,A){g+=A,g+=":",g+=_,g+=`\r
`}),g}function co(c,g,_){e:{for(A in _){var A=!1;break e}A=!0}A||(_=nc(_),typeof c=="string"?_!=null&&lr(_):Xe(c,g,_))}function tt(c){ct.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}T(tt,ct);var rc=/^https?$/i,Cd=["POST","PUT"];n=tt.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,g,_,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);g=g?g.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Kl.g(),this.g.onreadystatechange=C(y(this.Ca,this));try{this.B=!0,this.g.open(g,String(c),!0),this.B=!1}catch(K){_s(this,K);return}if(c=_||"",_=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var B in A)_.set(B,A[B]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const K of A.keys())_.set(K,A.get(K));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(_.keys()).find(K=>K.toLowerCase()=="content-type"),B=u.FormData&&c instanceof u.FormData,!(Array.prototype.indexOf.call(Cd,g,void 0)>=0)||A||B||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,ie]of _)this.g.setRequestHeader(K,ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(K){_s(this,K)}};function _s(c,g){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=g,c.o=5,vs(c),Br(c)}function vs(c){c.A||(c.A=!0,ut(c,"complete"),ut(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,ut(this,"complete"),ut(this,"abort"),Br(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Br(this,!0)),tt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ur(this):this.Xa())},n.Xa=function(){Ur(this)};function Ur(c){if(c.h&&typeof l<"u"){if(c.v&&mr(c)==4)setTimeout(c.Ca.bind(c),0);else if(ut(c,"readystatechange"),mr(c)==4){c.h=!1;try{const K=c.ca();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var A;if(A=K===0){let ie=String(c.D).match(ec)[1]||null;!ie&&u.self&&u.self.location&&(ie=u.self.location.protocol.slice(0,-1)),A=!rc.test(ie?ie.toLowerCase():"")}_=A}if(_)ut(c,"complete"),ut(c,"success");else{c.o=6;try{var B=mr(c)>2?c.g.statusText:""}catch{B=""}c.l=B+" ["+c.ca()+"]",vs(c)}}finally{Br(c)}}}}function Br(c,g){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const _=c.g;c.g=null,g||ut(c,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function mr(c){return c.g?c.g.readyState:0}n.ca=function(){try{return mr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(c){if(this.g){var g=this.g.responseText;return c&&g.indexOf(c)==0&&(g=g.substring(c.length)),or(g)}};function sc(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Na(c){const g={};c=(c.g&&mr(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<c.length;A++){if(x(c[A]))continue;var _=ro(c[A]);const B=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const K=g[B]||[];g[B]=K,K.push(_)}ae(g,function(A){return A.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function gr(c,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[c]||g}function uo(c){this.za=0,this.i=[],this.j=new fs,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=gr("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=gr("baseRetryDelayMs",5e3,c),this.Za=gr("retryDelaySeedMs",1e4,c),this.Ta=gr("forwardChannelMaxRetries",2,c),this.va=gr("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new io(c&&c.concurrentRequestLimit),this.Ba=new Ei,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=uo.prototype,n.ka=8,n.I=1,n.connect=function(c,g,_,A){pt(0),this.W=c,this.H=g||{},_&&A!==void 0&&(this.H.OSID=_,this.H.OAID=A),this.F=this.X,this.J=Oa(this,null,this.W),zr(this)};function ho(c){if(fo(c),c.I==3){var g=c.V++,_=Dn(c.J);if(Xe(_,"SID",c.M),Xe(_,"RID",g),Xe(_,"TYPE","terminate"),yr(c,_),g=new Nn(c,c.j,g),g.M=2,g.A=Lr(Dn(_)),_=!1,u.navigator&&u.navigator.sendBeacon)try{_=u.navigator.sendBeacon(g.A.toString(),"")}catch{}!_&&u.Image&&(new Image().src=g.A,_=!0),_||(g.g=oc(g.j,null),g.g.ea(g.A)),g.F=Date.now(),fi(g)}Si(c)}function Tn(c){c.g&&(Ii(c),c.g.cancel(),c.g=null)}function fo(c){Tn(c),c.v&&(u.clearTimeout(c.v),c.v=null),po(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&u.clearTimeout(c.m),c.m=null)}function zr(c){if(!Ta(c.h)&&!c.m){c.m=!0;var g=c.Ea;M||S(),H||(M(),H=!0),I.add(g,c),c.D=0}}function ic(c,g){return mi(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=g.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=hs(y(c.Ea,c,g),go(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const B=new Nn(this,this.j,c);let K=this.o;if(this.U&&(K?(K=D(K),fe(K,this.U)):K=this.U),this.u!==null||this.R||(B.J=K,K=null),this.S)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var A=this.i[_];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(g+=A,g>4096){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=Da(this,B,g),_=Dn(this.J),Xe(_,"RID",c),Xe(_,"CVER",22),this.G&&Xe(_,"X-HTTP-Session-Id",this.G),yr(this,_),K&&(this.R?g="headers="+lr(nc(K))+"&"+g:this.u&&co(_,this.u,K)),oo(this.h,B),this.Ra&&Xe(_,"TYPE","init"),this.S?(Xe(_,"$req",g),Xe(_,"SID","null"),B.U=!0,Hn(B,_,null)):Hn(B,_,g),this.I=2}}else this.I==3&&(c?Ti(this,c):this.i.length==0||Ta(this.h)||Ti(this))};function Ti(c,g){var _;g?_=g.l:_=c.V++;const A=Dn(c.J);Xe(A,"SID",c.M),Xe(A,"RID",_),Xe(A,"AID",c.K),yr(c,A),c.u&&c.o&&co(A,c.u,c.o),_=new Nn(c,c.j,_,c.D+1),c.u===null&&(_.J=c.o),g&&(c.i=g.G.concat(c.i)),g=Da(c,_,1e3),_.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),oo(c.h,_),Hn(_,A,g)}function yr(c,g){c.H&&ve(c.H,function(_,A){Xe(g,A,_)}),c.l&&ve({},function(_,A){Xe(g,A,_)})}function Da(c,g,_){_=Math.min(c.i.length,_);const A=c.l?y(c.l.Ka,c.l,c):null;e:{var B=c.i;let je=-1;for(;;){const _t=["count="+_];je==-1?_>0?(je=B[0].g,_t.push("ofs="+je)):je=0:_t.push("ofs="+je);let Ze=!0;for(let Tt=0;Tt<_;Tt++){var K=B[Tt].g;const Sn=B[Tt].map;if(K-=je,K<0)je=Math.max(0,B[Tt].g-100),Ze=!1;else try{K="req"+K+"_"||"";try{var ie=Sn instanceof Map?Sn:Object.entries(Sn);for(const[qr,vr]of ie){let wr=vr;h(vr)&&(wr=Jt(vr)),_t.push(K+qr+"="+encodeURIComponent(wr))}}catch(qr){throw _t.push(K+"type="+encodeURIComponent("_badmap")),qr}}catch{A&&A(Sn)}}if(Ze){ie=_t.join("&");break e}}ie=void 0}return c=c.i.splice(0,_),g.G=c,ie}function Xt(c){if(!c.g&&!c.v){c.Y=1;var g=c.Da;M||S(),H||(M(),H=!0),I.add(g,c),c.A=0}}function _r(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=hs(y(c.Da,c),go(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,ws(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=hs(y(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,pt(10),Tn(this),ws(this))};function Ii(c){c.B!=null&&(u.clearTimeout(c.B),c.B=null)}function ws(c){c.g=new Nn(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var g=Dn(c.na);Xe(g,"RID","rpc"),Xe(g,"SID",c.M),Xe(g,"AID",c.K),Xe(g,"CI",c.F?"0":"1"),!c.F&&c.ia&&Xe(g,"TO",c.ia),Xe(g,"TYPE","xmlhttp"),yr(c,g),c.u&&c.o&&co(g,c.u,c.o),c.O&&(c.g.H=c.O);var _=c.g;c=c.ba,_.M=1,_.A=Lr(Dn(g)),_.u=null,_.R=!0,wa(_,c)}n.Va=function(){this.C!=null&&(this.C=null,Tn(this),_r(this),pt(19))};function po(c){c.C!=null&&(u.clearTimeout(c.C),c.C=null)}function mo(c,g){var _=null;if(c.g==g){po(c),Ii(c),c.g=null;var A=2}else if(Ia(c.h,g))_=g.G,gi(c.h,g),A=1;else return;if(c.I!=0){if(g.o)if(A==1){_=g.u?g.u.length:0,g=Date.now()-g.F;var B=c.D;A=ds(),ut(A,new _a(A,_)),zr(c)}else Xt(c);else if(B=g.m,B==3||B==0&&g.X>0||!(A==1&&ic(c,g)||A==2&&_r(c)))switch(_&&_.length>0&&(g=c.h,g.i=g.i.concat(_)),B){case 1:In(c,5);break;case 4:In(c,10);break;case 3:In(c,6);break;default:In(c,2)}}}function go(c,g){let _=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(_*=2),_*g}function In(c,g){if(c.j.info("Error code "+g),g==2){var _=y(c.bb,c),A=c.Ua;const B=!A;A=new cr(A||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||yi(A,"https"),Lr(A),B?fr(A.toString(),_):pr(A.toString(),_)}else pt(2);c.I=0,c.l&&c.l.pa(g),Si(c),fo(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function Si(c){if(c.I=0,c.ja=[],c.l){const g=vn(c.h);(g.length!=0||c.i.length!=0)&&($(c.ja,g),$(c.ja,c.i),c.h.i.length=0,k(c.i),c.i.length=0),c.l.oa()}}function Oa(c,g,_){var A=_ instanceof cr?Dn(_):new cr(_);if(A.g!="")g&&(A.g=g+"."+A.g),ur(A,A.u);else{var B=u.location;A=B.protocol,g=g?g+"."+B.hostname:B.hostname,B=+B.port;const K=new cr(null);A&&yi(K,A),g&&(K.g=g),B&&ur(K,B),_&&(K.h=_),A=K}return _=c.G,g=c.wa,_&&g&&Xe(A,_,g),Xe(A,"VER",c.ka),yr(c,A),A}function oc(c,g,_){if(g&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return g=c.Aa&&!c.ma?new tt(new Fr({ab:_})):new tt(c.ma),g.Fa(c.L),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ac(){}n=ac.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function yo(){}yo.prototype.g=function(c,g){return new Ft(c,g)};function Ft(c,g){ct.call(this),this.g=new uo(g),this.l=c,this.h=g&&g.messageUrlParams||null,c=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(c?c["X-WebChannel-Content-Type"]=g.messageContentType:c={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.sa&&(c?c["X-WebChannel-Client-Profile"]=g.sa:c={"X-WebChannel-Client-Profile":g.sa}),this.g.U=c,(c=g&&g.Qb)&&!x(c)&&(this.g.u=c),this.A=g&&g.supportsCrossDomainXhr||!1,this.v=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!x(g)&&(this.g.G=g,c=this.h,c!==null&&g in c&&(c=this.h,g in c&&delete c[g])),this.j=new Es(this)}T(Ft,ct),Ft.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ft.prototype.close=function(){ho(this.g)},Ft.prototype.o=function(c){var g=this.g;if(typeof c=="string"){var _={};_.__data__=c,c=_}else this.v&&(_={},_.__data__=Jt(c),c=_);g.i.push(new Sd(g.Ya++,c)),g.I==3&&zr(g)},Ft.prototype.N=function(){this.g.l=null,delete this.j,ho(this.g),delete this.g,Ft.Z.N.call(this)};function lc(c){eo.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var g=c.__sm__;if(g){e:{for(const _ in g){c=_;break e}c=void 0}(this.i=c)&&(c=this.i,g=g!==null&&c in g?g[c]:void 0),this.data=g}else this.data=c}T(lc,eo);function cc(){ya.call(this),this.status=1}T(cc,ya);function Es(c){this.g=c}T(Es,ac),Es.prototype.ra=function(){ut(this.g,"a")},Es.prototype.qa=function(c){ut(this.g,new lc(c))},Es.prototype.pa=function(c){ut(this.g,new cc)},Es.prototype.oa=function(){ut(this.g,"b")},yo.prototype.createWebChannel=yo.prototype.g,Ft.prototype.send=Ft.prototype.o,Ft.prototype.open=Ft.prototype.m,Ft.prototype.close=Ft.prototype.close,gw=function(){return new yo},mw=function(){return ds()},pw=Wn,Rf={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ps.NO_ERROR=0,ps.TIMEOUT=8,ps.HTTP_ERROR=6,yu=ps,ms.COMPLETE="complete",fw=ms,$l.EventType=us,us.OPEN="a",us.CLOSE="b",us.ERROR="c",us.MESSAGE="d",ct.prototype.listen=ct.prototype.J,al=$l,tt.prototype.listenOnce=tt.prototype.K,tt.prototype.getLastError=tt.prototype.Ha,tt.prototype.getLastErrorCode=tt.prototype.ya,tt.prototype.getStatus=tt.prototype.ca,tt.prototype.getResponseJson=tt.prototype.La,tt.prototype.getResponseText=tt.prototype.la,tt.prototype.send=tt.prototype.ea,tt.prototype.setWithCredentials=tt.prototype.Fa,hw=tt}).apply(typeof su<"u"?su:typeof self<"u"?self:typeof window<"u"?window:{});const r_="@firebase/firestore",s_="4.9.3";class rn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rn.UNAUTHENTICATED=new rn(null),rn.GOOGLE_CREDENTIALS=new rn("google-credentials-uid"),rn.FIRST_PARTY=new rn("first-party-uid"),rn.MOCK_USER=new rn("mock-user");let da="12.7.0";const Qi=new Kf("@firebase/firestore");function Uo(){return Qi.logLevel}function he(n,...e){if(Qi.logLevel<=Be.DEBUG){const t=e.map(ap);Qi.debug(`Firestore (${da}): ${n}`,...t)}}function rs(n,...e){if(Qi.logLevel<=Be.ERROR){const t=e.map(ap);Qi.error(`Firestore (${da}): ${n}`,...t)}}function Zo(n,...e){if(Qi.logLevel<=Be.WARN){const t=e.map(ap);Qi.warn(`Firestore (${da}): ${n}`,...t)}}function ap(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ae(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,yw(n,s,t)}function yw(n,e,t){let s=`FIRESTORE (${da}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw rs(s),new Error(s)}function Ge(n,e,t,s){let o="Unexpected state";typeof t=="string"?o=t:s=t,n||yw(e,o,s)}function Oe(n,e){return n}const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends os{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Rr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class _w{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class cC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(rn.UNAUTHENTICATED)))}shutdown(){}}class uC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class dC{constructor(e){this.t=e,this.currentUser=rn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ge(this.o===void 0,42304);let s=this.i;const o=p=>this.i!==s?(s=this.i,t(p)):Promise.resolve();let l=new Rr;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Rr,e.enqueueRetryable((()=>o(this.currentUser)))};const u=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await o(this.currentUser)}))},h=p=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((p=>h(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?h(p):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Rr)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Ge(typeof s.accessToken=="string",31837,{l:s}),new _w(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ge(e===null||typeof e=="string",2055,{h:e}),new rn(e)}}class hC{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=rn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class fC{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new hC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(rn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class i_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,er(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ge(this.o===void 0,3512);const s=l=>{l.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,he("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const o=l=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new i_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ge(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new i_(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function mC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}class lp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const o=mC(40);for(let l=0;l<o.length;++l)s.length<20&&o[l]<t&&(s+=e.charAt(o[l]%62))}return s}}function ze(n,e){return n<e?-1:n>e?1:0}function xf(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const o=n.charAt(s),l=e.charAt(s);if(o!==l)return af(o)===af(l)?ze(o,l):af(o)?1:-1}return ze(n.length,e.length)}const gC=55296,yC=57343;function af(n){const e=n.charCodeAt(0);return e>=gC&&e<=yC}function ea(n,e,t){return n.length===e.length&&n.every(((s,o)=>t(s,e[o])))}const o_="__name__";class Ar{constructor(e,t,s){t===void 0?t=0:t>e.length&&Ae(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Ae(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Ar.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ar?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let o=0;o<s;o++){const l=Ar.compareSegments(e.get(o),t.get(o));if(l!==0)return l}return ze(e.length,t.length)}static compareSegments(e,t){const s=Ar.isNumericId(e),o=Ar.isNumericId(t);return s&&!o?-1:!s&&o?1:s&&o?Ar.extractNumericId(e).compare(Ar.extractNumericId(t)):xf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Gs.fromString(e.substring(4,e.length-2))}}class et extends Ar{construct(e,t,s){return new et(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new oe(J.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((o=>o.length>0)))}return new et(t)}static emptyPath(){return new et([])}}const _C=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qt extends Ar{construct(e,t,s){return new qt(e,t,s)}static isValidIdentifier(e){return _C.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===o_}static keyField(){return new qt([o_])}static fromServerFormat(e){const t=[];let s="",o=0;const l=()=>{if(s.length===0)throw new oe(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let u=!1;for(;o<e.length;){const h=e[o];if(h==="\\"){if(o+1===e.length)throw new oe(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new oe(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=p,o+=2}else h==="`"?(u=!u,o++):h!=="."||u?(s+=h,o++):(l(),o++)}if(l(),u)throw new oe(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qt(t)}static emptyPath(){return new qt([])}}class Se{constructor(e){this.path=e}static fromPath(e){return new Se(et.fromString(e))}static fromName(e){return new Se(et.fromString(e).popFirst(5))}static empty(){return new Se(et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return et.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new et(e.slice()))}}function vw(n,e,t){if(!t)throw new oe(J.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function vC(n,e,t,s){if(e===!0&&s===!0)throw new oe(J.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function a_(n){if(!Se.isDocumentKey(n))throw new oe(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function l_(n){if(Se.isDocumentKey(n))throw new oe(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ww(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function nd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ae(12329,{type:typeof n})}function Un(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new oe(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=nd(n);throw new oe(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function wC(n,e){if(e<=0)throw new oe(J.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Ct(n,e){const t={typeString:n};return e&&(t.value=e),t}function jl(n,e){if(!ww(n))throw new oe(J.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const o=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const u=n[s];if(o&&typeof u!==o){t=`JSON field '${s}' must be a ${o}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new oe(J.INVALID_ARGUMENT,t);return!0}const c_=-62135596800,u_=1e6;class ot{static now(){return ot.fromMillis(Date.now())}static fromDate(e){return ot.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*u_);return new ot(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new oe(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new oe(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<c_)throw new oe(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/u_}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ot._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(jl(e,ot._jsonSchema))return new ot(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-c_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ot._jsonSchemaVersion="firestore/timestamp/1.0",ot._jsonSchema={type:Ct("string",ot._jsonSchemaVersion),seconds:Ct("number"),nanoseconds:Ct("number")};class be{static fromTimestamp(e){return new be(e)}static min(){return new be(new ot(0,0))}static max(){return new be(new ot(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const El=-1;function EC(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,o=be.fromTimestamp(s===1e9?new ot(t+1,0):new ot(t,s));return new Js(o,Se.empty(),e)}function TC(n){return new Js(n.readTime,n.key,El)}class Js{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Js(be.min(),Se.empty(),El)}static max(){return new Js(be.max(),Se.empty(),El)}}function IC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Se.comparator(n.documentKey,e.documentKey),t!==0?t:ze(n.largestBatchId,e.largestBatchId))}const SC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ha(n){if(n.code!==J.FAILED_PRECONDITION||n.message!==SC)throw n;he("LocalStore","Unexpectedly lost primary lease")}class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Y(((s,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,o)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Y?t:Y.resolve(t)}catch(t){return Y.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.reject(t)}static resolve(e){return new Y(((t,s)=>{t(e)}))}static reject(e){return new Y(((t,s)=>{s(e)}))}static waitFor(e){return new Y(((t,s)=>{let o=0,l=0,u=!1;e.forEach((h=>{++o,h.next((()=>{++l,u&&l===o&&t()}),(p=>s(p)))})),u=!0,l===o&&t()}))}static or(e){let t=Y.resolve(!1);for(const s of e)t=t.next((o=>o?Y.resolve(o):s()));return t}static forEach(e,t){const s=[];return e.forEach(((o,l)=>{s.push(t.call(this,o,l))})),this.waitFor(s)}static mapArray(e,t){return new Y(((s,o)=>{const l=e.length,u=new Array(l);let h=0;for(let p=0;p<l;p++){const y=p;t(e[y]).next((w=>{u[y]=w,++h,h===l&&s(u)}),(w=>o(w)))}}))}static doWhile(e,t){return new Y(((s,o)=>{const l=()=>{e()===!0?t().next((()=>{l()}),o):s()};l()}))}}function CC(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function fa(n){return n.name==="IndexedDbTransactionError"}class rd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}rd.ce=-1;const cp=-1;function Ml(n){return n==null}function Vu(n){return n===0&&1/n==-1/0}function RC(n){return typeof n=="number"&&Number.isInteger(n)&&!Vu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Ew="";function xC(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=d_(e)),e=bC(n.get(t),e);return d_(e)}function bC(n,e){let t=e;const s=n.length;for(let o=0;o<s;o++){const l=n.charAt(o);switch(l){case"\0":t+="";break;case Ew:t+="";break;default:t+=l}}return t}function d_(n){return n+Ew+""}function h_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function oi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Tw(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ft{constructor(e,t){this.comparator=e,this.root=t||zt.EMPTY}insert(e,t){return new ft(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zt.BLACK,null,null))}remove(e){return new ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const o=this.comparator(e,s.key);if(o===0)return t+s.left.size;o<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new iu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new iu(this.root,e,this.comparator,!1)}getReverseIterator(){return new iu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new iu(this.root,e,this.comparator,!0)}}class iu{constructor(e,t,s,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zt{constructor(e,t,s,o,l){this.key=e,this.value=t,this.color=s??zt.RED,this.left=o??zt.EMPTY,this.right=l??zt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,o,l){return new zt(e??this.key,t??this.value,s??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let o=this;const l=s(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,t,s),null):l===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,s)),o.fixUp()}removeMin(){if(this.left.isEmpty())return zt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return zt.EMPTY;s=o.right.min(),o=o.copy(s.key,s.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ae(27949);return e+(this.isRed()?0:1)}}zt.EMPTY=null,zt.RED=!0,zt.BLACK=!1;zt.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae(57766)}get value(){throw Ae(16141)}get color(){throw Ae(16727)}get left(){throw Ae(29726)}get right(){throw Ae(36894)}copy(e,t,s,o,l){return this}insert(e,t,s){return new zt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Pt{constructor(e){this.comparator=e,this.data=new ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const o=s.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new f_(this.data.getIterator())}getIteratorFrom(e){return new f_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Pt)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=s.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Pt(this.comparator);return t.data=e,t}}class f_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Pn{constructor(e){this.fields=e,e.sort(qt.comparator)}static empty(){return new Pn([])}unionWith(e){let t=new Pt(qt.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Pn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ea(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}class Iw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Wt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new Iw("Invalid base64 string: "+l):l}})(e);return new Wt(t)}static fromUint8Array(e){const t=(function(o){let l="";for(let u=0;u<o.length;++u)l+=String.fromCharCode(o[u]);return l})(e);return new Wt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wt.EMPTY_BYTE_STRING=new Wt("");const PC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xs(n){if(Ge(!!n,39018),typeof n=="string"){let e=0;const t=PC.exec(n);if(Ge(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:wt(n.seconds),nanos:wt(n.nanos)}}function wt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ys(n){return typeof n=="string"?Wt.fromBase64String(n):Wt.fromUint8Array(n)}const Sw="server_timestamp",Aw="__type__",Cw="__previous_value__",Rw="__local_write_time__";function up(n){return(n?.mapValue?.fields||{})[Aw]?.stringValue===Sw}function sd(n){const e=n.mapValue.fields[Cw];return up(e)?sd(e):e}function Tl(n){const e=Xs(n.mapValue.fields[Rw].timestampValue);return new ot(e.seconds,e.nanos)}class kC{constructor(e,t,s,o,l,u,h,p,y,w){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=o,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=p,this.useFetchStreams=y,this.isUsingEmulator=w}}const ju="(default)";class Il{constructor(e,t){this.projectId=e,this.database=t||ju}static empty(){return new Il("","")}get isDefaultDatabase(){return this.database===ju}isEqual(e){return e instanceof Il&&e.projectId===this.projectId&&e.database===this.database}}const xw="__type__",NC="__max__",ou={mapValue:{}},bw="__vector__",Mu="value";function Zs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?up(n)?4:OC(n)?9007199254740991:DC(n)?10:11:Ae(28295,{value:n})}function Nr(n,e){if(n===e)return!0;const t=Zs(n);if(t!==Zs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Tl(n).isEqual(Tl(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const u=Xs(o.timestampValue),h=Xs(l.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,l){return Ys(o.bytesValue).isEqual(Ys(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,l){return wt(o.geoPointValue.latitude)===wt(l.geoPointValue.latitude)&&wt(o.geoPointValue.longitude)===wt(l.geoPointValue.longitude)})(n,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return wt(o.integerValue)===wt(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const u=wt(o.doubleValue),h=wt(l.doubleValue);return u===h?Vu(u)===Vu(h):isNaN(u)&&isNaN(h)}return!1})(n,e);case 9:return ea(n.arrayValue.values||[],e.arrayValue.values||[],Nr);case 10:case 11:return(function(o,l){const u=o.mapValue.fields||{},h=l.mapValue.fields||{};if(h_(u)!==h_(h))return!1;for(const p in u)if(u.hasOwnProperty(p)&&(h[p]===void 0||!Nr(u[p],h[p])))return!1;return!0})(n,e);default:return Ae(52216,{left:n})}}function Sl(n,e){return(n.values||[]).find((t=>Nr(t,e)))!==void 0}function ta(n,e){if(n===e)return 0;const t=Zs(n),s=Zs(e);if(t!==s)return ze(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return ze(n.booleanValue,e.booleanValue);case 2:return(function(l,u){const h=wt(l.integerValue||l.doubleValue),p=wt(u.integerValue||u.doubleValue);return h<p?-1:h>p?1:h===p?0:isNaN(h)?isNaN(p)?0:-1:1})(n,e);case 3:return p_(n.timestampValue,e.timestampValue);case 4:return p_(Tl(n),Tl(e));case 5:return xf(n.stringValue,e.stringValue);case 6:return(function(l,u){const h=Ys(l),p=Ys(u);return h.compareTo(p)})(n.bytesValue,e.bytesValue);case 7:return(function(l,u){const h=l.split("/"),p=u.split("/");for(let y=0;y<h.length&&y<p.length;y++){const w=ze(h[y],p[y]);if(w!==0)return w}return ze(h.length,p.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,u){const h=ze(wt(l.latitude),wt(u.latitude));return h!==0?h:ze(wt(l.longitude),wt(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return m_(n.arrayValue,e.arrayValue);case 10:return(function(l,u){const h=l.fields||{},p=u.fields||{},y=h[Mu]?.arrayValue,w=p[Mu]?.arrayValue,T=ze(y?.values?.length||0,w?.values?.length||0);return T!==0?T:m_(y,w)})(n.mapValue,e.mapValue);case 11:return(function(l,u){if(l===ou.mapValue&&u===ou.mapValue)return 0;if(l===ou.mapValue)return 1;if(u===ou.mapValue)return-1;const h=l.fields||{},p=Object.keys(h),y=u.fields||{},w=Object.keys(y);p.sort(),w.sort();for(let T=0;T<p.length&&T<w.length;++T){const C=xf(p[T],w[T]);if(C!==0)return C;const k=ta(h[p[T]],y[w[T]]);if(k!==0)return k}return ze(p.length,w.length)})(n.mapValue,e.mapValue);default:throw Ae(23264,{he:t})}}function p_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ze(n,e);const t=Xs(n),s=Xs(e),o=ze(t.seconds,s.seconds);return o!==0?o:ze(t.nanos,s.nanos)}function m_(n,e){const t=n.values||[],s=e.values||[];for(let o=0;o<t.length&&o<s.length;++o){const l=ta(t[o],s[o]);if(l)return l}return ze(t.length,s.length)}function na(n){return bf(n)}function bf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Xs(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ys(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Se.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",o=!0;for(const l of t.values||[])o?o=!1:s+=",",s+=bf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let o="{",l=!0;for(const u of s)l?l=!1:o+=",",o+=`${u}:${bf(t.fields[u])}`;return o+"}"})(n.mapValue):Ae(61005,{value:n})}function _u(n){switch(Zs(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=sd(n);return e?16+_u(e):16;case 5:return 2*n.stringValue.length;case 6:return Ys(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((o,l)=>o+_u(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let o=0;return oi(s.fields,((l,u)=>{o+=l.length+_u(u)})),o})(n.mapValue);default:throw Ae(13486,{value:n})}}function g_(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Pf(n){return!!n&&"integerValue"in n}function dp(n){return!!n&&"arrayValue"in n}function y_(n){return!!n&&"nullValue"in n}function __(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function vu(n){return!!n&&"mapValue"in n}function DC(n){return(n?.mapValue?.fields||{})[xw]?.stringValue===bw}function hl(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return oi(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=hl(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hl(n.arrayValue.values[t]);return e}return{...n}}function OC(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===NC}class ln{constructor(e){this.value=e}static empty(){return new ln({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!vu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hl(t)}setAll(e){let t=qt.emptyPath(),s={},o=[];e.forEach(((u,h)=>{if(!t.isImmediateParentOf(h)){const p=this.getFieldsMap(t);this.applyChanges(p,s,o),s={},o=[],t=h.popLast()}u?s[h.lastSegment()]=hl(u):o.push(h.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,o)}delete(e){const t=this.field(e.popLast());vu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let o=t.mapValue.fields[e.get(s)];vu(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,s){oi(t,((o,l)=>e[o]=l));for(const o of s)delete e[o]}clone(){return new ln(hl(this.value))}}function Pw(n){const e=[];return oi(n.fields,((t,s)=>{const o=new qt([t]);if(vu(s)){const l=Pw(s.mapValue).fields;if(l.length===0)e.push(o);else for(const u of l)e.push(o.child(u))}else e.push(o)})),new Pn(e)}class Vt{constructor(e,t,s,o,l,u,h){this.key=e,this.documentType=t,this.version=s,this.readTime=o,this.createTime=l,this.data=u,this.documentState=h}static newInvalidDocument(e){return new Vt(e,0,be.min(),be.min(),be.min(),ln.empty(),0)}static newFoundDocument(e,t,s,o){return new Vt(e,1,t,be.min(),s,o,0)}static newNoDocument(e,t){return new Vt(e,2,t,be.min(),be.min(),ln.empty(),0)}static newUnknownDocument(e,t){return new Vt(e,3,t,be.min(),be.min(),ln.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ln.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Lu{constructor(e,t){this.position=e,this.inclusive=t}}function v_(n,e,t){let s=0;for(let o=0;o<n.position.length;o++){const l=e[o],u=n.position[o];if(l.field.isKeyField()?s=Se.comparator(Se.fromName(u.referenceValue),t.key):s=ta(u,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function w_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Nr(n.position[t],e.position[t]))return!1;return!0}class Al{constructor(e,t="asc"){this.field=e,this.dir=t}}function VC(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class kw{}class At extends kw{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new MC(e,t,s):t==="array-contains"?new UC(e,s):t==="in"?new BC(e,s):t==="not-in"?new zC(e,s):t==="array-contains-any"?new qC(e,s):new At(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new LC(e,s):new FC(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ta(t,this.value)):t!==null&&Zs(this.value)===Zs(t)&&this.matchesComparison(ta(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class sr extends kw{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new sr(e,t)}matches(e){return Nw(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Nw(n){return n.op==="and"}function Dw(n){return jC(n)&&Nw(n)}function jC(n){for(const e of n.filters)if(e instanceof sr)return!1;return!0}function kf(n){if(n instanceof At)return n.field.canonicalString()+n.op.toString()+na(n.value);if(Dw(n))return n.filters.map((e=>kf(e))).join(",");{const e=n.filters.map((t=>kf(t))).join(",");return`${n.op}(${e})`}}function Ow(n,e){return n instanceof At?(function(s,o){return o instanceof At&&s.op===o.op&&s.field.isEqual(o.field)&&Nr(s.value,o.value)})(n,e):n instanceof sr?(function(s,o){return o instanceof sr&&s.op===o.op&&s.filters.length===o.filters.length?s.filters.reduce(((l,u,h)=>l&&Ow(u,o.filters[h])),!0):!1})(n,e):void Ae(19439)}function Vw(n){return n instanceof At?(function(t){return`${t.field.canonicalString()} ${t.op} ${na(t.value)}`})(n):n instanceof sr?(function(t){return t.op.toString()+" {"+t.getFilters().map(Vw).join(" ,")+"}"})(n):"Filter"}class MC extends At{constructor(e,t,s){super(e,t,s),this.key=Se.fromName(s.referenceValue)}matches(e){const t=Se.comparator(e.key,this.key);return this.matchesComparison(t)}}class LC extends At{constructor(e,t){super(e,"in",t),this.keys=jw("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class FC extends At{constructor(e,t){super(e,"not-in",t),this.keys=jw("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function jw(n,e){return(e.arrayValue?.values||[]).map((t=>Se.fromName(t.referenceValue)))}class UC extends At{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dp(t)&&Sl(t.arrayValue,this.value)}}class BC extends At{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Sl(this.value.arrayValue,t)}}class zC extends At{constructor(e,t){super(e,"not-in",t)}matches(e){if(Sl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Sl(this.value.arrayValue,t)}}class qC extends At{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Sl(this.value.arrayValue,s)))}}class $C{constructor(e,t=null,s=[],o=[],l=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=o,this.limit=l,this.startAt=u,this.endAt=h,this.Te=null}}function E_(n,e=null,t=[],s=[],o=null,l=null,u=null){return new $C(n,e,t,s,o,l,u)}function hp(n){const e=Oe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>kf(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),Ml(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>na(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>na(s))).join(",")),e.Te=t}return e.Te}function fp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!VC(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Ow(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!w_(n.startAt,e.startAt)&&w_(n.endAt,e.endAt)}function Nf(n){return Se.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class pa{constructor(e,t=null,s=[],o=[],l=null,u="F",h=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=o,this.limit=l,this.limitType=u,this.startAt=h,this.endAt=p,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function WC(n,e,t,s,o,l,u,h){return new pa(n,e,t,s,o,l,u,h)}function id(n){return new pa(n)}function T_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Mw(n){return n.collectionGroup!==null}function fl(n){const e=Oe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new Pt(qt.comparator);return u.filters.forEach((p=>{p.getFlattenedFilters().forEach((y=>{y.isInequality()&&(h=h.add(y.field))}))})),h})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Al(l,s))})),t.has(qt.keyField().canonicalString())||e.Ie.push(new Al(qt.keyField(),s))}return e.Ie}function xr(n){const e=Oe(n);return e.Ee||(e.Ee=HC(e,fl(n))),e.Ee}function HC(n,e){if(n.limitType==="F")return E_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new Al(o.field,l)}));const t=n.endAt?new Lu(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Lu(n.startAt.position,n.startAt.inclusive):null;return E_(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Df(n,e){const t=n.filters.concat([e]);return new pa(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Fu(n,e,t){return new pa(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function od(n,e){return fp(xr(n),xr(e))&&n.limitType===e.limitType}function Lw(n){return`${hp(xr(n))}|lt:${n.limitType}`}function Bo(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((o=>Vw(o))).join(", ")}]`),Ml(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((o=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(o))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((o=>na(o))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((o=>na(o))).join(",")),`Target(${s})`})(xr(n))}; limitType=${n.limitType})`}function ad(n,e){return e.isFoundDocument()&&(function(s,o){const l=o.key.path;return s.collectionGroup!==null?o.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Se.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,o){for(const l of fl(s))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,o){for(const l of s.filters)if(!l.matches(o))return!1;return!0})(n,e)&&(function(s,o){return!(s.startAt&&!(function(u,h,p){const y=v_(u,h,p);return u.inclusive?y<=0:y<0})(s.startAt,fl(s),o)||s.endAt&&!(function(u,h,p){const y=v_(u,h,p);return u.inclusive?y>=0:y>0})(s.endAt,fl(s),o))})(n,e)}function GC(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Fw(n){return(e,t)=>{let s=!1;for(const o of fl(n)){const l=KC(o,e,t);if(l!==0)return l;s=s||o.field.isKeyField()}return 0}}function KC(n,e,t){const s=n.field.isKeyField()?Se.comparator(e.key,t.key):(function(l,u,h){const p=u.data.field(l),y=h.data.field(l);return p!==null&&y!==null?ta(p,y):Ae(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Ae(19790,{direction:n.dir})}}class Yi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[o,l]of s)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),o=this.inner[s];if(o===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return s.length===1?delete this.inner[t]:s.splice(o,1),this.innerSize--,!0;return!1}forEach(e){oi(this.inner,((t,s)=>{for(const[o,l]of s)e(o,l)}))}isEmpty(){return Tw(this.inner)}size(){return this.innerSize}}const QC=new ft(Se.comparator);function ss(){return QC}const Uw=new ft(Se.comparator);function ll(...n){let e=Uw;for(const t of n)e=e.insert(t.key,t);return e}function Bw(n){let e=Uw;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function zi(){return pl()}function zw(){return pl()}function pl(){return new Yi((n=>n.toString()),((n,e)=>n.isEqual(e)))}const JC=new ft(Se.comparator),XC=new Pt(Se.comparator);function qe(...n){let e=XC;for(const t of n)e=e.add(t);return e}const YC=new Pt(ze);function ZC(){return YC}function pp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vu(e)?"-0":e}}function qw(n){return{integerValue:""+n}}function eR(n,e){return RC(e)?qw(e):pp(n,e)}class ld{constructor(){this._=void 0}}function tR(n,e,t){return n instanceof Cl?(function(o,l){const u={fields:{[Aw]:{stringValue:Sw},[Rw]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&up(l)&&(l=sd(l)),l&&(u.fields[Cw]=l),{mapValue:u}})(t,e):n instanceof Rl?Ww(n,e):n instanceof xl?Hw(n,e):(function(o,l){const u=$w(o,l),h=I_(u)+I_(o.Ae);return Pf(u)&&Pf(o.Ae)?qw(h):pp(o.serializer,h)})(n,e)}function nR(n,e,t){return n instanceof Rl?Ww(n,e):n instanceof xl?Hw(n,e):t}function $w(n,e){return n instanceof Uu?(function(s){return Pf(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class Cl extends ld{}class Rl extends ld{constructor(e){super(),this.elements=e}}function Ww(n,e){const t=Gw(e);for(const s of n.elements)t.some((o=>Nr(o,s)))||t.push(s);return{arrayValue:{values:t}}}class xl extends ld{constructor(e){super(),this.elements=e}}function Hw(n,e){let t=Gw(e);for(const s of n.elements)t=t.filter((o=>!Nr(o,s)));return{arrayValue:{values:t}}}class Uu extends ld{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function I_(n){return wt(n.integerValue||n.doubleValue)}function Gw(n){return dp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class rR{constructor(e,t){this.field=e,this.transform=t}}function sR(n,e){return n.field.isEqual(e.field)&&(function(s,o){return s instanceof Rl&&o instanceof Rl||s instanceof xl&&o instanceof xl?ea(s.elements,o.elements,Nr):s instanceof Uu&&o instanceof Uu?Nr(s.Ae,o.Ae):s instanceof Cl&&o instanceof Cl})(n.transform,e.transform)}class iR{constructor(e,t){this.version=e,this.transformResults=t}}class $t{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $t}static exists(e){return new $t(void 0,e)}static updateTime(e){return new $t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class cd{}function Kw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ud(n.key,$t.none()):new Ll(n.key,n.data,$t.none());{const t=n.data,s=ln.empty();let o=new Pt(qt.comparator);for(let l of e.fields)if(!o.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?s.delete(l):s.set(l,u),o=o.add(l)}return new ai(n.key,s,new Pn(o.toArray()),$t.none())}}function oR(n,e,t){n instanceof Ll?(function(o,l,u){const h=o.value.clone(),p=A_(o.fieldTransforms,l,u.transformResults);h.setAll(p),l.convertToFoundDocument(u.version,h).setHasCommittedMutations()})(n,e,t):n instanceof ai?(function(o,l,u){if(!wu(o.precondition,l))return void l.convertToUnknownDocument(u.version);const h=A_(o.fieldTransforms,l,u.transformResults),p=l.data;p.setAll(Qw(o)),p.setAll(h),l.convertToFoundDocument(u.version,p).setHasCommittedMutations()})(n,e,t):(function(o,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function ml(n,e,t,s){return n instanceof Ll?(function(l,u,h,p){if(!wu(l.precondition,u))return h;const y=l.value.clone(),w=C_(l.fieldTransforms,p,u);return y.setAll(w),u.convertToFoundDocument(u.version,y).setHasLocalMutations(),null})(n,e,t,s):n instanceof ai?(function(l,u,h,p){if(!wu(l.precondition,u))return h;const y=C_(l.fieldTransforms,p,u),w=u.data;return w.setAll(Qw(l)),w.setAll(y),u.convertToFoundDocument(u.version,w).setHasLocalMutations(),h===null?null:h.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((T=>T.field)))})(n,e,t,s):(function(l,u,h){return wu(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h})(n,e,t)}function aR(n,e){let t=null;for(const s of n.fieldTransforms){const o=e.data.field(s.field),l=$w(s.transform,o||null);l!=null&&(t===null&&(t=ln.empty()),t.set(s.field,l))}return t||null}function S_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,o){return s===void 0&&o===void 0||!(!s||!o)&&ea(s,o,((l,u)=>sR(l,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ll extends cd{constructor(e,t,s,o=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class ai extends cd{constructor(e,t,s,o,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function Qw(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function A_(n,e,t){const s=new Map;Ge(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let o=0;o<t.length;o++){const l=n[o],u=l.transform,h=e.data.field(l.field);s.set(l.field,nR(u,h,t[o]))}return s}function C_(n,e,t){const s=new Map;for(const o of n){const l=o.transform,u=t.data.field(o.field);s.set(o.field,tR(l,u,e))}return s}class ud extends cd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Jw extends cd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class lR{constructor(e,t,s,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=o}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&oR(l,e,s[o])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=ml(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=ml(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=zw();return this.mutations.forEach((o=>{const l=e.get(o.key),u=l.overlayedDocument;let h=this.applyToLocalView(u,l.mutatedFields);h=t.has(o.key)?null:h;const p=Kw(u,h);p!==null&&s.set(o.key,p),u.isValidDocument()||u.convertToNoDocument(be.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),qe())}isEqual(e){return this.batchId===e.batchId&&ea(this.mutations,e.mutations,((t,s)=>S_(t,s)))&&ea(this.baseMutations,e.baseMutations,((t,s)=>S_(t,s)))}}class mp{constructor(e,t,s,o){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=o}static from(e,t,s){Ge(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let o=(function(){return JC})();const l=e.mutations;for(let u=0;u<l.length;u++)o=o.insert(l[u].key,s[u].version);return new mp(e,t,s,o)}}class cR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class uR{constructor(e,t){this.count=e,this.unchangedNames=t}}var St,He;function Xw(n){switch(n){case J.OK:return Ae(64938);case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0;default:return Ae(15467,{code:n})}}function Yw(n){if(n===void 0)return rs("GRPC error has no .code"),J.UNKNOWN;switch(n){case St.OK:return J.OK;case St.CANCELLED:return J.CANCELLED;case St.UNKNOWN:return J.UNKNOWN;case St.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case St.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case St.INTERNAL:return J.INTERNAL;case St.UNAVAILABLE:return J.UNAVAILABLE;case St.UNAUTHENTICATED:return J.UNAUTHENTICATED;case St.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case St.NOT_FOUND:return J.NOT_FOUND;case St.ALREADY_EXISTS:return J.ALREADY_EXISTS;case St.PERMISSION_DENIED:return J.PERMISSION_DENIED;case St.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case St.ABORTED:return J.ABORTED;case St.OUT_OF_RANGE:return J.OUT_OF_RANGE;case St.UNIMPLEMENTED:return J.UNIMPLEMENTED;case St.DATA_LOSS:return J.DATA_LOSS;default:return Ae(39323,{code:n})}}(He=St||(St={}))[He.OK=0]="OK",He[He.CANCELLED=1]="CANCELLED",He[He.UNKNOWN=2]="UNKNOWN",He[He.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",He[He.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",He[He.NOT_FOUND=5]="NOT_FOUND",He[He.ALREADY_EXISTS=6]="ALREADY_EXISTS",He[He.PERMISSION_DENIED=7]="PERMISSION_DENIED",He[He.UNAUTHENTICATED=16]="UNAUTHENTICATED",He[He.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",He[He.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",He[He.ABORTED=10]="ABORTED",He[He.OUT_OF_RANGE=11]="OUT_OF_RANGE",He[He.UNIMPLEMENTED=12]="UNIMPLEMENTED",He[He.INTERNAL=13]="INTERNAL",He[He.UNAVAILABLE=14]="UNAVAILABLE",He[He.DATA_LOSS=15]="DATA_LOSS";function dR(){return new TextEncoder}const hR=new Gs([4294967295,4294967295],0);function R_(n){const e=dR().encode(n),t=new dw;return t.update(e),new Uint8Array(t.digest())}function x_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Gs([t,s],0),new Gs([o,l],0)]}class gp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new cl(`Invalid padding: ${t}`);if(s<0)throw new cl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new cl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new cl(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Gs.fromNumber(this.ge)}ye(e,t,s){let o=e.add(t.multiply(Gs.fromNumber(s)));return o.compare(hR)===1&&(o=new Gs([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=R_(e),[s,o]=x_(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(s,o,l);if(!this.we(u))return!1}return!0}static create(e,t,s){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new gp(l,o,t);return s.forEach((h=>u.insert(h))),u}insert(e){if(this.ge===0)return;const t=R_(e),[s,o]=x_(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(s,o,l);this.Se(u)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class cl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class dd{constructor(e,t,s,o,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const o=new Map;return o.set(e,Fl.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new dd(be.min(),o,new ft(ze),ss(),qe())}}class Fl{constructor(e,t,s,o,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Fl(s,t,qe(),qe(),qe())}}class Eu{constructor(e,t,s,o){this.be=e,this.removedTargetIds=t,this.key=s,this.De=o}}class Zw{constructor(e,t){this.targetId=e,this.Ce=t}}class e0{constructor(e,t,s=Wt.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=o}}class b_{constructor(){this.ve=0,this.Fe=P_(),this.Me=Wt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=qe(),t=qe(),s=qe();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:s=s.add(o);break;default:Ae(38017,{changeType:l})}})),new Fl(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=P_()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ge(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class fR{constructor(e){this.Ge=e,this.ze=new Map,this.je=ss(),this.Je=au(),this.He=au(),this.Ye=new ft(ze)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Ae(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,s=e.Ce.count,o=this.ot(t);if(o){const l=o.target;if(Nf(l))if(s===0){const u=new Se(l.path);this.et(t,u,Vt.newNoDocument(u,be.min()))}else Ge(s===1,20013,{expectedCount:s});else{const u=this._t(t);if(u!==s){const h=this.ut(e),p=h?this.ct(h,e,u):1;if(p!==0){this.it(t);const y=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:o=0},hashCount:l=0}=t;let u,h;try{u=Ys(s).toUint8Array()}catch(p){if(p instanceof Iw)return Zo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{h=new gp(u,o,l)}catch(p){return Zo(p instanceof cl?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return h.ge===0?null:h}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let o=0;return s.forEach((l=>{const u=this.Ge.ht(),h=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(h)||(this.et(t,l,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const h=this.ot(u);if(h){if(l.current&&Nf(h.target)){const p=new Se(h.target.path);this.It(p).has(u)||this.Et(u,p)||this.et(u,p,Vt.newNoDocument(p,e))}l.Be&&(t.set(u,l.ke()),l.qe())}}));let s=qe();this.He.forEach(((l,u)=>{let h=!0;u.forEachWhile((p=>{const y=this.ot(p);return!y||y.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(s=s.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const o=new dd(e,t,this.Ye,this.je,s);return this.je=ss(),this.Je=au(),this.He=au(),this.Ye=new ft(ze),o}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new b_,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Pt(ze),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Pt(ze),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||he("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new b_),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function au(){return new ft(Se.comparator)}function P_(){return new ft(Se.comparator)}const pR={asc:"ASCENDING",desc:"DESCENDING"},mR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gR={and:"AND",or:"OR"};class yR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Of(n,e){return n.useProto3Json||Ml(e)?e:{value:e}}function Bu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function t0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function _R(n,e){return Bu(n,e.toTimestamp())}function kn(n){return Ge(!!n,49232),be.fromTimestamp((function(t){const s=Xs(t);return new ot(s.seconds,s.nanos)})(n))}function yp(n,e){return Vf(n,e).canonicalString()}function Vf(n,e){const t=(function(o){return new et(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function n0(n){const e=et.fromString(n);return Ge(l0(e),10190,{key:e.toString()}),e}function zu(n,e){return yp(n.databaseId,e.path)}function gl(n,e){const t=n0(e);if(t.get(1)!==n.databaseId.projectId)throw new oe(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new oe(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Se(s0(t))}function r0(n,e){return yp(n.databaseId,e)}function vR(n){const e=n0(n);return e.length===4?et.emptyPath():s0(e)}function jf(n){return new et(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function s0(n){return Ge(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function k_(n,e,t){return{name:zu(n,e),fields:t.value.mapValue.fields}}function wR(n,e){return"found"in e?(function(s,o){Ge(!!o.found,43571),o.found.name,o.found.updateTime;const l=gl(s,o.found.name),u=kn(o.found.updateTime),h=o.found.createTime?kn(o.found.createTime):be.min(),p=new ln({mapValue:{fields:o.found.fields}});return Vt.newFoundDocument(l,u,h,p)})(n,e):"missing"in e?(function(s,o){Ge(!!o.missing,3894),Ge(!!o.readTime,22933);const l=gl(s,o.missing),u=kn(o.readTime);return Vt.newNoDocument(l,u)})(n,e):Ae(7234,{result:e})}function ER(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Ae(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(y,w){return y.useProto3Json?(Ge(w===void 0||typeof w=="string",58123),Wt.fromBase64String(w||"")):(Ge(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),Wt.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&(function(y){const w=y.code===void 0?J.UNKNOWN:Yw(y.code);return new oe(w,y.message||"")})(u);t=new e0(s,o,l,h||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const o=gl(n,s.document.name),l=kn(s.document.updateTime),u=s.document.createTime?kn(s.document.createTime):be.min(),h=new ln({mapValue:{fields:s.document.fields}}),p=Vt.newFoundDocument(o,l,u,h),y=s.targetIds||[],w=s.removedTargetIds||[];t=new Eu(y,w,p.key,p)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const o=gl(n,s.document),l=s.readTime?kn(s.readTime):be.min(),u=Vt.newNoDocument(o,l),h=s.removedTargetIds||[];t=new Eu([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const o=gl(n,s.document),l=s.removedTargetIds||[];t=new Eu([],l,o,null)}else{if(!("filter"in e))return Ae(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:o=0,unchangedNames:l}=s,u=new uR(o,l),h=s.targetId;t=new Zw(h,u)}}return t}function i0(n,e){let t;if(e instanceof Ll)t={update:k_(n,e.key,e.value)};else if(e instanceof ud)t={delete:zu(n,e.key)};else if(e instanceof ai)t={update:k_(n,e.key,e.data),updateMask:PR(e.fieldMask)};else{if(!(e instanceof Jw))return Ae(16599,{Vt:e.type});t={verify:zu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,u){const h=u.transform;if(h instanceof Cl)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Rl)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof xl)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Uu)return{fieldPath:u.field.canonicalString(),increment:h.Ae};throw Ae(20930,{transform:u.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(o,l){return l.updateTime!==void 0?{updateTime:_R(o,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ae(27497)})(n,e.precondition)),t}function TR(n,e){return n&&n.length>0?(Ge(e!==void 0,14353),n.map((t=>(function(o,l){let u=o.updateTime?kn(o.updateTime):kn(l);return u.isEqual(be.min())&&(u=kn(l)),new iR(u,o.transformResults||[])})(t,e)))):[]}function IR(n,e){return{documents:[r0(n,e.path)]}}function SR(n,e){const t={structuredQuery:{}},s=e.path;let o;e.collectionGroup!==null?(o=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=r0(n,o);const l=(function(y){if(y.length!==0)return a0(sr.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(y){if(y.length!==0)return y.map((w=>(function(C){return{field:zo(C.field),direction:RR(C.dir)}})(w)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const h=Of(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:o}}function AR(n){let e=vR(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let o=null;if(s>0){Ge(s===1,65062);const w=t.from[0];w.allDescendants?o=w.collectionId:e=e.child(w.collectionId)}let l=[];t.where&&(l=(function(T){const C=o0(T);return C instanceof sr&&Dw(C)?C.getFilters():[C]})(t.where));let u=[];t.orderBy&&(u=(function(T){return T.map((C=>(function($){return new Al(qo($.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})($.direction))})(C)))})(t.orderBy));let h=null;t.limit&&(h=(function(T){let C;return C=typeof T=="object"?T.value:T,Ml(C)?null:C})(t.limit));let p=null;t.startAt&&(p=(function(T){const C=!!T.before,k=T.values||[];return new Lu(k,C)})(t.startAt));let y=null;return t.endAt&&(y=(function(T){const C=!T.before,k=T.values||[];return new Lu(k,C)})(t.endAt)),WC(e,o,u,l,h,"F",p,y)}function CR(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function o0(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=qo(t.unaryFilter.field);return At.create(s,"==",{doubleValue:NaN});case"IS_NULL":const o=qo(t.unaryFilter.field);return At.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=qo(t.unaryFilter.field);return At.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=qo(t.unaryFilter.field);return At.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ae(61313);default:return Ae(60726)}})(n):n.fieldFilter!==void 0?(function(t){return At.create(qo(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ae(58110);default:return Ae(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return sr.create(t.compositeFilter.filters.map((s=>o0(s))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ae(1026)}})(t.compositeFilter.op))})(n):Ae(30097,{filter:n})}function RR(n){return pR[n]}function xR(n){return mR[n]}function bR(n){return gR[n]}function zo(n){return{fieldPath:n.canonicalString()}}function qo(n){return qt.fromServerFormat(n.fieldPath)}function a0(n){return n instanceof At?(function(t){if(t.op==="=="){if(__(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NAN"}};if(y_(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(__(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NAN"}};if(y_(t.value))return{unaryFilter:{field:zo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zo(t.field),op:xR(t.op),value:t.value}}})(n):n instanceof sr?(function(t){const s=t.getFilters().map((o=>a0(o)));return s.length===1?s[0]:{compositeFilter:{op:bR(t.op),filters:s}}})(n):Ae(54877,{filter:n})}function PR(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function l0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Bs{constructor(e,t,s,o,l=be.min(),u=be.min(),h=Wt.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=p}withSequenceNumber(e){return new Bs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class kR{constructor(e){this.yt=e}}function NR(n){const e=AR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Fu(e,e.limit,"L"):e}class DR{constructor(){this.Cn=new OR}addToCollectionParentIndex(e,t){return this.Cn.add(t),Y.resolve()}getCollectionParents(e,t){return Y.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Y.resolve()}deleteFieldIndex(e,t){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,t){return Y.resolve()}getDocumentsMatchingTarget(e,t){return Y.resolve(null)}getIndexType(e,t){return Y.resolve(0)}getFieldIndexes(e,t){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,t){return Y.resolve(Js.min())}getMinOffsetFromCollectionGroup(e,t){return Y.resolve(Js.min())}updateCollectionGroup(e,t,s){return Y.resolve()}updateIndexEntries(e,t){return Y.resolve()}}class OR{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t]||new Pt(et.comparator),l=!o.has(s);return this.index[t]=o.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t];return o&&o.has(s)}getEntries(e){return(this.index[e]||new Pt(et.comparator)).toArray()}}const N_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},c0=41943040;class gn{static withCacheSize(e){return new gn(e,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}gn.DEFAULT_COLLECTION_PERCENTILE=10,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gn.DEFAULT=new gn(c0,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gn.DISABLED=new gn(-1,0,0);class ra{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ra(0)}static cr(){return new ra(-1)}}const D_="LruGarbageCollector",VR=1048576;function O_([n,e],[t,s]){const o=ze(n,t);return o===0?ze(e,s):o}class jR{constructor(e){this.Ir=e,this.buffer=new Pt(O_),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();O_(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class MR{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){he(D_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){fa(t)?he(D_,"Ignoring IndexedDB error during garbage collection: ",t):await ha(t)}await this.Vr(3e5)}))}}class LR{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return Y.resolve(rd.ce);const s=new jR(t);return this.mr.forEachTarget(e,(o=>s.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>s.Ar(o))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(he("LruGarbageCollector","Garbage collection skipped; disabled"),Y.resolve(N_)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(he("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),N_):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,o,l,u,h,p,y;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((T=>(T>this.params.maximumSequenceNumbersToCollect?(he("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),o=this.params.maximumSequenceNumbersToCollect):o=T,u=Date.now(),this.nthSequenceNumber(e,o)))).next((T=>(s=T,h=Date.now(),this.removeTargets(e,s,t)))).next((T=>(l=T,p=Date.now(),this.removeOrphanedDocuments(e,s)))).next((T=>(y=Date.now(),Uo()<=Be.DEBUG&&he("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-w}ms
	Determined least recently used ${o} in `+(h-u)+`ms
	Removed ${l} targets in `+(p-h)+`ms
	Removed ${T} documents in `+(y-p)+`ms
Total Duration: ${y-w}ms`),Y.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:T}))))}}function FR(n,e){return new LR(n,e)}class UR{constructor(){this.changes=new Yi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?Y.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class BR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class zR{constructor(e,t,s,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=o}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(s=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(s!==null&&ml(s.mutation,o,Pn.empty(),ot.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,qe()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=qe()){const o=zi();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,s).next((l=>{let u=ll();return l.forEach(((h,p)=>{u=u.insert(h,p.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const s=zi();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,qe())))}populateOverlays(e,t,s){const o=[];return s.forEach((l=>{t.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((u,h)=>{t.set(u,h)}))}))}computeViews(e,t,s,o){let l=ss();const u=pl(),h=(function(){return pl()})();return t.forEach(((p,y)=>{const w=s.get(y.key);o.has(y.key)&&(w===void 0||w.mutation instanceof ai)?l=l.insert(y.key,y):w!==void 0?(u.set(y.key,w.mutation.getFieldMask()),ml(w.mutation,y,w.mutation.getFieldMask(),ot.now())):u.set(y.key,Pn.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((y,w)=>u.set(y,w))),t.forEach(((y,w)=>h.set(y,new BR(w,u.get(y)??null)))),h)))}recalculateAndSaveOverlays(e,t){const s=pl();let o=new ft(((u,h)=>u-h)),l=qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const h of u)h.keys().forEach((p=>{const y=t.get(p);if(y===null)return;let w=s.get(p)||Pn.empty();w=h.applyToLocalView(y,w),s.set(p,w);const T=(o.get(h.batchId)||qe()).add(p);o=o.insert(h.batchId,T)}))})).next((()=>{const u=[],h=o.getReverseIterator();for(;h.hasNext();){const p=h.getNext(),y=p.key,w=p.value,T=zw();w.forEach((C=>{if(!l.has(C)){const k=Kw(t.get(C),s.get(C));k!==null&&T.set(C,k),l=l.add(C)}})),u.push(this.documentOverlayCache.saveOverlays(e,y,T))}return Y.waitFor(u)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,o){return(function(u){return Se.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Mw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,o):this.getDocumentsMatchingCollectionQuery(e,t,s,o)}getNextDocuments(e,t,s,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,o).next((l=>{const u=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,o-l.size):Y.resolve(zi());let h=El,p=l;return u.next((y=>Y.forEach(y,((w,T)=>(h<T.largestBatchId&&(h=T.largestBatchId),l.get(w)?Y.resolve():this.remoteDocumentCache.getEntry(e,w).next((C=>{p=p.insert(w,C)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,p,y,qe()))).next((w=>({batchId:h,changes:Bw(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Se(t)).next((s=>{let o=ll();return s.isFoundDocument()&&(o=o.insert(s.key,s)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,o){const l=t.collectionGroup;let u=ll();return this.indexManager.getCollectionParents(e,l).next((h=>Y.forEach(h,(p=>{const y=(function(T,C){return new pa(C,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,s,o).next((w=>{w.forEach(((T,C)=>{u=u.insert(T,C)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,s,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,o)))).next((u=>{l.forEach(((p,y)=>{const w=y.getKey();u.get(w)===null&&(u=u.insert(w,Vt.newInvalidDocument(w)))}));let h=ll();return u.forEach(((p,y)=>{const w=l.get(p);w!==void 0&&ml(w.mutation,y,Pn.empty(),ot.now()),ad(t,y)&&(h=h.insert(p,y))})),h}))}}class qR{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Y.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:kn(o.createTime)}})(t)),Y.resolve()}getNamedQuery(e,t){return Y.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:NR(o.bundledQuery),readTime:kn(o.readTime)}})(t)),Y.resolve()}}class $R{constructor(){this.overlays=new ft(Se.comparator),this.qr=new Map}getOverlay(e,t){return Y.resolve(this.overlays.get(t))}getOverlays(e,t){const s=zi();return Y.forEach(t,(o=>this.getOverlay(e,o).next((l=>{l!==null&&s.set(o,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((o,l)=>{this.St(e,t,l)})),Y.resolve()}removeOverlaysForBatchId(e,t,s){const o=this.qr.get(s);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(s)),Y.resolve()}getOverlaysForCollection(e,t,s){const o=zi(),l=t.length+1,u=new Se(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const p=h.getNext().value,y=p.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&p.largestBatchId>s&&o.set(p.getKey(),p)}return Y.resolve(o)}getOverlaysForCollectionGroup(e,t,s,o){let l=new ft(((y,w)=>y-w));const u=this.overlays.getIterator();for(;u.hasNext();){const y=u.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>s){let w=l.get(y.largestBatchId);w===null&&(w=zi(),l=l.insert(y.largestBatchId,w)),w.set(y.getKey(),y)}}const h=zi(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((y,w)=>h.set(y,w))),!(h.size()>=o)););return Y.resolve(h)}St(e,t,s){const o=this.overlays.get(s.key);if(o!==null){const u=this.qr.get(o.largestBatchId).delete(s.key);this.qr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new cR(t,s));let l=this.qr.get(t);l===void 0&&(l=qe(),this.qr.set(t,l)),this.qr.set(t,l.add(s.key))}}class WR{constructor(){this.sessionToken=Wt.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Y.resolve()}}class _p{constructor(){this.Qr=new Pt(Ot.$r),this.Ur=new Pt(Ot.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new Ot(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new Ot(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new Se(new et([])),s=new Ot(t,e),o=new Ot(t,e+1),l=[];return this.Ur.forEachInRange([s,o],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Se(new et([])),s=new Ot(t,e),o=new Ot(t,e+1);let l=qe();return this.Ur.forEachInRange([s,o],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new Ot(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Ot{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Se.comparator(e.key,t.key)||ze(e.Yr,t.Yr)}static Kr(e,t){return ze(e.Yr,t.Yr)||Se.comparator(e.key,t.key)}}class HR{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Pt(Ot.$r)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,o){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new lR(l,t,s,o);this.mutationQueue.push(u);for(const h of o)this.Zr=this.Zr.add(new Ot(h.key,l)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return Y.resolve(u)}lookupMutationBatch(e,t){return Y.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,o=this.ei(s),l=o<0?0:o;return Y.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?cp:this.tr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Ot(t,0),o=new Ot(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([s,o],(u=>{const h=this.Xr(u.Yr);l.push(h)})),Y.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Pt(ze);return t.forEach((o=>{const l=new Ot(o,0),u=new Ot(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(h=>{s=s.add(h.Yr)}))})),Y.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,o=s.length+1;let l=s;Se.isDocumentKey(l)||(l=l.child(""));const u=new Ot(new Se(l),0);let h=new Pt(ze);return this.Zr.forEachWhile((p=>{const y=p.key.path;return!!s.isPrefixOf(y)&&(y.length===o&&(h=h.add(p.Yr)),!0)}),u),Y.resolve(this.ti(h))}ti(e){const t=[];return e.forEach((s=>{const o=this.Xr(s);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){Ge(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return Y.forEach(t.mutations,(o=>{const l=new Ot(o.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new Ot(t,0),o=this.Zr.firstAfterOrEqual(s);return Y.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class GR{constructor(e){this.ri=e,this.docs=(function(){return new ft(Se.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,o=this.docs.get(s),l=o?o.size:0,u=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return Y.resolve(s?s.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let s=ss();return t.forEach((o=>{const l=this.docs.get(o);s=s.insert(o,l?l.document.mutableCopy():Vt.newInvalidDocument(o))})),Y.resolve(s)}getDocumentsMatchingQuery(e,t,s,o){let l=ss();const u=t.path,h=new Se(u.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(h);for(;p.hasNext();){const{key:y,value:{document:w}}=p.getNext();if(!u.isPrefixOf(y.path))break;y.path.length>u.length+1||IC(TC(w),s)<=0||(o.has(w.key)||ad(t,w))&&(l=l.insert(w.key,w.mutableCopy()))}return Y.resolve(l)}getAllFromCollectionGroup(e,t,s,o){Ae(9500)}ii(e,t){return Y.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new KR(this)}getSize(e){return Y.resolve(this.size)}}class KR extends UR{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(s)})),Y.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class QR{constructor(e){this.persistence=e,this.si=new Yi((t=>hp(t)),fp),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.oi=0,this._i=new _p,this.targetCount=0,this.ai=ra.ur()}forEachTarget(e,t){return this.si.forEach(((s,o)=>t(o))),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),Y.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ra(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Y.resolve()}updateTargetData(e,t){return this.Pr(t),Y.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,t,s){let o=0;const l=[];return this.si.forEach(((u,h)=>{h.sequenceNumber<=t&&s.get(h.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,h.targetId)),o++)})),Y.waitFor(l).next((()=>o))}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return Y.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),Y.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const o=this.persistence.referenceDelegate,l=[];return o&&t.forEach((u=>{l.push(o.markPotentiallyOrphaned(e,u))})),Y.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Y.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return Y.resolve(s)}containsKey(e,t){return Y.resolve(this._i.containsKey(t))}}class u0{constructor(e,t){this.ui={},this.overlays={},this.ci=new rd(0),this.li=!1,this.li=!0,this.hi=new WR,this.referenceDelegate=e(this),this.Pi=new QR(this),this.indexManager=new DR,this.remoteDocumentCache=(function(o){return new GR(o)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new kR(t),this.Ii=new qR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new $R,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new HR(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){he("MemoryPersistence","Starting transaction:",e);const o=new JR(this.ci.next());return this.referenceDelegate.Ei(),s(o).next((l=>this.referenceDelegate.di(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ai(e,t){return Y.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class JR extends AC{constructor(e){super(),this.currentSequenceNumber=e}}class vp{constructor(e){this.persistence=e,this.Ri=new _p,this.Vi=null}static mi(e){return new vp(e)}get fi(){if(this.Vi)return this.Vi;throw Ae(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),Y.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),Y.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Y.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((l=>this.fi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.fi,(s=>{const o=Se.fromPath(s);return this.gi(e,o).next((l=>{l||t.removeEntry(o,be.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Y.or([()=>Y.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class qu{constructor(e,t){this.persistence=e,this.pi=new Yi((s=>xC(s.path)),((s,o)=>s.isEqual(o))),this.garbageCollector=FR(this,t)}static mi(e,t){return new qu(e,t)}Ei(){}di(e){return Y.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((o=>s+o))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return Y.forEach(this.pi,((s,o)=>this.br(e,s,o).next((l=>l?Y.resolve():t(o)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ii(e,(u=>this.br(e,u,t).next((h=>{h||(s++,l.removeEntry(u,be.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Y.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),Y.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),Y.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Y.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_u(e.data.value)),t}br(e,t,s){return Y.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return Y.resolve(o!==void 0&&o>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class wp{constructor(e,t,s,o){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=o}static As(e,t){let s=qe(),o=qe();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new wp(e,t.fromCache,s,o)}}class XR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class YR{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return $I()?8:CC(sn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,o){const l={result:null};return this.ys(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,t,o,s).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new XR;return this.Ss(e,t,u).next((h=>{if(l.result=h,this.Vs)return this.bs(e,t,u,h.size)}))})).next((()=>l.result))}bs(e,t,s,o){return s.documentReadCount<this.fs?(Uo()<=Be.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",Bo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Y.resolve()):(Uo()<=Be.DEBUG&&he("QueryEngine","Query:",Bo(t),"scans",s.documentReadCount,"local documents and returns",o,"documents as results."),s.documentReadCount>this.gs*o?(Uo()<=Be.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",Bo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xr(t))):Y.resolve())}ys(e,t){if(T_(t))return Y.resolve(null);let s=xr(t);return this.indexManager.getIndexType(e,s).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=Fu(t,null,"F"),s=xr(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const u=qe(...l);return this.ps.getDocuments(e,u).next((h=>this.indexManager.getMinOffset(e,s).next((p=>{const y=this.Ds(t,h);return this.Cs(t,y,u,p.readTime)?this.ys(e,Fu(t,null,"F")):this.vs(e,y,t,p)}))))})))))}ws(e,t,s,o){return T_(t)||o.isEqual(be.min())?Y.resolve(null):this.ps.getDocuments(e,s).next((l=>{const u=this.Ds(t,l);return this.Cs(t,u,s,o)?Y.resolve(null):(Uo()<=Be.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Bo(t)),this.vs(e,u,t,EC(o,El)).next((h=>h)))}))}Ds(e,t){let s=new Pt(Fw(e));return t.forEach(((o,l)=>{ad(e,l)&&(s=s.add(l))})),s}Cs(e,t,s,o){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}Ss(e,t,s){return Uo()<=Be.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",Bo(t)),this.ps.getDocumentsMatchingQuery(e,t,Js.min(),s)}vs(e,t,s,o){return this.ps.getDocumentsMatchingQuery(e,s,o).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const Ep="LocalStore",ZR=3e8;class ex{constructor(e,t,s,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new ft(ze),this.xs=new Yi((l=>hp(l)),fp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zR(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function tx(n,e,t,s){return new ex(n,e,t,s)}async function d0(n,e){const t=Oe(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let o;return t.mutationQueue.getAllMutationBatches(s).next((l=>(o=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const u=[],h=[];let p=qe();for(const y of o){u.push(y.batchId);for(const w of y.mutations)p=p.add(w.key)}for(const y of l){h.push(y.batchId);for(const w of y.mutations)p=p.add(w.key)}return t.localDocuments.getDocuments(s,p).next((y=>({Ls:y,removedBatchIds:u,addedBatchIds:h})))}))}))}function nx(n,e){const t=Oe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const o=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,p,y,w){const T=y.batch,C=T.keys();let k=Y.resolve();return C.forEach(($=>{k=k.next((()=>w.getEntry(p,$))).next((j=>{const O=y.docVersions.get($);Ge(O!==null,48541),j.version.compareTo(O)<0&&(T.applyToRemoteDocument(j,y),j.isValidDocument()&&(j.setReadTime(y.commitVersion),w.addEntry(j)))}))})),k.next((()=>h.mutationQueue.removeMutationBatch(p,T)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(h){let p=qe();for(let y=0;y<h.mutationResults.length;++y)h.mutationResults[y].transformResults.length>0&&(p=p.add(h.batch.mutations[y].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(s,o)))}))}function h0(n){const e=Oe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function rx(n,e){const t=Oe(n),s=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const h=[];e.targetChanges.forEach(((w,T)=>{const C=o.get(T);if(!C)return;h.push(t.Pi.removeMatchingKeys(l,w.removedDocuments,T).next((()=>t.Pi.addMatchingKeys(l,w.addedDocuments,T))));let k=C.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(T)!==null?k=k.withResumeToken(Wt.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):w.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(w.resumeToken,s)),o=o.insert(T,k),(function(j,O,Z){return j.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=ZR?!0:Z.addedDocuments.size+Z.modifiedDocuments.size+Z.removedDocuments.size>0})(C,k,w)&&h.push(t.Pi.updateTargetData(l,k))}));let p=ss(),y=qe();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(l,w))})),h.push(sx(l,u,e.documentUpdates).next((w=>{p=w.ks,y=w.qs}))),!s.isEqual(be.min())){const w=t.Pi.getLastRemoteSnapshotVersion(l).next((T=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,s)));h.push(w)}return Y.waitFor(h).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,p,y))).next((()=>p))})).then((l=>(t.Ms=o,l)))}function sx(n,e,t){let s=qe(),o=qe();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let u=ss();return t.forEach(((h,p)=>{const y=l.get(h);p.isFoundDocument()!==y.isFoundDocument()&&(o=o.add(h)),p.isNoDocument()&&p.version.isEqual(be.min())?(e.removeEntry(h,p.readTime),u=u.insert(h,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||p.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(p),u=u.insert(h,p)):he(Ep,"Ignoring outdated watch update for ",h,". Current version:",y.version," Watch version:",p.version)})),{ks:u,qs:o}}))}function ix(n,e){const t=Oe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=cp),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function ox(n,e){const t=Oe(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let o;return t.Pi.getTargetData(s,e).next((l=>l?(o=l,Y.resolve(o)):t.Pi.allocateTargetId(s).next((u=>(o=new Bs(e,u,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,o).next((()=>o)))))))})).then((s=>{const o=t.Ms.get(s.targetId);return(o===null||s.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function Mf(n,e,t){const s=Oe(n),o=s.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(u=>s.persistence.referenceDelegate.removeTarget(u,o)))}catch(u){if(!fa(u))throw u;he(Ep,`Failed to update sequence numbers for target ${e}: ${u}`)}s.Ms=s.Ms.remove(e),s.xs.delete(o.target)}function V_(n,e,t){const s=Oe(n);let o=be.min(),l=qe();return s.persistence.runTransaction("Execute query","readwrite",(u=>(function(p,y,w){const T=Oe(p),C=T.xs.get(w);return C!==void 0?Y.resolve(T.Ms.get(C)):T.Pi.getTargetData(y,w)})(s,u,xr(e)).next((h=>{if(h)return o=h.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(u,h.targetId).next((p=>{l=p}))})).next((()=>s.Fs.getDocumentsMatchingQuery(u,e,t?o:be.min(),t?l:qe()))).next((h=>(ax(s,GC(e),h),{documents:h,Qs:l})))))}function ax(n,e,t){let s=n.Os.get(e)||be.min();t.forEach(((o,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.Os.set(e,s)}class j_{constructor(){this.activeTargetIds=ZC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lx{constructor(){this.Mo=new j_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new j_,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class cx{Oo(e){}shutdown(){}}const M_="ConnectivityMonitor";class L_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){he(M_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){he(M_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let lu=null;function Lf(){return lu===null?lu=(function(){return 268435456+Math.round(2147483648*Math.random())})():lu++,"0x"+lu.toString(16)}const lf="RestConnection",ux={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class dx{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${o}`,this.Wo=this.databaseId.database===ju?`project_id=${s}`:`project_id=${s}&database_id=${o}`}Go(e,t,s,o,l){const u=Lf(),h=this.zo(e,t.toUriEncodedString());he(lf,`Sending RPC '${e}' ${u}:`,h,s);const p={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(p,o,l);const{host:y}=new URL(h),w=la(y);return this.Jo(e,h,p,s,w).then((T=>(he(lf,`Received RPC '${e}' ${u}: `,T),T)),(T=>{throw Zo(lf,`RPC '${e}' ${u} failed with error: `,T,"url: ",h,"request:",s),T}))}Ho(e,t,s,o,l,u){return this.Go(e,t,s,o,l)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+da})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,l)=>e[l]=o)),s&&s.headers.forEach(((o,l)=>e[l]=o))}zo(e,t){const s=ux[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}class hx{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const nn="WebChannelConnection";class fx extends dx{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,o,l){const u=Lf();return new Promise(((h,p)=>{const y=new hw;y.setWithCredentials(!0),y.listenOnce(fw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case yu.NO_ERROR:const T=y.getResponseJson();he(nn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(T)),h(T);break;case yu.TIMEOUT:he(nn,`RPC '${e}' ${u} timed out`),p(new oe(J.DEADLINE_EXCEEDED,"Request time out"));break;case yu.HTTP_ERROR:const C=y.getStatus();if(he(nn,`RPC '${e}' ${u} failed with status:`,C,"response text:",y.getResponseText()),C>0){let k=y.getResponseJson();Array.isArray(k)&&(k=k[0]);const $=k?.error;if($&&$.status&&$.message){const j=(function(Z){const G=Z.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(G)>=0?G:J.UNKNOWN})($.status);p(new oe(j,$.message))}else p(new oe(J.UNKNOWN,"Server responded with status "+y.getStatus()))}else p(new oe(J.UNAVAILABLE,"Connection failed."));break;default:Ae(9055,{l_:e,streamId:u,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{he(nn,`RPC '${e}' ${u} completed.`)}}));const w=JSON.stringify(o);he(nn,`RPC '${e}' ${u} sending request:`,o),y.send(t,"POST",w,s,15)}))}T_(e,t,s){const o=Lf(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=gw(),h=mw(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(p.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(p.useFetchStreams=!0),this.jo(p.initMessageHeaders,t,s),p.encodeInitMessageHeaders=!0;const w=l.join("");he(nn,`Creating RPC '${e}' stream ${o}: ${w}`,p);const T=u.createWebChannel(w,p);this.I_(T);let C=!1,k=!1;const $=new hx({Yo:O=>{k?he(nn,`Not sending because RPC '${e}' stream ${o} is closed:`,O):(C||(he(nn,`Opening RPC '${e}' stream ${o} transport.`),T.open(),C=!0),he(nn,`RPC '${e}' stream ${o} sending:`,O),T.send(O))},Zo:()=>T.close()}),j=(O,Z,G)=>{O.listen(Z,(X=>{try{G(X)}catch(q){setTimeout((()=>{throw q}),0)}}))};return j(T,al.EventType.OPEN,(()=>{k||(he(nn,`RPC '${e}' stream ${o} transport opened.`),$.o_())})),j(T,al.EventType.CLOSE,(()=>{k||(k=!0,he(nn,`RPC '${e}' stream ${o} transport closed`),$.a_(),this.E_(T))})),j(T,al.EventType.ERROR,(O=>{k||(k=!0,Zo(nn,`RPC '${e}' stream ${o} transport errored. Name:`,O.name,"Message:",O.message),$.a_(new oe(J.UNAVAILABLE,"The operation could not be completed")))})),j(T,al.EventType.MESSAGE,(O=>{if(!k){const Z=O.data[0];Ge(!!Z,16349);const G=Z,X=G?.error||G[0]?.error;if(X){he(nn,`RPC '${e}' stream ${o} received error:`,X);const q=X.status;let M=(function(S){const R=St[S];if(R!==void 0)return Yw(R)})(q),H=X.message;M===void 0&&(M=J.INTERNAL,H="Unknown error status: "+q+" with message "+X.message),k=!0,$.a_(new oe(M,H)),T.close()}else he(nn,`RPC '${e}' stream ${o} received:`,Z),$.u_(Z)}})),j(h,pw.STAT_EVENT,(O=>{O.stat===Rf.PROXY?he(nn,`RPC '${e}' stream ${o} detected buffering proxy`):O.stat===Rf.NOPROXY&&he(nn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{$.__()}),0),$}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function cf(){return typeof document<"u"?document:null}function hd(n){return new yR(n,!0)}class Tp{constructor(e,t,s=1e3,o=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=o,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-s);o>0&&he("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const F_="PersistentStream";class f0{constructor(e,t,s,o,l,u,h,p){this.Mi=e,this.S_=s,this.b_=o,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Tp(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===J.RESOURCE_EXHAUSTED?(rs(t.toString()),rs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,o])=>{this.D_===t&&this.G_(s,o)}),(s=>{e((()=>{const o=new oe(J.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(o)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{s((()=>this.z_(o)))})),this.stream.onMessage((o=>{s((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return he(F_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(he(F_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class px extends f0{constructor(e,t,s,o,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,o,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=ER(this.serializer,e),s=(function(l){if(!("targetChange"in l))return be.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?be.min():u.readTime?kn(u.readTime):be.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=jf(this.serializer),t.addTarget=(function(l,u){let h;const p=u.target;if(h=Nf(p)?{documents:IR(l,p)}:{query:SR(l,p).ft},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=t0(l,u.resumeToken);const y=Of(l,u.expectedCount);y!==null&&(h.expectedCount=y)}else if(u.snapshotVersion.compareTo(be.min())>0){h.readTime=Bu(l,u.snapshotVersion.toTimestamp());const y=Of(l,u.expectedCount);y!==null&&(h.expectedCount=y)}return h})(this.serializer,e);const s=CR(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=jf(this.serializer),t.removeTarget=e,this.q_(t)}}class mx extends f0{constructor(e,t,s,o,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,o,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ge(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ge(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ge(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=TR(e.writeResults,e.commitTime),s=kn(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=jf(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>i0(this.serializer,s)))};this.q_(t)}}class gx{}class yx extends gx{constructor(e,t,s,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new oe(J.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,Vf(t,s),o,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new oe(J.UNKNOWN,l.toString())}))}Ho(e,t,s,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Ho(e,Vf(t,s),o,u,h,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new oe(J.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class _x{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(rs(t),this.aa=!1):he("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ji="RemoteStore";class vx{constructor(e,t,s,o,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{s.enqueueAndForget((async()=>{Zi(this)&&(he(Ji,"Restarting streams for network reachability change."),await(async function(p){const y=Oe(p);y.Ea.add(4),await Ul(y),y.Ra.set("Unknown"),y.Ea.delete(4),await fd(y)})(this))}))})),this.Ra=new _x(s,o)}}async function fd(n){if(Zi(n))for(const e of n.da)await e(!0)}async function Ul(n){for(const e of n.da)await e(!1)}function p0(n,e){const t=Oe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Cp(t)?Ap(t):ma(t).O_()&&Sp(t,e))}function Ip(n,e){const t=Oe(n),s=ma(t);t.Ia.delete(e),s.O_()&&m0(t,e),t.Ia.size===0&&(s.O_()?s.L_():Zi(t)&&t.Ra.set("Unknown"))}function Sp(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(be.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ma(n).Y_(e)}function m0(n,e){n.Va.Ue(e),ma(n).Z_(e)}function Ap(n){n.Va=new fR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),ma(n).start(),n.Ra.ua()}function Cp(n){return Zi(n)&&!ma(n).x_()&&n.Ia.size>0}function Zi(n){return Oe(n).Ea.size===0}function g0(n){n.Va=void 0}async function wx(n){n.Ra.set("Online")}async function Ex(n){n.Ia.forEach(((e,t)=>{Sp(n,e)}))}async function Tx(n,e){g0(n),Cp(n)?(n.Ra.ha(e),Ap(n)):n.Ra.set("Unknown")}async function Ix(n,e,t){if(n.Ra.set("Online"),e instanceof e0&&e.state===2&&e.cause)try{await(async function(o,l){const u=l.cause;for(const h of l.targetIds)o.Ia.has(h)&&(await o.remoteSyncer.rejectListen(h,u),o.Ia.delete(h),o.Va.removeTarget(h))})(n,e)}catch(s){he(Ji,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await $u(n,s)}else if(e instanceof Eu?n.Va.Ze(e):e instanceof Zw?n.Va.st(e):n.Va.tt(e),!t.isEqual(be.min()))try{const s=await h0(n.localStore);t.compareTo(s)>=0&&await(function(l,u){const h=l.Va.Tt(u);return h.targetChanges.forEach(((p,y)=>{if(p.resumeToken.approximateByteSize()>0){const w=l.Ia.get(y);w&&l.Ia.set(y,w.withResumeToken(p.resumeToken,u))}})),h.targetMismatches.forEach(((p,y)=>{const w=l.Ia.get(p);if(!w)return;l.Ia.set(p,w.withResumeToken(Wt.EMPTY_BYTE_STRING,w.snapshotVersion)),m0(l,p);const T=new Bs(w.target,p,y,w.sequenceNumber);Sp(l,T)})),l.remoteSyncer.applyRemoteEvent(h)})(n,t)}catch(s){he(Ji,"Failed to raise snapshot:",s),await $u(n,s)}}async function $u(n,e,t){if(!fa(e))throw e;n.Ea.add(1),await Ul(n),n.Ra.set("Offline"),t||(t=()=>h0(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{he(Ji,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await fd(n)}))}function y0(n,e){return e().catch((t=>$u(n,t,e)))}async function pd(n){const e=Oe(n),t=ei(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cp;for(;Sx(e);)try{const o=await ix(e.localStore,s);if(o===null){e.Ta.length===0&&t.L_();break}s=o.batchId,Ax(e,o)}catch(o){await $u(e,o)}_0(e)&&v0(e)}function Sx(n){return Zi(n)&&n.Ta.length<10}function Ax(n,e){n.Ta.push(e);const t=ei(n);t.O_()&&t.X_&&t.ea(e.mutations)}function _0(n){return Zi(n)&&!ei(n).x_()&&n.Ta.length>0}function v0(n){ei(n).start()}async function Cx(n){ei(n).ra()}async function Rx(n){const e=ei(n);for(const t of n.Ta)e.ea(t.mutations)}async function xx(n,e,t){const s=n.Ta.shift(),o=mp.from(s,e,t);await y0(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await pd(n)}async function bx(n,e){e&&ei(n).X_&&await(async function(s,o){if((function(u){return Xw(u)&&u!==J.ABORTED})(o.code)){const l=s.Ta.shift();ei(s).B_(),await y0(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,o))),await pd(s)}})(n,e),_0(n)&&v0(n)}async function U_(n,e){const t=Oe(n);t.asyncQueue.verifyOperationInProgress(),he(Ji,"RemoteStore received new credentials");const s=Zi(t);t.Ea.add(3),await Ul(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await fd(t)}async function Px(n,e){const t=Oe(n);e?(t.Ea.delete(2),await fd(t)):e||(t.Ea.add(2),await Ul(t),t.Ra.set("Unknown"))}function ma(n){return n.ma||(n.ma=(function(t,s,o){const l=Oe(t);return l.sa(),new px(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:wx.bind(null,n),t_:Ex.bind(null,n),r_:Tx.bind(null,n),H_:Ix.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Cp(n)?Ap(n):n.Ra.set("Unknown")):(await n.ma.stop(),g0(n))}))),n.ma}function ei(n){return n.fa||(n.fa=(function(t,s,o){const l=Oe(t);return l.sa(),new mx(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Cx.bind(null,n),r_:bx.bind(null,n),ta:Rx.bind(null,n),na:xx.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await pd(n)):(await n.fa.stop(),n.Ta.length>0&&(he(Ji,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Rp{constructor(e,t,s,o,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=o,this.removalCallback=l,this.deferred=new Rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,o,l){const u=Date.now()+s,h=new Rp(e,t,u,o,l);return h.start(s),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xp(n,e){if(rs("AsyncQueue",`${e}: ${n}`),fa(n))return new oe(J.UNAVAILABLE,`${e}: ${n}`);throw n}class Jo{static emptySet(e){return new Jo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Se.comparator(t.key,s.key):(t,s)=>Se.comparator(t.key,s.key),this.keyedMap=ll(),this.sortedSet=new ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Jo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=s.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Jo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class B_{constructor(){this.ga=new ft(Se.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ae(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class sa{constructor(e,t,s,o,l,u,h,p,y){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=o,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=p,this.hasCachedResults=y}static fromInitialDocuments(e,t,s,o,l){const u=[];return t.forEach((h=>{u.push({type:0,doc:h})})),new sa(e,t,Jo.emptySet(t),u,s,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&od(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==s[o].type||!t[o].doc.isEqual(s[o].doc))return!1;return!0}}class kx{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Nx{constructor(){this.queries=z_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const o=Oe(t),l=o.queries;o.queries=z_(),l.forEach(((u,h)=>{for(const p of h.Sa)p.onError(s)}))})(this,new oe(J.ABORTED,"Firestore shutting down"))}}function z_(){return new Yi((n=>Lw(n)),od)}async function bp(n,e){const t=Oe(n);let s=3;const o=e.query;let l=t.queries.get(o);l?!l.ba()&&e.Da()&&(s=2):(l=new kx,s=e.Da()?0:1);try{switch(s){case 0:l.wa=await t.onListen(o,!0);break;case 1:l.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const h=xp(u,`Initialization of query '${Bo(e.query)}' failed`);return void e.onError(h)}t.queries.set(o,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&kp(t)}async function Pp(n,e){const t=Oe(n),s=e.query;let o=3;const l=t.queries.get(s);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?o=e.Da()?0:1:!l.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function Dx(n,e){const t=Oe(n);let s=!1;for(const o of e){const l=o.query,u=t.queries.get(l);if(u){for(const h of u.Sa)h.Fa(o)&&(s=!0);u.wa=o}}s&&kp(t)}function Ox(n,e,t){const s=Oe(n),o=s.queries.get(e);if(o)for(const l of o.Sa)l.onError(t);s.queries.delete(e)}function kp(n){n.Ca.forEach((e=>{e.next()}))}var Ff,q_;(q_=Ff||(Ff={})).Ma="default",q_.Cache="cache";class Np{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const o of e.docChanges)o.type!==3&&s.push(o);e=new sa(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=sa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ff.Cache}}class w0{constructor(e){this.key=e}}class E0{constructor(e){this.key=e}}class Vx{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=qe(),this.mutatedKeys=qe(),this.eu=Fw(e),this.tu=new Jo(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new B_,o=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=o,h=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,y=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((w,T)=>{const C=o.get(w),k=ad(this.query,T)?T:null,$=!!C&&this.mutatedKeys.has(C.key),j=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let O=!1;C&&k?C.data.isEqual(k.data)?$!==j&&(s.track({type:3,doc:k}),O=!0):this.su(C,k)||(s.track({type:2,doc:k}),O=!0,(p&&this.eu(k,p)>0||y&&this.eu(k,y)<0)&&(h=!0)):!C&&k?(s.track({type:0,doc:k}),O=!0):C&&!k&&(s.track({type:1,doc:C}),O=!0,(p||y)&&(h=!0)),O&&(k?(u=u.add(k),l=j?l.add(w):l.delete(w)):(u=u.delete(w),l=l.delete(w)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const w=this.query.limitType==="F"?u.last():u.first();u=u.delete(w.key),l=l.delete(w.key),s.track({type:1,doc:w})}return{tu:u,iu:s,Cs:h,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((w,T)=>(function(k,$){const j=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae(20277,{Rt:O})}};return j(k)-j($)})(w.type,T.type)||this.eu(w.doc,T.doc))),this.ou(s),o=o??!1;const h=t&&!o?this._u():[],p=this.Xa.size===0&&this.current&&!o?1:0,y=p!==this.Za;return this.Za=p,u.length!==0||y?{snapshot:new sa(this.query,e.tu,l,u,e.mutatedKeys,p===0,y,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new B_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=qe(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new E0(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new w0(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=qe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return sa.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Dp="SyncEngine";class jx{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class Mx{constructor(e){this.key=e,this.hu=!1}}class Lx{constructor(e,t,s,o,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Yi((h=>Lw(h)),od),this.Iu=new Map,this.Eu=new Set,this.du=new ft(Se.comparator),this.Au=new Map,this.Ru=new _p,this.Vu={},this.mu=new Map,this.fu=ra.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Fx(n,e,t=!0){const s=R0(n);let o;const l=s.Tu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await T0(s,e,t,!0),o}async function Ux(n,e){const t=R0(n);await T0(t,e,!0,!1)}async function T0(n,e,t,s){const o=await ox(n.localStore,xr(e)),l=o.targetId,u=n.sharedClientState.addLocalQueryTarget(l,t);let h;return s&&(h=await Bx(n,e,l,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&p0(n.remoteStore,o),h}async function Bx(n,e,t,s,o){n.pu=(T,C,k)=>(async function(j,O,Z,G){let X=O.view.ru(Z);X.Cs&&(X=await V_(j.localStore,O.query,!1).then((({documents:I})=>O.view.ru(I,X))));const q=G&&G.targetChanges.get(O.targetId),M=G&&G.targetMismatches.get(O.targetId)!=null,H=O.view.applyChanges(X,j.isPrimaryClient,q,M);return W_(j,O.targetId,H.au),H.snapshot})(n,T,C,k);const l=await V_(n.localStore,e,!0),u=new Vx(e,l.Qs),h=u.ru(l.documents),p=Fl.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",o),y=u.applyChanges(h,n.isPrimaryClient,p);W_(n,t,y.au);const w=new jx(e,t,u);return n.Tu.set(e,w),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function zx(n,e,t){const s=Oe(n),o=s.Tu.get(e),l=s.Iu.get(o.targetId);if(l.length>1)return s.Iu.set(o.targetId,l.filter((u=>!od(u,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(o.targetId),s.sharedClientState.isActiveQueryTarget(o.targetId)||await Mf(s.localStore,o.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(o.targetId),t&&Ip(s.remoteStore,o.targetId),Uf(s,o.targetId)})).catch(ha)):(Uf(s,o.targetId),await Mf(s.localStore,o.targetId,!0))}async function qx(n,e){const t=Oe(n),s=t.Tu.get(e),o=t.Iu.get(s.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Ip(t.remoteStore,s.targetId))}async function $x(n,e,t){const s=Xx(n);try{const o=await(function(u,h){const p=Oe(u),y=ot.now(),w=h.reduce(((k,$)=>k.add($.key)),qe());let T,C;return p.persistence.runTransaction("Locally write mutations","readwrite",(k=>{let $=ss(),j=qe();return p.Ns.getEntries(k,w).next((O=>{$=O,$.forEach(((Z,G)=>{G.isValidDocument()||(j=j.add(Z))}))})).next((()=>p.localDocuments.getOverlayedDocuments(k,$))).next((O=>{T=O;const Z=[];for(const G of h){const X=aR(G,T.get(G.key).overlayedDocument);X!=null&&Z.push(new ai(G.key,X,Pw(X.value.mapValue),$t.exists(!0)))}return p.mutationQueue.addMutationBatch(k,y,Z,h)})).next((O=>{C=O;const Z=O.applyToLocalDocumentSet(T,j);return p.documentOverlayCache.saveOverlays(k,O.batchId,Z)}))})).then((()=>({batchId:C.batchId,changes:Bw(T)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(o.batchId),(function(u,h,p){let y=u.Vu[u.currentUser.toKey()];y||(y=new ft(ze)),y=y.insert(h,p),u.Vu[u.currentUser.toKey()]=y})(s,o.batchId,t),await Bl(s,o.changes),await pd(s.remoteStore)}catch(o){const l=xp(o,"Failed to persist write");t.reject(l)}}async function I0(n,e){const t=Oe(n);try{const s=await rx(t.localStore,e);e.targetChanges.forEach(((o,l)=>{const u=t.Au.get(l);u&&(Ge(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.hu=!0:o.modifiedDocuments.size>0?Ge(u.hu,14607):o.removedDocuments.size>0&&(Ge(u.hu,42227),u.hu=!1))})),await Bl(t,s,e)}catch(s){await ha(s)}}function $_(n,e,t){const s=Oe(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const o=[];s.Tu.forEach(((l,u)=>{const h=u.view.va(e);h.snapshot&&o.push(h.snapshot)})),(function(u,h){const p=Oe(u);p.onlineState=h;let y=!1;p.queries.forEach(((w,T)=>{for(const C of T.Sa)C.va(h)&&(y=!0)})),y&&kp(p)})(s.eventManager,e),o.length&&s.Pu.H_(o),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function Wx(n,e,t){const s=Oe(n);s.sharedClientState.updateQueryState(e,"rejected",t);const o=s.Au.get(e),l=o&&o.key;if(l){let u=new ft(Se.comparator);u=u.insert(l,Vt.newNoDocument(l,be.min()));const h=qe().add(l),p=new dd(be.min(),new Map,new ft(ze),u,h);await I0(s,p),s.du=s.du.remove(l),s.Au.delete(e),Op(s)}else await Mf(s.localStore,e,!1).then((()=>Uf(s,e,t))).catch(ha)}async function Hx(n,e){const t=Oe(n),s=e.batch.batchId;try{const o=await nx(t.localStore,e);A0(t,s,null),S0(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Bl(t,o)}catch(o){await ha(o)}}async function Gx(n,e,t){const s=Oe(n);try{const o=await(function(u,h){const p=Oe(u);return p.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let w;return p.mutationQueue.lookupMutationBatch(y,h).next((T=>(Ge(T!==null,37113),w=T.keys(),p.mutationQueue.removeMutationBatch(y,T)))).next((()=>p.mutationQueue.performConsistencyCheck(y))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(y,w,h))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,w))).next((()=>p.localDocuments.getDocuments(y,w)))}))})(s.localStore,e);A0(s,e,t),S0(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Bl(s,o)}catch(o){await ha(o)}}function S0(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function A0(n,e,t){const s=Oe(n);let o=s.Vu[s.currentUser.toKey()];if(o){const l=o.get(e);l&&(t?l.reject(t):l.resolve(),o=o.remove(e)),s.Vu[s.currentUser.toKey()]=o}}function Uf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||C0(n,s)}))}function C0(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Ip(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Op(n))}function W_(n,e,t){for(const s of t)s instanceof w0?(n.Ru.addReference(s.key,e),Kx(n,s)):s instanceof E0?(he(Dp,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||C0(n,s.key)):Ae(19791,{wu:s})}function Kx(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(he(Dp,"New document in limbo: "+t),n.Eu.add(s),Op(n))}function Op(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Se(et.fromString(e)),s=n.fu.next();n.Au.set(s,new Mx(t)),n.du=n.du.insert(t,s),p0(n.remoteStore,new Bs(xr(id(t.path)),s,"TargetPurposeLimboResolution",rd.ce))}}async function Bl(n,e,t){const s=Oe(n),o=[],l=[],u=[];s.Tu.isEmpty()||(s.Tu.forEach(((h,p)=>{u.push(s.pu(p,e,t).then((y=>{if((y||t)&&s.isPrimaryClient){const w=y?!y.fromCache:t?.targetChanges.get(p.targetId)?.current;s.sharedClientState.updateQueryState(p.targetId,w?"current":"not-current")}if(y){o.push(y);const w=wp.As(p.targetId,y);l.push(w)}})))})),await Promise.all(u),s.Pu.H_(o),await(async function(p,y){const w=Oe(p);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(T=>Y.forEach(y,(C=>Y.forEach(C.Es,(k=>w.persistence.referenceDelegate.addReference(T,C.targetId,k))).next((()=>Y.forEach(C.ds,(k=>w.persistence.referenceDelegate.removeReference(T,C.targetId,k)))))))))}catch(T){if(!fa(T))throw T;he(Ep,"Failed to update sequence numbers: "+T)}for(const T of y){const C=T.targetId;if(!T.fromCache){const k=w.Ms.get(C),$=k.snapshotVersion,j=k.withLastLimboFreeSnapshotVersion($);w.Ms=w.Ms.insert(C,j)}}})(s.localStore,l))}async function Qx(n,e){const t=Oe(n);if(!t.currentUser.isEqual(e)){he(Dp,"User change. New user:",e.toKey());const s=await d0(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((h=>{h.forEach((p=>{p.reject(new oe(J.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Bl(t,s.Ls)}}function Jx(n,e){const t=Oe(n),s=t.Au.get(e);if(s&&s.hu)return qe().add(s.key);{let o=qe();const l=t.Iu.get(e);if(!l)return o;for(const u of l){const h=t.Tu.get(u);o=o.unionWith(h.view.nu)}return o}}function R0(n){const e=Oe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=I0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Jx.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Wx.bind(null,e),e.Pu.H_=Dx.bind(null,e.eventManager),e.Pu.yu=Ox.bind(null,e.eventManager),e}function Xx(n){const e=Oe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Hx.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Gx.bind(null,e),e}class Wu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return tx(this.persistence,new YR,e.initialUser,this.serializer)}Cu(e){return new u0(vp.mi,this.serializer)}Du(e){return new lx}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Wu.provider={build:()=>new Wu};class Yx extends Wu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ge(this.persistence.referenceDelegate instanceof qu,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new MR(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new u0((s=>qu.mi(s,t)),this.serializer)}}class Bf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>$_(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=Qx.bind(null,this.syncEngine),await Px(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Nx})()}createDatastore(e){const t=hd(e.databaseInfo.databaseId),s=(function(l){return new fx(l)})(e.databaseInfo);return(function(l,u,h,p){return new yx(l,u,h,p)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,o,l,u,h){return new vx(s,o,l,u,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>$_(this.syncEngine,t,0)),(function(){return L_.v()?new L_:new cx})())}createSyncEngine(e,t){return(function(o,l,u,h,p,y,w){const T=new Lx(o,l,u,h,p,y);return w&&(T.gu=!0),T})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=Oe(t);he(Ji,"RemoteStore shutting down."),s.Ea.add(5),await Ul(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Bf.provider={build:()=>new Bf};class Vp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):rs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class Zx{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new oe(J.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(o,l){const u=Oe(o),h={documents:l.map((T=>zu(u.serializer,T)))},p=await u.Ho("BatchGetDocuments",u.serializer.databaseId,et.emptyPath(),h,l.length),y=new Map;p.forEach((T=>{const C=wR(u.serializer,T);y.set(C.key.toString(),C)}));const w=[];return l.forEach((T=>{const C=y.get(T.toString());Ge(!!C,55234,{key:T}),w.push(C)})),w})(this.datastore,e);return t.forEach((s=>this.recordVersion(s))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new ud(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,s)=>{const o=Se.fromPath(s);this.mutations.push(new Jw(o,this.precondition(o)))})),await(async function(s,o){const l=Oe(s),u={writes:o.map((h=>i0(l.serializer,h)))};await l.Go("Commit",l.serializer.databaseId,et.emptyPath(),u)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ae(50498,{Gu:e.constructor.name});t=be.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new oe(J.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(be.min())?$t.exists(!1):$t.updateTime(t):$t.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(be.min()))throw new oe(J.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $t.updateTime(t)}return $t.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class eb{constructor(e,t,s,o,l){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=o,this.deferred=l,this.zu=s.maxAttempts,this.M_=new Tp(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new Zx(this.datastore),t=this.Hu(e);t&&t.then((s=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(s)})).catch((o=>{this.Yu(o)}))))})).catch((s=>{this.Yu(s)}))}))}Hu(e){try{const t=this.updateFunction(e);return!Ml(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Xw(t)}return!1}}const ti="FirestoreClient";class tb{constructor(e,t,s,o,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=o,this.user=rn.UNAUTHENTICATED,this.clientId=lp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async u=>{he(ti,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(s,(u=>(he(ti,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=xp(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function uf(n,e){n.asyncQueue.verifyOperationInProgress(),he(ti,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async o=>{s.isEqual(o)||(await d0(e.localStore,o),s=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function H_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await nb(n);he(ti,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>U_(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,o)=>U_(e.remoteStore,o))),n._onlineComponents=e}async function nb(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){he(ti,"Using user provided OfflineComponentProvider");try{await uf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===J.FAILED_PRECONDITION||o.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Zo("Error using user provided cache. Falling back to memory cache: "+t),await uf(n,new Wu)}}else he(ti,"Using default OfflineComponentProvider"),await uf(n,new Yx(void 0));return n._offlineComponents}async function jp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(he(ti,"Using user provided OnlineComponentProvider"),await H_(n,n._uninitializedComponentsProvider._online)):(he(ti,"Using default OnlineComponentProvider"),await H_(n,new Bf))),n._onlineComponents}function rb(n){return jp(n).then((e=>e.syncEngine))}function sb(n){return jp(n).then((e=>e.datastore))}async function Hu(n){const e=await jp(n),t=e.eventManager;return t.onListen=Fx.bind(null,e.syncEngine),t.onUnlisten=zx.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Ux.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=qx.bind(null,e.syncEngine),t}function ib(n,e,t={}){const s=new Rr;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,h,p,y){const w=new Vp({next:C=>{w.Nu(),u.enqueueAndForget((()=>Pp(l,T)));const k=C.docs.has(h);!k&&C.fromCache?y.reject(new oe(J.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&C.fromCache&&p&&p.source==="server"?y.reject(new oe(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(C)},error:C=>y.reject(C)}),T=new Np(id(h.path),w,{includeMetadataChanges:!0,qa:!0});return bp(l,T)})(await Hu(n),n.asyncQueue,e,t,s))),s.promise}function ob(n,e,t={}){const s=new Rr;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,h,p,y){const w=new Vp({next:C=>{w.Nu(),u.enqueueAndForget((()=>Pp(l,T))),C.fromCache&&p.source==="server"?y.reject(new oe(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(C)},error:C=>y.reject(C)}),T=new Np(h,w,{includeMetadataChanges:!0,qa:!0});return bp(l,T)})(await Hu(n),n.asyncQueue,e,t,s))),s.promise}function x0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const G_=new Map;const b0="firestore.googleapis.com",K_=!0;class Q_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new oe(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=b0,this.ssl=K_}else this.host=e.host,this.ssl=e.ssl??K_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=c0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<VR)throw new oe(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=x0(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new oe(J.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new oe(J.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new oe(J.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,o){return s.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class md{constructor(e,t,s,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Q_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Q_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new cC;switch(s.type){case"firstParty":return new fC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new oe(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=G_.get(t);s&&(he("ComponentProvider","Removing Datastore"),G_.delete(t),s.terminate())})(this),Promise.resolve()}}function ab(n,e,t,s={}){n=Un(n,md);const o=la(e),l=n._getSettings(),u={...l,emulatorOptions:n._getEmulatorOptions()},h=`${e}:${t}`;o&&(Rv(`https://${h}`),xv("Firestore",!0)),l.host!==b0&&l.host!==h&&Zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p={...l,host:h,ssl:o,emulatorOptions:s};if(!Hi(p,u)&&(n._setSettings(p),s.mockUserToken)){let y,w;if(typeof s.mockUserToken=="string")y=s.mockUserToken,w=rn.MOCK_USER;else{y=VI(s.mockUserToken,n._app?.options.projectId);const T=s.mockUserToken.sub||s.mockUserToken.user_id;if(!T)throw new oe(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new rn(T)}n._authCredentials=new uC(new _w(y,w))}}class as{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new as(this.firestore,e,this._query)}}class yt{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ks(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yt(this.firestore,e,this._key)}toJSON(){return{type:yt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(jl(t,yt._jsonSchema))return new yt(e,s||null,new Se(et.fromString(t.referencePath)))}}yt._jsonSchemaVersion="firestore/documentReference/1.0",yt._jsonSchema={type:Ct("string",yt._jsonSchemaVersion),referencePath:Ct("string")};class Ks extends as{constructor(e,t,s){super(e,t,id(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yt(this.firestore,null,new Se(e))}withConverter(e){return new Ks(this.firestore,e,this._path)}}function gt(n,e,...t){if(n=Rt(n),vw("collection","path",e),n instanceof md){const s=et.fromString(e,...t);return l_(s),new Ks(n,null,s)}{if(!(n instanceof yt||n instanceof Ks))throw new oe(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(et.fromString(e,...t));return l_(s),new Ks(n.firestore,null,s)}}function Me(n,e,...t){if(n=Rt(n),arguments.length===1&&(e=lp.newId()),vw("doc","path",e),n instanceof md){const s=et.fromString(e,...t);return a_(s),new yt(n,null,new Se(s))}{if(!(n instanceof yt||n instanceof Ks))throw new oe(J.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(et.fromString(e,...t));return a_(s),new yt(n.firestore,n instanceof Ks?n.converter:null,new Se(s))}}const J_="AsyncQueue";class X_{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Tp(this,"async_queue_retry"),this._c=()=>{const s=cf();s&&he(J_,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=cf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=cf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Rr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!fa(e))throw e;he(J_,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,rs("INTERNAL UNHANDLED ERROR: ",Y_(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=Rp.createAndSchedule(this,e,t,s,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&Ae(47125,{Pc:Y_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Y_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Z_(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const o=t;for(const l of s)if(l in o&&typeof o[l]=="function")return!0;return!1})(n,["next","error","complete"])}class ni extends md{constructor(e,t,s,o){super(e,t,s,o),this.type="firestore",this._queue=new X_,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new X_(e),this._firestoreClient=void 0,await e}}}function lb(n,e){const t=typeof n=="object"?n:Nv(),s=typeof n=="string"?n:ju,o=Jf(t,"firestore").getImmediate({identifier:s});if(!o._initialized){const l=DI("firestore");l&&ab(o,...l)}return o}function ga(n){if(n._terminated)throw new oe(J.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||cb(n),n._firestoreClient}function cb(n){const e=n._freezeSettings(),t=(function(o,l,u,h){return new kC(o,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,x0(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new tb(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(o){const l=o?._online.build();return{_offline:o?._offline.build(l),_online:l}})(n._componentsProvider))}class bn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new bn(Wt.fromBase64String(e))}catch(t){throw new oe(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new bn(Wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:bn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(jl(e,bn._jsonSchema))return bn.fromBase64String(e.bytes)}}bn._jsonSchemaVersion="firestore/bytes/1.0",bn._jsonSchema={type:Ct("string",bn._jsonSchemaVersion),bytes:Ct("string")};class zl{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new oe(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class gd{constructor(e){this._methodName=e}}class br{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new oe(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new oe(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:br._jsonSchemaVersion}}static fromJSON(e){if(jl(e,br._jsonSchema))return new br(e.latitude,e.longitude)}}br._jsonSchemaVersion="firestore/geoPoint/1.0",br._jsonSchema={type:Ct("string",br._jsonSchemaVersion),latitude:Ct("number"),longitude:Ct("number")};class Pr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,o){if(s.length!==o.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Pr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(jl(e,Pr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Pr(e.vectorValues);throw new oe(J.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Pr._jsonSchemaVersion="firestore/vectorValue/1.0",Pr._jsonSchema={type:Ct("string",Pr._jsonSchemaVersion),vectorValues:Ct("object")};const ub=/^__.*__$/;class db{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ai(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ll(e,this.data,t,this.fieldTransforms)}}class P0{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new ai(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function k0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ae(40011,{Ac:n})}}class Mp{constructor(e,t,s,o,l,u){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=o,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Mp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Gu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(k0(this.Ac)&&ub.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hb{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||hd(e)}Cc(e,t,s,o=!1){return new Mp({Ac:e,methodName:t,Dc:s,path:qt.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yd(n){const e=n._freezeSettings(),t=hd(n._databaseId);return new hb(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Lp(n,e,t,s,o,l={}){const u=n.Cc(l.merge||l.mergeFields?2:0,e,t,o);Up("Data must be an object, but it was:",u,s);const h=O0(s,u);let p,y;if(l.merge)p=new Pn(u.fieldMask),y=u.fieldTransforms;else if(l.mergeFields){const w=[];for(const T of l.mergeFields){const C=zf(e,T,t);if(!u.contains(C))throw new oe(J.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);j0(w,C)||w.push(C)}p=new Pn(w),y=u.fieldTransforms.filter((T=>p.covers(T.field)))}else p=null,y=u.fieldTransforms;return new db(new ln(h),p,y)}class _d extends gd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _d}}class Fp extends gd{_toFieldTransform(e){return new rR(e.path,new Cl)}isEqual(e){return e instanceof Fp}}function N0(n,e,t,s){const o=n.Cc(1,e,t);Up("Data must be an object, but it was:",o,s);const l=[],u=ln.empty();oi(s,((p,y)=>{const w=Bp(e,p,t);y=Rt(y);const T=o.yc(w);if(y instanceof _d)l.push(w);else{const C=ql(y,T);C!=null&&(l.push(w),u.set(w,C))}}));const h=new Pn(l);return new P0(u,h,o.fieldTransforms)}function D0(n,e,t,s,o,l){const u=n.Cc(1,e,t),h=[zf(e,s,t)],p=[o];if(l.length%2!=0)throw new oe(J.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<l.length;C+=2)h.push(zf(e,l[C])),p.push(l[C+1]);const y=[],w=ln.empty();for(let C=h.length-1;C>=0;--C)if(!j0(y,h[C])){const k=h[C];let $=p[C];$=Rt($);const j=u.yc(k);if($ instanceof _d)y.push(k);else{const O=ql($,j);O!=null&&(y.push(k),w.set(k,O))}}const T=new Pn(y);return new P0(w,T,u.fieldTransforms)}function fb(n,e,t,s=!1){return ql(t,n.Cc(s?4:3,e))}function ql(n,e){if(V0(n=Rt(n)))return Up("Unsupported field value:",e,n),O0(n,e);if(n instanceof gd)return(function(s,o){if(!k0(o.Ac))throw o.Sc(`${s._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(o);l&&o.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,o){const l=[];let u=0;for(const h of s){let p=ql(h,o.wc(u));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),u++}return{arrayValue:{values:l}}})(n,e)}return(function(s,o){if((s=Rt(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return eR(o.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=ot.fromDate(s);return{timestampValue:Bu(o.serializer,l)}}if(s instanceof ot){const l=new ot(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Bu(o.serializer,l)}}if(s instanceof br)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof bn)return{bytesValue:t0(o.serializer,s._byteString)};if(s instanceof yt){const l=o.databaseId,u=s.firestore._databaseId;if(!u.isEqual(l))throw o.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:yp(s.firestore._databaseId||o.databaseId,s._key.path)}}if(s instanceof Pr)return(function(u,h){return{mapValue:{fields:{[xw]:{stringValue:bw},[Mu]:{arrayValue:{values:u.toArray().map((y=>{if(typeof y!="number")throw h.Sc("VectorValues must only contain numeric values.");return pp(h.serializer,y)}))}}}}}})(s,o);throw o.Sc(`Unsupported field value: ${nd(s)}`)})(n,e)}function O0(n,e){const t={};return Tw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):oi(n,((s,o)=>{const l=ql(o,e.mc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function V0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ot||n instanceof br||n instanceof bn||n instanceof yt||n instanceof gd||n instanceof Pr)}function Up(n,e,t){if(!V0(t)||!ww(t)){const s=nd(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function zf(n,e,t){if((e=Rt(e))instanceof zl)return e._internalPath;if(typeof e=="string")return Bp(n,e);throw Gu("Field path arguments must be of type string or ",n,!1,void 0,t)}const pb=new RegExp("[~\\*/\\[\\]]");function Bp(n,e,t){if(e.search(pb)>=0)throw Gu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new zl(...e.split("."))._internalPath}catch{throw Gu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gu(n,e,t,s,o){const l=s&&!s.isEmpty(),u=o!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let p="";return(l||u)&&(p+=" (found",l&&(p+=` in field ${s}`),u&&(p+=` in document ${o}`),p+=")"),new oe(J.INVALID_ARGUMENT,h+n+p)}function j0(n,e){return n.some((t=>t.isEqual(e)))}class Ku{constructor(e,t,s,o,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new mb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(vd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class mb extends Ku{data(){return super.data()}}function vd(n,e){return typeof e=="string"?Bp(n,e):e instanceof zl?e._internalPath:e._delegate._internalPath}function M0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new oe(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zp{}class qp extends zp{}function Bn(n,e,...t){let s=[];e instanceof zp&&s.push(e),s=s.concat(t),(function(l){const u=l.filter((p=>p instanceof $p)).length,h=l.filter((p=>p instanceof wd)).length;if(u>1||u>0&&h>0)throw new oe(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const o of s)n=o._apply(n);return n}class wd extends qp{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new wd(e,t,s)}_apply(e){const t=this._parse(e);return L0(e._query,t),new as(e.firestore,e.converter,Df(e._query,t))}_parse(e){const t=yd(e.firestore);return(function(l,u,h,p,y,w,T){let C;if(y.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new oe(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){tv(T,w);const $=[];for(const j of T)$.push(ev(p,l,j));C={arrayValue:{values:$}}}else C=ev(p,l,T)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||tv(T,w),C=fb(h,u,T,w==="in"||w==="not-in");return At.create(y,w,C)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function rr(n,e,t){const s=e,o=vd("where",n);return wd._create(o,s,t)}class $p extends zp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new $p(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:sr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,l){let u=o;const h=l.getFlattenedFilters();for(const p of h)L0(u,p),u=Df(u,p)})(e._query,t),new as(e.firestore,e.converter,Df(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Wp extends qp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Wp(e,t)}_apply(e){const t=(function(o,l,u){if(o.startAt!==null)throw new oe(J.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new oe(J.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Al(l,u)})(e._query,this._field,this._direction);return new as(e.firestore,e.converter,(function(o,l){const u=o.explicitOrderBy.concat([l]);return new pa(o.path,o.collectionGroup,u,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)})(e._query,t))}}function gb(n,e="asc"){const t=e,s=vd("orderBy",n);return Wp._create(s,t)}class Hp extends qp{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new Hp(e,t,s)}_apply(e){return new as(e.firestore,e.converter,Fu(e._query,this._limit,this._limitType))}}function Gp(n){return wC("limit",n),Hp._create("limit",n,"F")}function ev(n,e,t){if(typeof(t=Rt(t))=="string"){if(t==="")throw new oe(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mw(e)&&t.indexOf("/")!==-1)throw new oe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(et.fromString(t));if(!Se.isDocumentKey(s))throw new oe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return g_(n,new Se(s))}if(t instanceof yt)return g_(n,t._key);throw new oe(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${nd(t)}.`)}function tv(n,e){if(!Array.isArray(n)||n.length===0)throw new oe(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function L0(n,e){const t=(function(o,l){for(const u of o)for(const h of u.getFlattenedFilters())if(l.indexOf(h.op)>=0)return h.op;return null})(n.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new oe(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class F0{convertValue(e,t="none"){switch(Zs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ys(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return oi(e,((o,l)=>{s[o]=this.convertValue(l,t)})),s}convertVectorValue(e){const t=e.fields?.[Mu].arrayValue?.values?.map((s=>wt(s.doubleValue)));return new Pr(t)}convertGeoPoint(e){return new br(wt(e.latitude),wt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=sd(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Tl(e));default:return null}}convertTimestamp(e){const t=Xs(e);return new ot(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=et.fromString(e);Ge(l0(s),9688,{name:e});const o=new Il(s.get(1),s.get(3)),l=new Se(s.popFirst(5));return o.isEqual(t)||rs(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}function Kp(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class yb extends F0{constructor(e){super(),this.firestore=e}convertBytes(e){return new bn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yt(this.firestore,null,t)}}class $o{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qs extends Ku{constructor(e,t,s,o,l,u){super(e,t,s,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Tu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(vd("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(J.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Qs._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Qs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qs._jsonSchema={type:Ct("string",Qs._jsonSchemaVersion),bundleSource:Ct("string","DocumentSnapshot"),bundleName:Ct("string"),bundle:Ct("string")};class Tu extends Qs{data(e={}){return super.data(e)}}class Wi{constructor(e,t,s,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new $o(o.hasPendingWrites,o.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Tu(this._firestore,this._userDataWriter,s.key,s,new $o(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new oe(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map((h=>{const p=new Tu(o._firestore,o._userDataWriter,h.doc.key,h.doc,new $o(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter);return h.doc,{type:"added",doc:p,oldIndex:-1,newIndex:u++}}))}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((h=>l||h.type!==3)).map((h=>{const p=new Tu(o._firestore,o._userDataWriter,h.doc.key,h.doc,new $o(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter);let y=-1,w=-1;return h.type!==0&&(y=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),w=u.indexOf(h.doc.key)),{type:_b(h.type),doc:p,oldIndex:y,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(J.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Wi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=lp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function _b(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae(61501,{type:n})}}function Dr(n){n=Un(n,yt);const e=Un(n.firestore,ni);return ib(ga(e),n._key).then((t=>B0(e,n,t)))}Wi._jsonSchemaVersion="firestore/querySnapshot/1.0",Wi._jsonSchema={type:Ct("string",Wi._jsonSchemaVersion),bundleSource:Ct("string","QuerySnapshot"),bundleName:Ct("string"),bundle:Ct("string")};class Ed extends F0{constructor(e){super(),this.firestore=e}convertBytes(e){return new bn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yt(this.firestore,null,t)}}function jt(n){n=Un(n,as);const e=Un(n.firestore,ni),t=ga(e),s=new Ed(e);return M0(n._query),ob(t,n._query).then((o=>new Wi(e,s,n,o)))}function ls(n,e,t){n=Un(n,yt);const s=Un(n.firestore,ni),o=Kp(n.converter,e,t);return U0(s,[Lp(yd(s),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,$t.none())])}function vb(n,...e){n=Rt(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Z_(e[s])||(t=e[s++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Z_(e[s])){const p=e[s];e[s]=p.next?.bind(p),e[s+1]=p.error?.bind(p),e[s+2]=p.complete?.bind(p)}let l,u,h;if(n instanceof yt)u=Un(n.firestore,ni),h=id(n._key.path),l={next:p=>{e[s]&&e[s](B0(u,n,p))},error:e[s+1],complete:e[s+2]};else{const p=Un(n,as);u=Un(p.firestore,ni),h=p._query;const y=new Ed(u);l={next:w=>{e[s]&&e[s](new Wi(u,y,p,w))},error:e[s+1],complete:e[s+2]},M0(n._query)}return(function(y,w,T,C){const k=new Vp(C),$=new Np(w,k,T);return y.asyncQueue.enqueueAndForget((async()=>bp(await Hu(y),$))),()=>{k.Nu(),y.asyncQueue.enqueueAndForget((async()=>Pp(await Hu(y),$)))}})(ga(u),h,o,l)}function U0(n,e){return(function(s,o){const l=new Rr;return s.asyncQueue.enqueueAndForget((async()=>$x(await rb(s),o,l))),l.promise})(ga(n),e)}function B0(n,e,t){const s=t.docs.get(e._key),o=new Ed(n);return new Qs(n,o,e._key,s,new $o(t.hasPendingWrites,t.fromCache),e.converter)}const wb={maxAttempts:5};class Eb{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=yd(e)}set(e,t,s){this._verifyNotCommitted();const o=zs(e,this._firestore),l=Kp(o.converter,t,s),u=Lp(this._dataReader,"WriteBatch.set",o._key,l,o.converter!==null,s);return this._mutations.push(u.toMutation(o._key,$t.none())),this}update(e,t,s,...o){this._verifyNotCommitted();const l=zs(e,this._firestore);let u;return u=typeof(t=Rt(t))=="string"||t instanceof zl?D0(this._dataReader,"WriteBatch.update",l._key,t,s,o):N0(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(u.toMutation(l._key,$t.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=zs(e,this._firestore);return this._mutations=this._mutations.concat(new ud(t._key,$t.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new oe(J.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zs(n,e){if((n=Rt(n)).firestore!==e)throw new oe(J.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class Tb{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=yd(e)}get(e){const t=zs(e,this._firestore),s=new yb(this._firestore);return this._transaction.lookup([t._key]).then((o=>{if(!o||o.length!==1)return Ae(24041);const l=o[0];if(l.isFoundDocument())return new Ku(this._firestore,s,l.key,l,t.converter);if(l.isNoDocument())return new Ku(this._firestore,s,t._key,null,t.converter);throw Ae(18433,{doc:l})}))}set(e,t,s){const o=zs(e,this._firestore),l=Kp(o.converter,t,s),u=Lp(this._dataReader,"Transaction.set",o._key,l,o.converter!==null,s);return this._transaction.set(o._key,u),this}update(e,t,s,...o){const l=zs(e,this._firestore);let u;return u=typeof(t=Rt(t))=="string"||t instanceof zl?D0(this._dataReader,"Transaction.update",l._key,t,s,o):N0(this._dataReader,"Transaction.update",l._key,t),this._transaction.update(l._key,u),this}delete(e){const t=zs(e,this._firestore);return this._transaction.delete(t._key),this}}class Ib extends Tb{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=zs(e,this._firestore),s=new Ed(this._firestore);return super.get(e).then((o=>new Qs(this._firestore,s,t._key,o._document,new $o(!1,!1),t.converter)))}}function li(n,e,t){n=Un(n,ni);const s={...wb,...t};return(function(l){if(l.maxAttempts<1)throw new oe(J.INVALID_ARGUMENT,"Max attempts must be at least 1")})(s),(function(l,u,h){const p=new Rr;return l.asyncQueue.enqueueAndForget((async()=>{const y=await sb(l);new eb(l.asyncQueue,y,h,u,p).ju()})),p.promise})(ga(n),(o=>e(new Ib(n,o))),s)}function Ye(){return new Fp("serverTimestamp")}function Qp(n){return ga(n=Un(n,ni)),new Eb(n,(e=>U0(n,e)))}(function(e,t=!0){(function(o){da=o})(ca),Xo(new Gi("firestore",((s,{instanceIdentifier:o,options:l})=>{const u=s.getProvider("app").getImmediate(),h=new ni(new dC(s.getProvider("auth-internal")),new pC(u,s.getProvider("app-check-internal")),(function(y,w){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new oe(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Il(y.options.projectId,w)})(u,o),u);return l={useFetchStreams:t,...l},h._setSettings(l),h}),"PUBLIC").setMultipleInstances(!0)),Hs(r_,s_,e),Hs(r_,s_,"esm2020")})();var Sb="firebase",Ab="12.7.0";Hs(Sb,Ab,"app");const Cb={apiKey:"AIzaSyA-TURVnsMyyBOWreei2jGLcuXmOzyr_DQ",authDomain:"gamificationcollege.firebaseapp.com",projectId:"gamificationcollege",storageBucket:"gamificationcollege.firebasestorage.app",messagingSenderId:"237003198772",appId:"1:237003198772:web:37fc8130a083377a115561"},z0=kv(Cb),df=aC(z0),Rb=new Yr,le=lb(z0),q0=de.createContext(null);function xb({children:n}){const[e,t]=de.useState(null),[s,o]=de.useState(null),[l,u]=de.useState(!0);de.useEffect(()=>{const y=QA(df,async w=>{if(t(w),o(null),!w){u(!1);return}const T=Me(le,"users",w.uid);(await Dr(T)).exists()||await ls(T,{displayName:w.displayName||"Utilisateur",role:"child",createdAt:Ye()});const k=await Dr(T);o(k.data()?.role||"child"),u(!1)});return()=>y()},[]);const h=async()=>{await g1(df,Rb)},p=async()=>{await JA(df)};return v.jsx(q0.Provider,{value:{user:e,role:s,loading:l,signInGoogle:h,signOutUser:p},children:n})}function zn(){const n=de.useContext(q0);if(!n)throw new Error("useAuth doit tre utilis sous <AuthProvider>");return n}const Fo={xp:0,level:1,badges:[],masteryByTag:{},collectibles:{owned:[],equippedAvatarId:null},malocraft:{ownedLootIds:[],equippedAvatarId:null,biomeMilestones:{}}};function ci(n){const[e,t]=de.useState(Fo),[s,o]=de.useState(!!n);return de.useEffect(()=>{if(!n){t(Fo),o(!1);return}const l=Me(le,"users",n,"meta","rewards"),u=vb(l,h=>{if(h.exists()){const p=h.data();t({...Fo,...p,collectibles:p.collectibles||Fo.collectibles,malocraft:p.malocraft||Fo.malocraft})}else t(Fo);o(!1)},()=>o(!1));return()=>u()},[n]),{rewards:e,loading:s}}const ri=[{id:"sticker_star",type:"sticker",title:"toile",description:"Une toile brillante",rarity:"common",icon:""},{id:"sticker_book",type:"sticker",title:"Livre",description:"Pour les champions de lecture",rarity:"common",icon:""},{id:"sticker_rocket",type:"sticker",title:"Fuse",description:"Dcollage vers la russite",rarity:"common",icon:""},{id:"sticker_pencil",type:"sticker",title:"Crayon",description:"Toujours prt  crire",rarity:"common",icon:""},{id:"sticker_thumbs",type:"sticker",title:"Bravo",description:"Pouce en lair",rarity:"common",icon:""},{id:"sticker_smile",type:"sticker",title:"Sourire",description:"Bonne humeur garantie",rarity:"common",icon:""},{id:"sticker_music",type:"sticker",title:"Musique",description:"Rythme et rvisions",rarity:"common",icon:""},{id:"sticker_leaf",type:"sticker",title:"Feuille",description:"Nature et calme",rarity:"common",icon:""},{id:"sticker_dragon",type:"sticker",title:"Dragon",description:"Gardien des savoirs",rarity:"rare",icon:""},{id:"sticker_moon",type:"sticker",title:"Lune",description:"Veille dtude",rarity:"rare",icon:""},{id:"sticker_robot",type:"sticker",title:"Robot",description:"Logique au top",rarity:"rare",icon:""},{id:"sticker_trophy",type:"sticker",title:"Trophe",description:"Petite victoire",rarity:"rare",icon:""},{id:"sticker_paint",type:"sticker",title:"Palette",description:"Crativit",rarity:"rare",icon:""},{id:"sticker_comet",type:"sticker",title:"Comte",description:"Vise toile",rarity:"rare",icon:""},{id:"sticker_camera",type:"sticker",title:"Camra",description:"Souvenir de russite",rarity:"rare",icon:""},{id:"sticker_ship",type:"sticker",title:"Navire",description:"Cap sur le savoir",rarity:"rare",icon:""},{id:"sticker_crown",type:"sticker",title:"Couronne",description:"Roi/Reine des rvisions",rarity:"epic",icon:""},{id:"sticker_phoenix",type:"sticker",title:"Phnix",description:"Toujours se relever",rarity:"epic",icon:""},{id:"sticker_unicorn",type:"sticker",title:"Licorne",description:"Magie de la russite",rarity:"epic",icon:""},{id:"sticker_saturn",type:"sticker",title:"Saturne",description:"Orbitant autour du savoir",rarity:"epic",icon:""},{id:"sticker_mountain",type:"sticker",title:"Montagne",description:"Sommet atteint",rarity:"epic",icon:""},{id:"sticker_aurora",type:"sticker",title:"Aurore",description:"Lumire des ides",rarity:"epic",icon:""},{id:"sticker_magic",type:"sticker",title:"Magicien",description:"Tour de matrise",rarity:"epic",icon:""},{id:"sticker_dragon_gold",type:"sticker",title:"Dragon dor",description:"Gloire ultime",rarity:"epic",icon:""},{id:"avatar_basic_boy",type:"avatar",title:"Aventurier",description:"Prt  apprendre",rarity:"common",icon:""},{id:"avatar_basic_girl",type:"avatar",title:"Exploratrice",description:"Curieuse et motive",rarity:"common",icon:""},{id:"avatar_scientist",type:"avatar",title:"Scientifique",description:"Fan dexpriences",rarity:"rare",icon:""},{id:"avatar_astronaut",type:"avatar",title:"Astronaute",description:"Toujours plus haut",rarity:"rare",icon:""},{id:"avatar_artist",type:"avatar",title:"Artiste",description:"Crativit au max",rarity:"common",icon:""},{id:"avatar_knight",type:"avatar",title:"Chevalier",description:"Protge ses progrs",rarity:"rare",icon:""},{id:"avatar_ninja",type:"avatar",title:"Ninja",description:"Rapide et prcis",rarity:"epic",icon:""},{id:"avatar_robot",type:"avatar",title:"Robot",description:"Logique imparable",rarity:"rare",icon:""},{id:"avatar_dragon_tamer",type:"avatar",title:"Dompte-dragon",description:"Matrise totale",rarity:"epic",icon:""},{id:"avatar_pirate",type:"avatar",title:"Pirate",description:"Cap sur les objectifs",rarity:"common",icon:""},{id:"avatar_superhero",type:"avatar",title:"Hros",description:"Sauveur des devoirs",rarity:"epic",icon:""},{id:"avatar_bard",type:"avatar",title:"Barde",description:"Chante ses progrs",rarity:"rare",icon:""}];function bb(){const{user:n,role:e,signOutUser:t}=zn(),{rewards:s}=ci(n?.uid||null),o=s?.collectibles?.equippedAvatarId,l=o?ri.find(u=>u.id===o):null;return v.jsx("div",{className:"card",style:{marginBottom:14},children:v.jsxs("div",{className:"row",style:{justifyContent:"space-between"},children:[v.jsxs("div",{children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[v.jsx("div",{style:{fontWeight:900,fontSize:"1.05rem"},children:"Malo  Rvisions"}),l&&v.jsx("div",{style:{width:30,height:30,borderRadius:"50%",background:"rgba(255,255,255,0.08)",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"avatar quip",children:l.icon})]}),v.jsx("div",{className:"small",children:n?v.jsxs(v.Fragment,{children:["Connect : ",v.jsx("strong",{children:n.displayName})," ",v.jsx("span",{className:"badge",children:e})]}):"Non connect"})]}),v.jsxs("div",{className:"row",style:{gap:8},children:[v.jsx(Mi,{className:"btn secondary",to:"/",children:"Accueil"}),n&&v.jsx(Mi,{className:"btn secondary",to:"/chest",children:"Coffre"}),n&&v.jsx(Mi,{className:"btn secondary",to:"/world",children:"Carte du monde"}),n&&v.jsx(Mi,{className:"btn secondary",to:"/collection",children:"Ma collection"}),e==="parent"&&v.jsxs(v.Fragment,{children:[v.jsx(Mi,{className:"btn secondary",to:"/admin/import",children:"Import (parent)"}),v.jsx(Mi,{className:"btn secondary",to:"/admin/moderation",children:"Modration"}),v.jsx(Mi,{className:"btn secondary",to:"/admin/progression",children:"Progression enfant"})]}),n&&v.jsx("button",{className:"btn secondary",onClick:t,children:"Dconnexion"})]})]})})}function Li({children:n}){const{user:e,loading:t}=zn();return t?v.jsx("div",{className:"card",children:"Chargement"}):e?v.jsx(v.Fragment,{children:n}):v.jsx(mf,{to:"/connexion",replace:!0})}function hf({children:n}){const{user:e,role:t,loading:s}=zn();return s?v.jsx("div",{className:"card",children:"Chargement"}):e?t!=="parent"?v.jsx(mf,{to:"/",replace:!0}):v.jsx(v.Fragment,{children:n}):v.jsx(mf,{to:"/connexion",replace:!0})}function ia(n){return(n||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[]/g,"'").replace(/\s+/g," ").trim()}async function Pb(n,e){const{uid:t,includeHidden:s=!1,includeOverrides:o=!1}=e||{},l=Bn(gt(le,"themes"),rr("subjectId","==",n)),h=(await jt(l)).docs.map(w=>({id:w.id,...w.data()}));let p=new Map;if(t)try{const w=await jt(gt(le,"users",t,"visibilityThemes"));p=new Map(w.docs.map(T=>[T.id,!!T.data().visible]))}catch{p=new Map}const y=h.filter(w=>{const T=p.get(w.id);return!(!s&&w.hidden||!s&&T===!1)});return o?y.map(w=>({...w,visibleOverride:p.get(w.id)})):y}async function $0(n,e){const{uid:t,includeHidden:s=!1,includeOverrides:o=!1}=e||{},l=Bn(gt(le,"exercises"),rr("themeId","==",n)),h=(await jt(l)).docs.map(w=>({id:w.id,...w.data()}));let p=new Map;if(t)try{const w=await jt(gt(le,"users",t,"visibilityExercises"));p=new Map(w.docs.map(T=>[T.id,!!T.data().visible]))}catch{p=new Map}const y=h.filter(w=>{const T=p.get(w.id);return!(!s&&w.hidden||!s&&T===!1)});return o?y.map(w=>({...w,visibleOverride:p.get(w.id)})):y}async function kb(n){const e=Bn(gt(le,"readings"),rr("themeId","==",n));try{return(await jt(e)).docs.map(s=>({id:s.id,...s.data()}))}catch{return[]}}async function Jp(n,e){const{uid:t,includeHidden:s=!1}=e||{},o=Bn(gt(le,"exercises"),rr("tags","array-contains",n)),u=(await jt(o)).docs.map(p=>({id:p.id,...p.data()}));let h=new Map;if(t)try{const p=await jt(gt(le,"users",t,"visibilityExercises"));h=new Map(p.docs.map(y=>[y.id,!!y.data().visible]))}catch{h=new Map}return u.filter(p=>{const y=h.get(p.id);return!(!s&&p.hidden||!s&&y===!1)})}async function Nb(n){const e=Qp(le);for(const t of n.subjects){e.set(Me(le,"subjects",t.id),{title:t.title},{merge:!0});for(const s of t.themes){e.set(Me(le,"themes",s.id),{subjectId:t.id,title:s.title,grade:n.grade,readings:Array.isArray(s.readings)?s.readings:[]},{merge:!0});for(const o of s.exercises){const l=Me(le,"exercises",o.id),u={...o,themeId:s.id};u.tags=Array.isArray(u.tags)?u.tags.slice(0,3):[],u.type==="short_text"&&Array.isArray(u.expected)&&(u.expected=u.expected.map(h=>ia(h))),u.type==="fill_blank"&&Array.isArray(u.expected)&&(u.expected=u.expected.map(h=>ia(h))),e.set(l,u,{merge:!0})}if(Array.isArray(s.readings))for(const o of s.readings){if(!o.id||!o.title||!o.text||!Array.isArray(o.questions))continue;o.id,o.title,o.text,o.difficulty,Array.isArray(o.tags)&&o.tags.slice(0,3),o.questions.map(u=>({...u,type:"mcq",themeId:s.id,tags:Array.isArray(u.tags)?u.tags.slice(0,3):[]}));const l=Me(le,"themes",s.id);e.set(l,{readings:[...(Array.isArray(s.readings)?s.readings:[]).map(u=>({...u,themeId:s.id}))]},{merge:!0})}}}await e.commit()}async function Db(n,e){await ls(Me(le,"themes",n),{hidden:e},{merge:!0})}async function Ob(n,e){await ls(Me(le,"exercises",n),{hidden:e},{merge:!0})}async function Vb(n,e,t){await ls(Me(le,"users",n,"visibilityThemes",e),{visible:t},{merge:!0})}async function jb(n,e,t){await ls(Me(le,"users",n,"visibilityExercises",e),{visible:t},{merge:!0})}async function Mb(n){try{const e=Qp(le);return e.delete(Me(le,"themes",n)),(await jt(Bn(gt(le,"exercises"),rr("themeId","==",n)))).docs.forEach(o=>e.delete(o.ref)),(await jt(Bn(gt(le,"readings"),rr("themeId","==",n)))).docs.forEach(o=>e.delete(o.ref)),await e.commit(),{deleted:!0}}catch{return await ls(Me(le,"themes",n),{hidden:!0},{merge:!0}),{deleted:!1,hidden:!0}}}function nv(n){return n.toISOString().slice(0,10)}function Lb(n,e){return n===1?e?3:-1:n===2?e?5:-2:e?7:-3}function Fb(n){return Math.max(0,Math.min(100,n))}function Ub(n){return n>=80?"mastered":n>=60?"nearly":n>=30?"developing":"weak"}async function Bb(n){const{uid:e,items:t,existingAttemptId:s}=n,o=new Date,l=nv(o),u=t.length,h=t.filter(k=>k.correct).length;if(u===0)return{xpGain:0,coinsGain:0,streakDays:0,badges:[],score:0,outOf:0};const p=new Map;t.forEach(k=>{const $=Array.isArray(k.tags)?k.tags.slice(0,3):[],j=Lb(k.difficulty,k.correct);$.forEach(O=>{const Z=p.get(O)||{delta:0,correct:0,wrong:0};p.set(O,{delta:Z.delta+j,correct:Z.correct+(k.correct?1:0),wrong:Z.wrong+(k.correct?0:1)})})});const y=h*10,w=Math.max(1,Math.min(3,Math.round(h/Math.max(1,u)*3)));let T=null;const C=s?Me(le,"users",e,"attempts",s):Me(gt(le,"users",e,"attempts"));return t.map(()=>Me(gt(C,"items"))),await li(le,async k=>{const $=Me(le,"users",e,"stats","main"),j=Me(le,"users",e,"progressSummary","main"),O=Array.from(p.keys()).map(N=>Me(le,"users",e,"tagProgress",N)),[Z,G,X]=await Promise.all([k.get($),k.get(j),Promise.all(O.map(N=>k.get(N)))]),q=Z.exists()?Z.data():{xp:0,coins:0,streakDays:0,lastDoneDate:null,badges:[]};let M=q.streakDays||0;const H=q.lastDoneDate;if(H!==l){const N=nv(new Date(o.getTime()-864e5));M=H===N?M+1:1}const I=new Set(Array.isArray(q.badges)?q.badges:[]);M>=3&&I.add("3 jours daffile"),M>=7&&I.add("7 jours daffile"),h===u&&u>=10&&I.add("Zro faute (10+)");const S=G.exists()?G.data():null,R={weak:0,developing:0,nearly:0,mastered:0};for(let N=0;N<O.length;N++){const P=O[N],x=X[N],ge=P.id,Ue=p.get(ge),Ke=x.exists()?x.data():null,xe=typeof Ke?.mastery=="number"?Ke.mastery:0,re=Ke?.bucket,ve=Fb(xe+Ue.delta),ae=Ub(ve);re&&S&&(R[re]-=1),R[ae]+=1,k.set(P,{mastery:ve,bucket:ae,correctAnswers:(Ke?.correctAnswers||0)+Ue.correct,wrongAnswers:(Ke?.wrongAnswers||0)+Ue.wrong,lastDelta:Ue.delta,updatedAt:Ye()},{merge:!0})}const V=S?.masteryBuckets||{weak:0,developing:0,nearly:0,mastered:0};k.set($,{xp:(q.xp||0)+y,coins:(q.coins||0)+w,streakDays:M,lastDoneDate:l,badges:Array.from(I),updatedAt:Ye()},{merge:!0}),k.set(j,{totalAnswers:(S?.totalAnswers||0)+u,correctAnswers:(S?.correctAnswers||0)+h,totalAttempts:(S?.totalAttempts||0)+1,masteryBuckets:{weak:(V.weak||0)+R.weak,developing:(V.developing||0)+R.developing,nearly:(V.nearly||0)+R.nearly,mastered:(V.mastered||0)+R.mastered},lastAttemptId:C.id,lastDate:l,updatedAt:Ye()},{merge:!0}),T={xpGain:y,coinsGain:w,streakDays:M,badges:Array.from(I)}}),{...T||{xpGain:0,coinsGain:0,streakDays:0,badges:[]},score:h,outOf:u}}async function zb(n){return(await jt(gt(le,"users",n,"inventory"))).docs.map(t=>({id:t.id,...t.data()}))}const rv=[{id:"streak_3",title:"Srie 3",description:"3 jours de suite",icon:""},{id:"streak_7",title:"Srie 7",description:"7 jours de suite",icon:""},{id:"retry_5",title:"Persvrant",description:"5 erreurs revues",icon:""},{id:"tag_master_3",title:"Matre x3",description:"3 tags matriss",icon:""},{id:"tag_master_10",title:"Matre x10",description:"10 tags matriss",icon:""},{id:"fractions_first_mastery",title:"As des fractions",description:"1er tag fractions matris",icon:""},{id:"grammar_first_mastery",title:"As de grammaire",description:"1er tag grammaire matris",icon:""},{id:"sessions_10",title:"Marathon 10",description:"10 sances termines",icon:""}];function qb(n){return 100+(Math.max(1,Math.floor(n))-1)*50}function bl(n){let e=Math.max(0,Math.floor(n)),t=1;for(;;){const s=qb(t);if(e<s)return{level:t,xpIntoLevel:e,xpForNext:s};e-=s,t+=1}}function $b(n){return Math.max(0,n.answeredCount)*2+10}function Wb(n){return n>=70?"mastered":n>=30?"progressing":"discovering"}function W0(n){const e={...n.masteryByTag||{}},t=n.isCorrect?8:2;return n.questionTags.forEach(s=>{const o=e[s]?.score||0,l=Math.max(0,Math.min(100,o+t));e[s]={score:l,state:Wb(l),updatedAt:n.timestamp}}),e}async function Xp(n,e,t){const s=ri.find(u=>u.id===e);if(!s)throw new Error("Collectible inconnu");const o=Me(le,"users",n,"meta","rewards"),l=t?Me(le,"users",n,"rewardEvents",t):null;await li(le,async u=>{const[h,p]=await Promise.all([u.get(o),l?u.get(l):Promise.resolve(null)]);if(p&&p.exists())return;const y=h.exists()?h.data():null,w={xp:y?.xp||0,level:y?.level||1,badges:Array.isArray(y?.badges)?y.badges:[],masteryByTag:typeof y?.masteryByTag=="object"&&y?.masteryByTag?y.masteryByTag:{},collectibles:y?.collectibles&&Array.isArray(y.collectibles.owned)?y.collectibles:{owned:[],equippedAvatarId:null},updatedAt:y?.updatedAt},T=new Set(w.collectibles?.owned||[]);T.add(e);const C=s.type==="avatar"&&!w.collectibles?.equippedAvatarId;u.set(o,{collectibles:{owned:Array.from(T),equippedAvatarId:C?e:w.collectibles?.equippedAvatarId??null},updatedAt:Ye()},{merge:!0}),l&&u.set(l,{type:"collectible",collectibleId:e,createdAt:Ye()})})}async function Yp(n,e){if(!ri.find(o=>o.id===e&&o.type==="avatar"))throw new Error("Avatar inconnu");const s=Me(le,"users",n,"meta","rewards");await li(le,async o=>{const l=await o.get(s),u=l.exists()?l.data():null,h=new Set(u?.collectibles?.owned||[]);if(!h.has(e))throw new Error("Avatar non possd");o.set(s,{collectibles:{owned:Array.from(h),equippedAvatarId:e},updatedAt:Ye()},{merge:!0})})}function Zp(){const n=new Date,t=new Intl.DateTimeFormat("fr-FR",{timeZone:"Europe/Paris",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(n),s=t.find(u=>u.type==="year")?.value,o=t.find(u=>u.type==="month")?.value,l=t.find(u=>u.type==="day")?.value;return`${s}-${o}-${l}`}const cu=[{id:"session_one",title:"Faire 1 sance",description:"Lance et termine une sance.",target:1,progress:0,completed:!1},{id:"answer_ten",title:"Rpondre  10 questions",description:"Rponds  10 questions, mme courtes.",target:10,progress:0,completed:!1},{id:"grammar_one",title:"Grammaire : 1 question",description:"Travaille un tag de grammaire.",target:1,progress:0,completed:!1},{id:"fractions_five",title:"Fractions : 5 questions",description:"Rvise les fractions (maths).",target:5,progress:0,completed:!1}];function H0(){const n=[cu[0],cu[1]],e=[cu[2],cu[3]],t=e[Math.floor(Math.random()*e.length)];return[...n,t].map(s=>({...s}))}async function Hb(n){const e=Zp(),t=Me(le,"users",n,"meta","daily"),s=await Dr(t),o=s.exists()?s.data():null;if(!o||o.dateKey!==e){const l={dateKey:e,quests:H0(),updatedAt:Ye()};return await ls(t,l),l}return o}async function Gb(n){const{uid:e,sessionId:t,answeredCount:s,tagsUsed:o}=n,l=Me(le,"users",e,"meta","daily"),u=Me(le,"users",e,"meta","rewards"),h=Me(le,"users",e,"rewardEvents",`daily_${t}`),p=Zp();await Hb(e);let y=null;if(await li(le,async w=>{const[T,C,k]=await Promise.all([w.get(l),w.get(h),w.get(u)]);if(C.exists())return;const $=T.exists()?T.data():null;if(!$||$.dateKey!==p){w.set(l,{dateKey:p,quests:H0(),updatedAt:Ye()});return}const j=o||[],O=j.filter(M=>M.includes("grammaire")||M.includes("grammar")).length,Z=j.filter(M=>M.startsWith("math_fractions")).length;let G=0,X=!1;const q=$.quests.map(M=>{let H=0;M.id==="session_one"&&(H=1),M.id==="answer_ten"&&(H=s),M.id==="grammar_one"&&(H=O>0?1:0),M.id==="fractions_five"&&(H=Z);const I=Math.min(M.target,(M.progress||0)+H),S=M.completed,R=I>=M.target;return R&&!S&&(X=!0,G+=15),{...M,progress:I,completed:R}});if(X){const M=k.exists()?k.data():{},I=(M?.xp||0)+G,S=bl(I);w.set(u,{xp:I,level:S.level,badges:M?.badges||[],masteryByTag:M?.masteryByTag||{},collectibles:M?.collectibles?{owned:M.collectibles.owned||[],equippedAvatarId:M.collectibles.equippedAvatarId??null}:{owned:[],equippedAvatarId:null},updatedAt:Ye()},{merge:!0});const R=new Set(M?.collectibles?.owned||[]),V=ri.filter(N=>N.rarity==="common"&&N.type==="sticker"&&!R.has(N.id));V.length&&(y=V[Math.floor(Math.random()*V.length)].id)}w.set(l,{dateKey:p,quests:q,updatedAt:Ye()},{merge:!0}),w.set(h,{sessionId:t,createdAt:Ye()})}),y)try{await Xp(e,y,`daily_sticker_${t}`)}catch(w){console.error("unlockCollectible daily",w)}}async function Kb(n){const{uid:e}=n,t=n.dateKey||Zp(),s=n.sessionsDelta??0,o=n.xpDelta??0,l=Me(le,"users",e,"statsDays",t);await ls(l,{dateKey:t,sessions:s,xp:o,updatedAt:Ye()},{merge:!0})}async function Qb(n){const e=gt(le,"users",n,"statsDays");return(await jt(Bn(e,gb("dateKey","desc"),Gp(7)))).docs.map(o=>o.data()).sort((o,l)=>o.dateKey.localeCompare(l.dateKey))}const Wo={scout:{id:"scout",name:"Le Scout",avatar:"",shortTagline:"Je repre la meilleure mission du jour.",tone:"adventure"},robot:{id:"robot",name:"Le Robot Prof",avatar:"",shortTagline:"Je te propose un plan simple et efficace.",tone:"rational"},goblin:{id:"goblin",name:"Le Gobelin Malin",avatar:"",shortTagline:"Je te lance des dfis mais je taide aussi.",tone:"fun"}},Jb={scout:{repair:["Ton bloc craque. On le rpare ensemble ?","Je vois une fissure ici. On retourne l solidifier.","Un pas en arrire pour repartir plus fort : mission rparation.","On revient sur ce bloc : je taccompagne, cest rapide.","Rafistolage express : on comble les brches.","Revoir calmement, cest la cl. Partons rparer.","On renforce les bases : mission rparation en vue.","Je trace la route vers un bloc fissur. On y va ?","On rebouche les trous, puis on reprendra lascension.","Une courte halte pour ajuster ce bloc.","Je dtecte un bloc fragile. On sen occupe dabord.","Rparer, puis repartir : cest notre plan du jour.","Mission soin : on remet ce bloc en forme.","On revisite ce point faible avec mthode.","On resserre les boulons et on passe  la suite.","Une rparation vaut mieux quun effondrement. Prt ?","On vrifie, on corrige, on scurise. En avant.","Rappel express, puis on grimpe : mission rparation."],priority:["Mission prioritaire repre : cest le moment.","Je pointe un bloc cl pour aujourdhui.","Ce bloc touvrira la suite. On y va.","Objectif du jour : consolider ce bloc essentiel.","Je te propose la voie rapide vers le prochain palier.","Ce bloc doit passer devant. Je temmne.","Cap sur un bloc important pour tes progrs.","On prend litinraire optimal : ce bloc dabord.","Je privilgie ce bloc pour taider  avancer.","Un bloc dcisif tattend. Partons.","Cible prioritaire, effort concentr.","Je te guide sur le meilleur gain du jour.","On choisit la piste la plus rentable.","Ce bloc dbloquera la suite : fonons.","Slection du jour : ce bloc mrite ton focus.","Je rduis le chemin : ce bloc est la cl.","Mission directe sur un bloc stratgique.","On scurise ce point, puis on explorera plus loin."],spaced:["On revisite un bloc oubli depuis quelques jours.","Petit rappel lointain : on remet ce bloc en tte.","Je ressors une balise ancienne, on la ractive.","Un peu de rvision espace pour rester solide.","On dpoussire ce bloc. a sera vite fait.","Rappel doux : ce bloc mrite un coup dil.","On renforce la mmoire : passage clair ici.","Retour  un bloc crois il y a quelque temps.","Je propose une session courte sur un ancien bloc.","On ractive ce savoir, sans stress.","Un flashback utile pour rester au top.","On refait surface sur ce bloc discret.","Mission rappel : on vrifie que tout tient.","Rvision espace : juste ce quil faut.","On ancre durablement en repassant ici.","On fait un tour sur ce bloc en sommeil.","Je temmne revoir un repre loign.","Courte escale mmoire sur ce bloc."],craft:["On combine deux blocs, prt  crafter ?","Atelier express : on mlange deux notions.","Dfi cration : assembler deux blocs solides.","On tisse un lien entre ces blocs, faon craft.","On fabrique une avance avec deux lments.","Je propose un duo de blocs pour progresser.","On fusionne les comptences : mission craft.","Construisons un pont entre ces blocs.","On forge une nouvelle matrise avec ce duo.","Mlange malin : deux blocs, une mission.","Je te guide pour assembler ces savoirs.","On cre un combo gagnant aujourdhui.","Deux blocs allis pour une expdition.","On passe en mode atelier : craft rapide.","On sculpte une mission  deux blocs.","On associe, on consolide, on avance.","Laboratoire du jour : fusion de blocs.","Recette du jour : craft efficace."]},robot:{repair:["Analyse : bloc instable. Correction recommande.","Protocole rparation : cible dtecte.","Priorit systme : combler les erreurs.","Retour sur un chec rcent pour stabiliser.","Rglage fin requis. Lancement correction.","On patch le bloc avant nouvelle monte.","Erreur repre. Squence de rparation.","Module rparation actif pour ce bloc.","On rduit le risque en corrigeant ici.","Cycle court de correction conseill.","Stabilisation ncessaire : bloc fissur.","Plan : corriger, vrifier, valider.","On ferme la faille et on continue.","Bloc fragile identifi. Fix en cours.","Process rapide : correction cible.","On limine cette faiblesse maintenant.","Rparer avant dajouter de la complexit.","Calibration du bloc en priorit."],priority:["Priorit calcule : ce bloc maximise ton gain.","Slection optimise : travaille ce bloc.","Chemin le plus court : ce bloc dabord.","Optimisation : focus sur ce bloc cl.","Je te dirige vers le meilleur ROI du jour.","Bloc stratgique identifi pour progresser.","Plan efficace : ce bloc en premire position.","Priorit systme : renforcer ce bloc.","Squence optimale : ce bloc avant les autres.","Ce bloc dbloquera plus de points. Excutons.","Je choisis la cible la plus rentable.","Cible prioritaire : gain attendu maximal.","Ce bloc est ton acclrateur du jour.","Alignement optimal : commence ici.","Je simplifie : un bloc, un progrs net.","Route minimale : ce bloc au centre.","Paramtrage : mission sur ce bloc cl.","Processus : priorit haute sur ce bloc."],spaced:["Rvision espace programme : bloc oubli.","Rappel mmoire : revisitons ce bloc.","Intervalle dtect >5 jours. Rafrachissons.","On relit ce bloc pour consolider.","Maintenance mmoire : passage rapide ici.","Ractivation ncessaire : bloc ancien.","Boucle de rappel : courte session.","Je dclenche une vrification priodique.","On recharge ce savoir pour viter la perte.","Sance courte : renforcement espac.","Ancrage long terme : revoir ce bloc.","Routine spaced repetition : ce bloc.","On valide que ce bloc reste stable.","Ping mmoire : ce bloc en attente.","Refresh programm pour ce bloc.","Cycle espac : contrle rapide.","Stabilit mmoire : test sur ce bloc.","Rvision chronologique : on y retourne."],craft:["Fusion de comptences : mission craft.","Assemblage logique : deux blocs, une cible.","On combine deux notions pour crer un lien.","Atelier synthse : craft calcul.","Je propose un binme de blocs complmentaires.","Construction avance : fusion de savoirs.","On mixe ces blocs pour renforcer la structure.","Plan duo : mission craft  deux blocs.","On tablit une passerelle entre deux notions.","Craft contrl : assembler et vrifier.","On teste une combinaison pour progresser.","Synthse : deux blocs, progression unique.","On code une mission craft prcise.","Exprience combinatoire : allons-y.","Deux blocs corrls, une mission claire.","On structure un combo pour tlever.","Mlange optimis : craft de prcision.","On valide un duo de blocs matriss."]},goblin:{repair:["Oups, un bloc fissur ! On va le rafistoler.","Je chipote, mais a craque ici. On rpare ?","Gobelin dtecte une btise : on la corrige vite.","On repart sur ce bloc pour le rendre costaud.","Petit soin gobelin : on bouche les trous.","Revenons sur cet chec, sans panique.","Je taide  recoller les morceaux de ce bloc.","On tire sur ce fil, puis on le renforce.","Un bloc caboss ? On le polit ensemble.","On efface les griffures : mission rparation.","Je fais une grimace, mais on va y arriver.","Pause bricolage : on consolide ce bloc.","Je tpaule pour rparer cette faille.","Rparer maintenant, fanfaronner aprs.","On corrige, on rigole, on repart.","Mission rustine : rapide et indolore.","On remet ce bloc en forme avec malice.","Une rparation gobeline, et on continue."],priority:["Je parie que ce bloc te fera gagner vite.","Celui-ci est juteux : on fonce !","Bloc prioritaire repr par le gobelin malin.","Je mise sur ce bloc : jackpot dapprentissage.","On attaque ce bloc, il en vaut la peine.","Prends ce raccourci : ce bloc dabord.","Je pointe mon doigt gobelin : commence ici.","Ce bloc va te propulser, promis.","Focus gobelin : ce bloc est la cl.","Cible dore repre. On y va ?","On grille la file : ce bloc passe en priorit.","Je te chuchote : cest le bon choix du jour.","Un bloc vip tattend. Prt ?","Jai flair le meilleur coup : ce bloc.","On saute dessus, il est top pour toi.","Plan malin : ce bloc, puis le reste.","Ce bloc ouvre la porte. On le dbloque.","Priorit gobeline active sur ce bloc."],spaced:["H, on na pas vu ce bloc depuis longtemps !","Petit rappel malin : revisitons ce bloc.","On dpoussire un vieux bloc. Rapide !","Un saut dans le pass : ce bloc revient.","Je remets ce bloc sur la table. Go !","Rappel malin : on va le rendre frais.","On rveille ce bloc qui dormait.","Le gobelin aime les surprises : retour ici.","On refait un tour sur ce bloc ancien.","Rvision clair pour garder la main.","On ranime ce bloc, sans stress.","Piqre de rappel : ce bloc a besoin damour.","On fait un coucou  ce bloc oubli.","Un clin dil au pass : on repasse l.","Rappel gobelin : ce bloc veut revenir.","On vrifie que ce bloc tient toujours.","Ractivation rapide : on samuse aussi.","On revisite ce bloc, version malice."],craft:["On mlange deux blocs, faon potion gobeline.","Atelier bricolage : on combine des notions.","Je te propose un duo tonnant. Prt ?","On tisse deux blocs pour un truc gnial.","Dfi : fusionner ces deux blocs solides.","On assemble et on cre, easy.","Recette gobeline : deux blocs, une mission.","On fait un mix malin : craft du jour.","On associe ces blocs pour briller.","Combo fun : deux blocs main dans la main.","On bidouille un craft efficace.","On cre un pont entre ces deux ides.","Mission atelier : on teste ce mlange.","On bricole un duo gagnant.","Deux blocs, double fun, une mission.","On fait danser deux blocs ensemble.","On invente un craft rapide et malin.","On combine et on samuse : mission craft."]}};function G0(n,e){return`malocraft.npc.lastLines.${n}.${e}`}function Xb(n,e){if(typeof localStorage>"u")return[];try{const t=localStorage.getItem(G0(n,e));if(!t)return[];const s=JSON.parse(t);return Array.isArray(s)?s.filter(o=>typeof o=="number"):[]}catch{return[]}}function Yb(n,e,t){typeof localStorage>"u"||localStorage.setItem(G0(n,e),JSON.stringify(t.slice(-5)))}function uu(n){const e=Jb[n.npcId][n.reason];if(!e.length)return"";const t=Xb(n.npcId,n.reason);let s=0;for(let o=0;o<6;o++){const l=Math.floor(Math.random()*e.length);if(!t.includes(l)||o===5){s=l;break}}return Yb(n.npcId,n.reason,[...t,s]),e[s]}const K0={biome_fr_foret_langue:{id:"biome_fr_foret_langue",name:"Fort de la Langue",description:"Lecture, grammaire, conjugaison : renforce tes blocs de franais.",icon:"",subject:"fr",order:10},biome_math_mines:{id:"biome_math_mines",name:"Mines des Nombres",description:"Fractions, calcul et problmes : mine des ressources de maths.",icon:"",subject:"math",order:20},biome_en_village:{id:"biome_en_village",name:"Village Anglais",description:"Vocabulaire et grammaire : parle et comprends langlais.",icon:"",subject:"en",order:30},biome_es_village:{id:"biome_es_village",name:"Village Espagnol",description:"Vocabulaire et grammaire : progresse en espagnol.",icon:"",subject:"es",order:40},biome_hist_plaines:{id:"biome_hist_plaines",name:"Plaines des Repres",description:"Repres, cartes et chronologie : explore lhistoire-go.",icon:"",subject:"hist",order:50}},Q0=Object.values(K0).sort((n,e)=>n.order-e.order);function Zb(n){return K0[n]}function Ho(n){switch(n){case"math":return"biome_math_mines";case"en":return"biome_en_village";case"es":return"biome_es_village";case"hist":return"biome_hist_plaines";default:return"biome_fr_foret_langue"}}const J0={fr:"Franais",math:"Mathmatiques",en:"Anglais",es:"Espagnol",hist:"Histoire-Gographie"},eP={discovering:"En dcouverte",progressing:"En progrs",mastered:"Matris"},tP={discovering:"Tu commences",progressing:"Tu consolides",mastered:"Cest acquis"};function nP(n){return n.replace(/^(fr|math|en|es|hist)_/i,"").replace(/_/g," ").replace(/\s+/g," ").trim().replace(/^./,e=>e.toUpperCase())}function Ui(n){const e=n.toLowerCase();return e.startsWith("math_")?"math":e.startsWith("en_")?"en":e.startsWith("es_")?"es":e.startsWith("hist_")?"hist":"fr"}function Td(n){return X0[n]??{id:n,label:nP(n),subject:Ui(n),theme:"Autres",order:9999,description:"Tag non catalogu (affichage automatique)."}}const X0={fr_comprehension_idee_principale:{id:"fr_comprehension_idee_principale",label:"Ide principale",description:"Trouver le message global du texte.",subject:"fr",theme:"Comprhension",order:10},fr_comprehension_detail:{id:"fr_comprehension_detail",label:"Informations explicites",description:"Reprer une info donne directement.",subject:"fr",theme:"Comprhension",order:20},fr_comprehension_inference:{id:"fr_comprehension_inference",label:"Infrences",description:"Dduire une info implicite.",subject:"fr",theme:"Comprhension",order:30},fr_comprehension_vocabulaire_contexte:{id:"fr_comprehension_vocabulaire_contexte",label:"Vocabulaire en contexte",description:"Comprendre un mot grce au contexte.",subject:"fr",theme:"Comprhension",order:40},fr_comprehension_pronom_referent:{id:"fr_comprehension_pronom_referent",label:"Rfrents des pronoms",description:"Identifier  qui/quoi renvoie un pronom.",subject:"fr",theme:"Comprhension",order:50},fr_comprehension_connecteurs_logiques:{id:"fr_comprehension_connecteurs_logiques",label:"Connecteurs logiques",description:"Comprendre le lien entre les ides (cause, consquence).",subject:"fr",theme:"Comprhension",order:60},fr_comprehension_chronologie:{id:"fr_comprehension_chronologie",label:"Chronologie",description:"Reconstituer lordre des vnements.",subject:"fr",theme:"Comprhension",order:70},fr_comprehension_point_de_vue:{id:"fr_comprehension_point_de_vue",label:"Point de vue / narrateur",description:"Identifier qui parle et comment.",subject:"fr",theme:"Comprhension",order:80},fr_comprehension_intention_auteur:{id:"fr_comprehension_intention_auteur",label:"Intention du texte",description:"Informer, convaincre, raconter, expliquer",subject:"fr",theme:"Comprhension",order:90},fr_lexique_synonyme:{id:"fr_lexique_synonyme",label:"Synonymes",description:"Choisir le mot de sens proche.",subject:"fr",theme:"Lexique",order:110},fr_lexique_antonyme:{id:"fr_lexique_antonyme",label:"Antonymes",description:"Trouver le mot de sens contraire.",subject:"fr",theme:"Lexique",order:120},fr_lexique_famille_mots:{id:"fr_lexique_famille_mots",label:"Familles de mots",description:"Reconnatre des mots de mme famille.",subject:"fr",theme:"Lexique",order:130},fr_lexique_niveaux_langue:{id:"fr_lexique_niveaux_langue",label:"Niveaux de langue",description:"Soutenu, courant, familier.",subject:"fr",theme:"Lexique",order:140},fr_lexique_sens_propre_figure:{id:"fr_lexique_sens_propre_figure",label:"Sens propre / figur",description:"Distinguer sens littral et image.",subject:"fr",theme:"Lexique",order:150},fr_grammaire_classes_mots:{id:"fr_grammaire_classes_mots",label:"Classes de mots",description:"Nom, verbe, adjectif, pronom, dterminant",subject:"fr",theme:"Grammaire",order:210},fr_grammaire_fonctions:{id:"fr_grammaire_fonctions",label:"Fonctions",description:"Sujet, COD/COI, complments, attribut",subject:"fr",theme:"Grammaire",order:220},fr_grammaire_gn_gv:{id:"fr_grammaire_gn_gv",label:"Groupe nominal / verbal",description:"Identifier GN et GV.",subject:"fr",theme:"Grammaire",order:230},fr_grammaire_phrase_simple_complexe:{id:"fr_grammaire_phrase_simple_complexe",label:"Phrase simple / complexe",description:"Nombre de verbes conjugus, propositions.",subject:"fr",theme:"Grammaire",order:240},fr_grammaire_propositions:{id:"fr_grammaire_propositions",label:"Propositions",description:"Identifier proposition principale et subordonne.",subject:"fr",theme:"Grammaire",order:250},fr_grammaire_coordination_juxtaposition:{id:"fr_grammaire_coordination_juxtaposition",label:"Coordination / juxtaposition",description:"Et/mais/donc ou virgules/point-virgule.",subject:"fr",theme:"Grammaire",order:260},fr_grammaire_subordination:{id:"fr_grammaire_subordination",label:"Subordination",description:"Introduite par une conjonction / pronom relatif.",subject:"fr",theme:"Grammaire",order:270},fr_grammaire_proposition_relative:{id:"fr_grammaire_proposition_relative",label:"Proposition relative",description:"Relative introduite par qui/que/dont/o",subject:"fr",theme:"Grammaire",order:280},fr_grammaire_completive:{id:"fr_grammaire_completive",label:"Subordonne compltive",description:"Introduite par que/si, complte un verbe.",subject:"fr",theme:"Grammaire",order:290},fr_grammaire_circonstancielle:{id:"fr_grammaire_circonstancielle",label:"Subordonne circonstancielle",description:"Temps, cause, consquence, but, condition",subject:"fr",theme:"Grammaire",order:300},fr_grammaire_negation:{id:"fr_grammaire_negation",label:"Ngation",description:"Ne pas / jamais / plus / rien / personne",subject:"fr",theme:"Grammaire",order:310},fr_grammaire_interrogation:{id:"fr_grammaire_interrogation",label:"Interrogation",description:"Totale / partielle, formes et mots interrogatifs.",subject:"fr",theme:"Grammaire",order:320},fr_grammaire_voix_active_passive:{id:"fr_grammaire_voix_active_passive",label:"Voix active / passive",description:"Transformer une phrase.",subject:"fr",theme:"Grammaire",order:330},fr_grammaire_discours_direct_indirect:{id:"fr_grammaire_discours_direct_indirect",label:"Discours direct / indirect",description:"Transformer une parole rapporte.",subject:"fr",theme:"Grammaire",order:340},fr_conjugaison_present:{id:"fr_conjugaison_present",label:"Prsent",subject:"fr",theme:"Conjugaison",order:410},fr_conjugaison_imparfait:{id:"fr_conjugaison_imparfait",label:"Imparfait",subject:"fr",theme:"Conjugaison",order:420},fr_conjugaison_passe_simple:{id:"fr_conjugaison_passe_simple",label:"Pass simple",subject:"fr",theme:"Conjugaison",order:430},fr_conjugaison_futur_simple:{id:"fr_conjugaison_futur_simple",label:"Futur simple",subject:"fr",theme:"Conjugaison",order:440},fr_conjugaison_passe_compose:{id:"fr_conjugaison_passe_compose",label:"Pass compos",subject:"fr",theme:"Conjugaison",order:450},fr_conjugaison_plus_que_parfait:{id:"fr_conjugaison_plus_que_parfait",label:"Plus-que-parfait",subject:"fr",theme:"Conjugaison",order:460},fr_conjugaison_conditionnel_present:{id:"fr_conjugaison_conditionnel_present",label:"Conditionnel prsent",subject:"fr",theme:"Conjugaison",order:470},fr_conjugaison_imperatif:{id:"fr_conjugaison_imperatif",label:"Impratif",subject:"fr",theme:"Conjugaison",order:480},fr_conjugaison_subjonctif_present:{id:"fr_conjugaison_subjonctif_present",label:"Subjonctif prsent",subject:"fr",theme:"Conjugaison",order:490},fr_conjugaison_valeurs_temps:{id:"fr_conjugaison_valeurs_temps",label:"Valeurs des temps",description:"Imparfait (description/habitude), pass simple (actions)",subject:"fr",theme:"Conjugaison",order:500},fr_conjugaison_accord_participe_passe:{id:"fr_conjugaison_accord_participe_passe",label:"Accord du participe pass",description:"Avec tre/avoir (rgles de base).",subject:"fr",theme:"Conjugaison",order:510},fr_orthographe_accord_gn:{id:"fr_orthographe_accord_gn",label:"Accords dans le GN",description:"Dterminant/nom/adjectif.",subject:"fr",theme:"Orthographe",order:610},fr_orthographe_accord_sujet_verbe:{id:"fr_orthographe_accord_sujet_verbe",label:"Accord sujet-verbe",subject:"fr",theme:"Orthographe",order:620},fr_orthographe_homophones_grammaticaux:{id:"fr_orthographe_homophones_grammaticaux",label:"Homophones grammaticaux",description:"a/, et/est, son/sont, ces/ses",subject:"fr",theme:"Orthographe",order:630},fr_orthographe_punctuation:{id:"fr_orthographe_punctuation",label:"Ponctuation",subject:"fr",theme:"Orthographe",order:640},math_fractions_vocabulaire:{id:"math_fractions_vocabulaire",label:"Vocabulaire des fractions",description:"Numrateur/dnominateur, fraction dune quantit",subject:"math",theme:"Fractions",order:10},math_fractions_representer:{id:"math_fractions_representer",label:"Reprsenter une fraction",description:"Sur une figure / droite gradue.",subject:"math",theme:"Fractions",order:20},math_fractions_equivalentes:{id:"math_fractions_equivalentes",label:"Fractions quivalentes",subject:"math",theme:"Fractions",order:30},math_fractions_simplifier:{id:"math_fractions_simplifier",label:"Simplifier une fraction",subject:"math",theme:"Fractions",order:40},math_fractions_comparer:{id:"math_fractions_comparer",label:"Comparer des fractions",subject:"math",theme:"Fractions",order:50},math_fractions_ordonner:{id:"math_fractions_ordonner",label:"Ordonner des fractions",subject:"math",theme:"Fractions",order:60},math_fractions_addition:{id:"math_fractions_addition",label:"Addition de fractions",subject:"math",theme:"Fractions",order:70},math_fractions_soustraction:{id:"math_fractions_soustraction",label:"Soustraction de fractions",subject:"math",theme:"Fractions",order:80},math_fractions_multiplication:{id:"math_fractions_multiplication",label:"Multiplication de fractions",subject:"math",theme:"Fractions",order:90},math_fractions_division:{id:"math_fractions_division",label:"Division par une fraction",subject:"math",theme:"Fractions",order:100},math_fractions_problemes:{id:"math_fractions_problemes",label:"Problmes avec fractions",subject:"math",theme:"Fractions",order:110},math_nombres_entiers:{id:"math_nombres_entiers",label:"Nombres entiers",subject:"math",theme:"Nombres & calcul",order:210},math_nombres_decimaux:{id:"math_nombres_decimaux",label:"Nombres dcimaux",subject:"math",theme:"Nombres & calcul",order:220},math_priorites_operatoires:{id:"math_priorites_operatoires",label:"Priorits opratoires",subject:"math",theme:"Nombres & calcul",order:230},math_calcul_mental:{id:"math_calcul_mental",label:"Calcul mental",subject:"math",theme:"Nombres & calcul",order:240},math_puissances_base:{id:"math_puissances_base",label:"Puissances (bases)",subject:"math",theme:"Nombres & calcul",order:250},math_geometrie_angles:{id:"math_geometrie_angles",label:"Angles",subject:"math",theme:"Gomtrie",order:310},math_geometrie_triangles:{id:"math_geometrie_triangles",label:"Triangles",subject:"math",theme:"Gomtrie",order:320},math_geometrie_paralleles:{id:"math_geometrie_paralleles",label:"Droites parallles/perpendiculaires",subject:"math",theme:"Gomtrie",order:330},math_geometrie_symetrie_axiale:{id:"math_geometrie_symetrie_axiale",label:"Symtrie axiale",subject:"math",theme:"Gomtrie",order:340},math_geometrie_cercle:{id:"math_geometrie_cercle",label:"Cercle",subject:"math",theme:"Gomtrie",order:350},math_mesures_perimetre:{id:"math_mesures_perimetre",label:"Primtre",subject:"math",theme:"Grandeurs & mesures",order:410},math_mesures_aire:{id:"math_mesures_aire",label:"Aire",subject:"math",theme:"Grandeurs & mesures",order:420},math_mesures_volumes:{id:"math_mesures_volumes",label:"Volumes (bases)",subject:"math",theme:"Grandeurs & mesures",order:430},math_mesures_unites_conversions:{id:"math_mesures_unites_conversions",label:"Conversions dunits",subject:"math",theme:"Grandeurs & mesures",order:440},math_proportionnalite_tableaux:{id:"math_proportionnalite_tableaux",label:"Tableaux de proportionnalit",subject:"math",theme:"Proportionnalit",order:510},math_proportionnalite_pourcentages:{id:"math_proportionnalite_pourcentages",label:"Pourcentages (bases)",subject:"math",theme:"Proportionnalit",order:520},math_proportionnalite_echelles:{id:"math_proportionnalite_echelles",label:"chelles (bases)",subject:"math",theme:"Proportionnalit",order:530},en_vocab_daily_life:{id:"en_vocab_daily_life",label:"Vocabulaire du quotidien",subject:"en",theme:"Vocabulaire",order:10},en_vocab_school:{id:"en_vocab_school",label:"Vocabulaire de lcole",subject:"en",theme:"Vocabulaire",order:20},en_grammar_pronouns:{id:"en_grammar_pronouns",label:"Pronoms",subject:"en",theme:"Grammaire",order:110},en_grammar_present_simple:{id:"en_grammar_present_simple",label:"Present simple",subject:"en",theme:"Grammaire",order:120},en_grammar_present_continuous:{id:"en_grammar_present_continuous",label:"Present continuous",subject:"en",theme:"Grammaire",order:130},en_grammar_past_simple:{id:"en_grammar_past_simple",label:"Past simple",subject:"en",theme:"Grammaire",order:140},en_grammar_future:{id:"en_grammar_future",label:"Future (will / be going to)",subject:"en",theme:"Grammaire",order:150},en_comprehension_short_text:{id:"en_comprehension_short_text",label:"Comprhension de texte court",subject:"en",theme:"Comprhension",order:210},en_comprehension_inference:{id:"en_comprehension_inference",label:"Infrences (anglais)",subject:"en",theme:"Comprhension",order:220},es_vocab_daily_life:{id:"es_vocab_daily_life",label:"Vocabulaire du quotidien",subject:"es",theme:"Vocabulaire",order:10},es_vocab_school:{id:"es_vocab_school",label:"Vocabulaire de lcole",subject:"es",theme:"Vocabulaire",order:20},es_grammar_pronouns:{id:"es_grammar_pronouns",label:"Pronoms",subject:"es",theme:"Grammaire",order:110},es_grammar_present:{id:"es_grammar_present",label:"Prsent de lindicatif",subject:"es",theme:"Grammaire",order:120},es_grammar_past:{id:"es_grammar_past",label:"Pass (bases)",subject:"es",theme:"Grammaire",order:130},es_comprehension_short_text:{id:"es_comprehension_short_text",label:"Comprhension de texte court",subject:"es",theme:"Comprhension",order:210},hist_methodes_chronologie:{id:"hist_methodes_chronologie",label:"Chronologie",description:"Situer et ordonner des vnements.",subject:"hist",theme:"Mthodes",order:10},hist_methodes_documents:{id:"hist_methodes_documents",label:"Lire un document",description:"Identifier nature, auteur, contexte, intention.",subject:"hist",theme:"Mthodes",order:20},hist_geo_cartes:{id:"hist_geo_cartes",label:"Lire une carte",description:"Lgende, chelle, orientation.",subject:"hist",theme:"Gographie",order:110},hist_geo_paysages:{id:"hist_geo_paysages",label:"tudier un paysage",subject:"hist",theme:"Gographie",order:120},hist_reperes_ancien_regime:{id:"hist_reperes_ancien_regime",label:"Repres historiques (bases)",description:"Placer quelques priodes/sicles.",subject:"hist",theme:"Repres",order:210},hist_reperes_moyen_age:{id:"hist_reperes_moyen_age",label:"Moyen ge (repres)",subject:"hist",theme:"Repres",order:220},hist_reperes_islam_moyen_age:{id:"hist_reperes_islam_moyen_age",label:"Islam mdival (repres)",subject:"hist",theme:"Repres",order:230},hist_reperes_renaissance:{id:"hist_reperes_renaissance",label:"Renaissance (repres)",subject:"hist",theme:"Repres",order:240},meta_transfert:{id:"meta_transfert",label:"Transfert de mthode",description:"Rutiliser une stratgie dans un autre contexte.",subject:"fr",theme:"Mthode",order:900}},rP={fr_comprehension_inference:{blockName:"Bloc Dduction",icon:""},math_fractions_addition:{blockName:"Bloc Somme",icon:""}};function sP(n){const e=Td(n),t=`Bloc ${e.label}`;return{tagId:n,blockName:t,biomeId:Ho(e.subject),icon:"",theme:e.theme}}function qi(n){const e=sP(n),t=rP[n];return{...e,...t||{}}}function em(n){return Object.keys(X0).map(e=>qi(e)).filter(e=>e.biomeId===n).sort((e,t)=>{const s=e.theme.localeCompare(t.theme);return s!==0?s:e.blockName.localeCompare(t.blockName)})}const iP="mine",sv={discovering:[1,2],progressing:[1,2,3],mastered:[2,3,4]};function Id(n,e){const t=[...e].filter(o=>o.tagIds?.includes(n)).sort((o,l)=>(l.ts||0)-(o.ts||0)).slice(0,10);if(t.filter(o=>!o.correct).length>=4)return!0;for(let o=0;o<t.length-1;o++)if(!t[o].correct&&!t[o+1].correct)return!0;return!1}function oP(n,e,t,s){const o=n.tags||n.tagIds||[],l=n.id||n.questionId;let u=0;const h=Date.now(),p=s.filter(j=>j.questionId===l).sort((j,O)=>(O.ts||0)-(j.ts||0)),y=p.length,w=p[0]?.ts;o.includes(e.targetTagId)&&(u+=100),(e.secondaryTagIds||[]).some(j=>o.includes(j))&&(u+=30),y||(u+=20),y>0&&y<3&&(u+=10);const T=p.filter(j=>!j.correct),C=h-1800*1e3;T.some(j=>(j.ts||0)<C)&&(u+=15),[...s].sort((j,O)=>(O.ts||0)-(j.ts||0)).slice(0,10).some(j=>j.questionId===l)&&(u-=50);const $=h-1440*60*1e3;return w&&w>$&&(u-=20),t==="repair"&&o.includes(e.targetTagId)&&T.length&&(u+=25),u}function aP(n,e){const t=new Set(e);return n.filter(s=>{const o=typeof s.difficulty=="number"?s.difficulty:1;return t.has(o)||t.has(4)&&o===3})}function lP(n,e){if(!Array.isArray(n)||n.length===0)return[];const t=e.masteryByTag?.[e.targetTagId]?.state||"discovering",s=sv[t]||sv.discovering,o=e.expedition||iP,l=Id(e.targetTagId,e.history||[]),u=o==="mine"&&l?"repair":o,h=aP(n,s);if(!h.length)return[];const p={};h.forEach(X=>{const q=X.id||X.questionId;p[q]=X});const w=Object.values(p).map(X=>({question:X,score:oP(X,e,u,e.history||[])})).sort((X,q)=>q.score-X.score),T=w.filter(({question:X})=>(X.tags||X.tagIds||[]).includes(e.targetTagId)),C=new Set(e.secondaryTagIds||[]),k=w.filter(({question:X})=>(X.tags||X.tagIds||[]).some(q=>C.has(q))),$=w.filter(({question:X})=>{const q=X.tags||X.tagIds||[];return!q.includes(e.targetTagId)&&!q.some(M=>C.has(M))}),j=(X,q,M)=>{const H=[];for(const I of X){const S=I.question.id||I.question.questionId;if(!M.has(S)&&(H.push(I.question),M.add(S),H.length>=q))break}return H},O=Math.max(1,e.desiredCount),Z=new Set;let G=[];if(u==="craft"){const X=w.filter(({question:I})=>{const S=I.tags||I.tagIds||[];return S.includes(e.targetTagId)&&S.some(R=>C.has(R))}),q=[];let M=0;for(;q.length<O&&M<Math.max(T.length,k.length);)T[M]&&q.push(T[M]),k[M]&&q.push(k[M]),M++;const H=[...X,...q,...w];for(const I of H){const S=I.question.id||I.question.questionId;if(!Z.has(S)&&(G.push(I.question),Z.add(S),G.length>=O))break}}else{const X=u==="repair"?Math.max(1,Math.round(O*.9)):Math.max(1,Math.round(O*.8));G=[...j(T,X,Z),...j($,O-X,Z)],G.length<O&&(G=[...G,...j(w,O-G.length,Z)])}return G.slice(0,O)}const Iu=["math_fractions_addition","math_fractions_soustraction","math_fractions_equivalentes","fr_grammaire_phrase_simple_complexe","fr_grammaire_proposition_relative","fr_grammaire_negation","fr_conjugaison_present","fr_comprehension_inference","fr_comprehension_idee_principale"];function Qu(n){try{const t=new Date(n),s=new Intl.DateTimeFormat("fr-FR",{timeZone:"Europe/Paris",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(t),o=s.find(h=>h.type==="year")?.value,l=s.find(h=>h.type==="month")?.value,u=s.find(h=>h.type==="day")?.value;if(o&&l&&u)return`${o}-${l}-${u}`}catch{}const e=new Date(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function cP(n,e){let t=0;return n.forEach(s=>{s.tagIds?.includes(e)&&(t=Math.max(t,s.ts||0))}),t}function uP(n,e){let t=0;return n.forEach(s=>{s.tagIds?.includes(e)&&!s.correct&&(t=Math.max(t,s.ts||0))}),t}function du(n,e){const t=n.map(u=>({item:u,w:Math.max(0,e(u))})),s=t.reduce((u,h)=>u+h.w,0);if(!s)return n[0]||null;const o=Math.random()*s;let l=0;for(const u of t)if(l+=u.w,o<=l)return u.item;return t[0]?.item||null}function Su(n){const{npcId:e,masteryByTag:t,history:s,nowTs:o,excludeTagIds:l=[],availableTagIds:u}=n;Qu(o);const h=Object.keys(t||{}),p=new Set([...h,...s.flatMap(M=>M.tagIds||[]),...Iu].filter(M=>!l.includes(M))),y=Array.from(p).filter(M=>!u||u.includes(M));if(!y.length)return null;const w=y.filter(M=>Id(M,s));if(w.length){const M=du(w,H=>{const I=Iu.includes(H)?5:1,S=Math.max(1,(o-uP(s,H))/(1440*60*1e3));return I+2/S});if(M){const H=qi(M).biomeId||Ho(Ui(M));return{npcId:e,title:`Mission de ${Wo[e].name}`,message:uu({npcId:e,reason:"repair"}),reasonCode:"repair",expedition:{type:"repair",biomeId:H,targetTagId:M,estimatedMinutes:10}}}}const T=Iu.filter(M=>!l.includes(M)&&(t[M]?.state||"discovering")!=="mastered"),C=y.filter(M=>(t[M]?.state||"discovering")==="discovering"),k=T.length?du(T,M=>t[M]?.state==="discovering"?3:1):C.length?du(C,()=>1):null;if(k){const M=qi(k).biomeId||Ho(Ui(k));return{npcId:e,title:`Mission de ${Wo[e].name}`,message:uu({npcId:e,reason:"priority"}),reasonCode:"priority",expedition:{type:"mine",biomeId:M,targetTagId:k,estimatedMinutes:10}}}const $=7200*60*1e3,j=y.map(M=>({tag:M,last:cP(s,M)})).filter(M=>M.last>0&&o-M.last>$).sort((M,H)=>M.last-H.last),O=j.length?du(j,M=>{const H=Math.max(1,(o-M.last)/864e5),I=(t[M.tag]?.state||"discovering")!=="mastered"?2:1;return H*I}):null;if(O){const M=qi(O.tag).biomeId||Ho(Ui(O.tag));return{npcId:e,title:`Mission de ${Wo[e].name}`,message:uu({npcId:e,reason:"spaced"}),reasonCode:"spaced",expedition:{type:"mine",biomeId:M,targetTagId:O.tag,estimatedMinutes:8}}}const Z=y.filter(M=>{const H=t[M]?.state||"discovering";return H==="progressing"||H==="mastered"}),G=new Map;Z.forEach(M=>{const H=Ui(M);G.set(H,[...G.get(H)||[],M])});const X=[];for(const[,M]of G)M.length>=2&&X.push(M.slice(0,2));let q=X.length?X[Math.floor(Math.random()*X.length)]:null;if(q){const M=qi(q[0]).biomeId||Ho(Ui(q[0]));return{npcId:e,title:`Mission de ${Wo[e].name}`,message:uu({npcId:e,reason:"craft"}),reasonCode:"craft",expedition:{type:"craft",biomeId:M,targetTagId:q[0],secondaryTagIds:[q[1]],estimatedMinutes:13}}}return null}const Y0="malocraft.npc.preferredId";function dP(){if(typeof localStorage>"u")return"scout";const n=localStorage.getItem(Y0);return n==="robot"||n==="goblin"||n==="scout"?n:"scout"}function Z0(n){typeof localStorage>"u"||localStorage.setItem(Y0,n)}function tm(n){return`malocraft.npc.daily.${n}`}function eE(n){return`malocraft.npc.dailyReroll.${n}`}function tE(n){return typeof localStorage>"u"?!1:localStorage.getItem(eE(n))==="1"}function hP(n){typeof localStorage>"u"||localStorage.setItem(eE(n),"1")}function nE(n){if(typeof localStorage>"u")return null;try{const e=localStorage.getItem(tm(n));return e?JSON.parse(e):null}catch{return null}}function ff(n){typeof localStorage>"u"||localStorage.removeItem(tm(n))}function Au(n,e){typeof localStorage>"u"||localStorage.setItem(tm(n),JSON.stringify(e))}function fP(n){const e=Qu(n.nowTs),t=nE(e);if(t)return t;const s=Su(n);return s&&Au(e,s),s}function pP({open:n,onClose:e,onPicked:t}){return n?v.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999},children:v.jsxs("div",{className:"card mc-card",style:{maxWidth:600,width:"92%",maxHeight:"90vh",overflowY:"auto"},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[v.jsx("h3",{className:"mc-title",children:"Choisis ton guide"}),v.jsx("button",{className:"mc-button secondary",onClick:e,children:"Fermer"})]}),v.jsx("div",{className:"grid2",children:Object.values(Wo).map(s=>v.jsxs("div",{className:"mc-card",style:{border:"2px solid var(--mc-border)"},children:[v.jsxs("div",{className:"row",style:{alignItems:"center",gap:10},children:[v.jsx("div",{style:{fontSize:"2rem"},children:s.avatar}),v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:900},children:s.name}),v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:s.shortTagline})]})]}),v.jsx("button",{className:"mc-button",style:{marginTop:10,width:"100%"},onClick:()=>{Z0(s.id),t?.(s.id),e()},children:"Choisir"})]},s.id))})]})}):null}const mP={mine:" Miner",repair:" Rparer",craft:" Crafter"};function gP({recommendation:n,dateKey:e,onStart:t,onReroll:s,onChangeNpc:o}){const l=Wo[n.npcId],u=tE(e),h=qi(n.expedition.targetTagId),p=(n.expedition.secondaryTagIds||[]).map(y=>qi(y).blockName);return v.jsxs("div",{className:"card mc-card",children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",gap:10},children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[v.jsx("div",{style:{fontSize:"2rem"},children:l.avatar}),v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:900},children:l.name}),v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:l.shortTagline})]})]}),v.jsx("button",{className:"mc-button secondary",onClick:o,children:"Changer de guide"})]}),v.jsxs("div",{style:{marginTop:10},children:[v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:n.title}),v.jsx("div",{style:{fontWeight:800,marginTop:4},children:n.message})]}),v.jsxs("div",{className:"mc-card",style:{marginTop:12,border:"2px solid var(--mc-border)"},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:800},children:mP[n.expedition.type]}),v.jsxs("div",{className:"small",style:{color:"var(--mc-muted)"},children:["Bloc : ",h.blockName,p.length?` + ${p.join(", ")}`:""]})]}),v.jsxs("div",{className:"mc-chip",children:[n.expedition.estimatedMinutes," min"]})]}),v.jsxs("div",{className:"row",style:{gap:8,marginTop:10,flexWrap:"wrap"},children:[v.jsx("button",{className:"mc-button",onClick:t,children:"Lancer la mission"}),v.jsx("button",{className:"mc-button secondary",onClick:s,disabled:u,children:"Changer de mission"})]})]})]})}function yP(){const{user:n}=zn(),{rewards:e}=ci(n?.uid||null),t=ii(),[s,o]=de.useState(!1),[l,u]=de.useState(dP()),[h,p]=de.useState(null),[y,w]=de.useState([]),[T,C]=de.useState([]),[k,$]=de.useState([]),[j,O]=de.useState(""),Z=de.useMemo(()=>{const M=[...T].sort((I,S)=>(S.dateKey||"").localeCompare(I.dateKey||""));let H=0;for(const I of M)if((I.sessions||0)>0)H+=1;else break;return H},[T]),G=Qu(Date.now()),X=()=>{if(tE(G)){O("Tu as dj chang de mission aujourdhui.");return}const M=e?.masteryByTag||{},H=[],I=h?.expedition.targetTagId,S={...M};I&&delete S[I];const R=Su({npcId:l,masteryByTag:S,history:H,nowTs:Date.now(),excludeTagIds:I?[I]:[],availableTagIds:k});R?(p(R),Au(G,R),hP(G),O("")):O("Aucune autre mission disponible pour linstant.")},q=()=>{if(!h)return;if(k.length&&!k.includes(h.expedition.targetTagId)){O("Mission indisponible (aucune question pour ce bloc). Change de mission.");return}const M=h.expedition,H=new URLSearchParams;H.set("expeditionType",M.type),H.set("targetTagId",M.targetTagId),H.set("biomeId",M.biomeId),M.secondaryTagIds?.length&&H.set("secondaryTagIds",M.secondaryTagIds.join(",")),t(`/theme/expedition?${H.toString()}`)};return de.useEffect(()=>{n&&(async()=>{try{const M=await zb(n.uid);w(M)}catch(M){console.error("stats/inventory failed",M)}try{const M=await Qb(n.uid);C(M)}catch(M){console.warn("days stats indisponibles",M)}})()},[n]),de.useEffect(()=>{(async()=>{const H=Array.from(new Set([...Iu,...Object.keys(e?.masteryByTag||{}).slice(0,20)])),I=await Promise.all(H.map(async S=>{try{return(await Jp(S,{uid:n?.uid})).length?S:null}catch{return null}}));$(I.filter(Boolean))})()},[e,n]),de.useEffect(()=>{const M=Qu(Date.now()),H=e?.masteryByTag||{},I=[],S=nE(M);let R=S&&S.npcId===l?S:null;R&&k.length&&!k.includes(R.expedition.targetTagId)&&(R=null,ff(M)),R||(ff(M),R=fP({npcId:l,masteryByTag:H,history:I,nowTs:Date.now(),availableTagIds:k.length?k:void 0})),R||(R=Su({npcId:l,masteryByTag:H,history:I,nowTs:Date.now(),availableTagIds:k}),R&&Au(M,R)),p(R),!R&&k.length===0?O("Pas de mission disponible (aucun exercice trouv)."):O("")},[l,e,k]),v.jsxs("div",{className:"container grid",children:[v.jsxs("div",{className:"card",children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between"},children:[v.jsxs("div",{children:[v.jsx("h2",{style:{margin:0},children:"Salut Malo "}),v.jsx("div",{className:"small",children:"Pars sur la carte du monde, choisis un biome et progresse bloc par bloc."}),v.jsxs("div",{className:"small",style:{marginTop:6},children:["Niveau ",e.level||1,"  XP ",e.xp||0]}),(e.badges||[]).length?v.jsx("div",{className:"row",style:{marginTop:6,gap:6},children:e.badges?.map(M=>{const H=rv.find(I=>I.id===M);return v.jsxs("span",{className:"pill",style:{padding:"4px 8px",border:"1px solid rgba(255,255,255,0.2)"},children:[H?.icon||""," ",H?.title||M]},M)})}):null]}),Z>0&&v.jsxs("div",{className:"pill",style:{alignSelf:"flex-start"},children:[" Streak ",Z," j"]})]}),j&&v.jsx("div",{className:"small",style:{marginTop:8,color:"#ffb347"},children:j})]}),h&&v.jsx(gP,{recommendation:h,dateKey:G,onStart:q,onReroll:X,onChangeNpc:()=>o(!0)}),v.jsx("div",{className:"grid2",children:Q0.map(M=>{const H=em(M.id),I=H.filter(V=>e.masteryByTag?.[V.tagId]?.state==="mastered").length,S=H.length,R=S>0?Math.round(I/S*100):0;return v.jsxs("div",{className:"card mc-card world-card",children:[v.jsxs("div",{className:"row",style:{alignItems:"center",gap:10},children:[v.jsx("div",{style:{fontSize:"1.6rem"},children:M.icon}),v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:800},children:M.name}),v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:M.description})]}),v.jsxs("div",{className:"mc-chip",children:[R,"%"]})]}),v.jsx("button",{className:"mc-button secondary",style:{marginTop:10},onClick:()=>t(`/world/${M.id}`),children:"Ouvrir le biome"})]},M.id)})}),y.length?v.jsxs("div",{className:"card",children:[v.jsx("h3",{style:{marginTop:0},children:"Inventaire"}),v.jsx("div",{className:"row",children:y.map(M=>v.jsx("span",{className:"badge",children:M.title||M.id},M.id))})]}):null,v.jsxs("div",{className:"card",children:[v.jsx("h3",{style:{marginTop:0},children:"Badges"}),v.jsx("div",{className:"grid2",children:rv.map(M=>{const H=(e.badges||[]).includes(M.id);return v.jsxs("div",{className:"pill",style:{opacity:H?1:.35,borderColor:H?"rgba(122,162,255,0.6)":"rgba(255,255,255,0.18)",display:"flex",flexDirection:"column",gap:4},children:[v.jsxs("div",{style:{fontWeight:700},children:[M.icon," ",M.title]}),v.jsx("div",{className:"small",children:M.description})]},M.id)})})]}),v.jsx(pP,{open:s,onClose:()=>o(!1),onPicked:M=>{u(M),Z0(M);const H=e?.masteryByTag||{},S=Su({npcId:M,masteryByTag:H,history:[],nowTs:Date.now(),availableTagIds:k});S?(Au(G,S),p(S)):(ff(G),p(null))}})]})}function _P(){const{user:n,signInGoogle:e}=zn(),t=ii();return de.useEffect(()=>{n&&t("/")},[n]),v.jsx("div",{className:"container",children:v.jsxs("div",{className:"card",children:[v.jsx("h2",{style:{marginTop:0},children:"Connexion"}),v.jsx("p",{className:"small",children:"Connexion Google recommande (simple sur tablette Android)."}),v.jsx("button",{className:"btn",onClick:e,children:"Se connecter avec Google"}),v.jsx("hr",{}),v.jsxs("p",{className:"small",children:["Astuce : aprs ta premire connexion (toi), va dans Firestore et mets ",v.jsxs("code",{children:["users/","{uid}",".role"]}),'  "parent".']})]})})}function vP(n,e){return n.type==="mcq"?e===n.answerIndex:n.type==="short_text"||n.type==="fill_blank"?n.expected.includes(ia(e||"")):!1}function wP(n,e){return n===1?e?3:-1:n===2?e?5:-2:e?7:-3}function EP(n){return Math.max(0,Math.min(100,n))}function TP(n){return n>=80?"mastered":n>=60?"nearly":n>=30?"developing":"weak"}function rE(n){return n.toISOString().slice(0,10)}function IP(n,e){const t=new Date(n+"T00:00:00");return t.setDate(t.getDate()+e),rE(t)}function SP(n,e,t){const s=Math.max(0,Math.min(100,n));let o=1;return s>=81||e==="mastered"?o=10:s>=61||e==="nearly"?o=4:s>=31||e==="developing"?o=2:o=1,IP(t,o)}async function AP(n){const{uid:e,subjectId:t,themeId:s,answers:o,exercises:l,durationSec:u}=n,p=rE(new Date),y=Me(gt(le,"users",e,"attempts")),w=gt(le,"users",e,"attemptItems"),T=Me(le,"users",e,"progressSummary","main"),C=l.map((ge,Ue)=>{const Ke=vP(ge,o[ge.id]);return{exerciseId:ge.id,subjectId:t,themeId:s,difficulty:ge.difficulty,tags:ge.tags?.slice(0,3)||[],correct:Ke,index:Ue,prompt:ge.prompt,choices:Array.isArray(ge.choices)?ge.choices:null,readingContext:ge.readingContext||null}}),k=C.filter(ge=>ge.correct).length,$=C.length,j=new Map;C.forEach(ge=>{const Ue=wP(ge.difficulty,ge.correct);ge.tags.forEach(Ke=>{const xe=j.get(Ke)||{delta:0,correct:0,wrong:0,results:[]};xe.delta+=Ue,xe.correct+=ge.correct?1:0,xe.wrong+=ge.correct?0:1,xe.results.push(ge.correct),j.set(Ke,xe)})});const O=Array.from(j.keys()),Z=await Promise.all(O.map(ge=>Dr(Me(le,"users",e,"tagProgress",ge)))),G=Qp(le),X={subjectId:t,themeId:s,score:k,outOf:$,durationSec:u,itemsCount:C.length,date:p,createdAt:Ye()};G.set(y,X),C.forEach(ge=>{const Ue=Me(w);G.set(Ue,{...ge,createdAt:Ye(),answer:o[ge.exerciseId]??null})});const q={weak:0,developing:0,nearly:0,mastered:0},M={};O.forEach((ge,Ue)=>{const Ke=Z[Ue],xe=Ke.exists()?Ke.data():null,re=j.get(ge),ae=[...Array.isArray(xe?.last7Results)?xe.last7Results:[],...re.results].slice(-7),D={correct:ae.filter(lt=>lt).length,wrong:ae.filter(lt=>!lt).length};let Q=xe?.streakCorrect||0,fe=xe?.streakWrong||0;re.results.forEach(lt=>{lt?(Q+=1,fe=0):(fe+=1,Q=0)});const we=typeof xe?.mastery=="number"?xe.mastery:0,Te=EP(we+re.delta),pe=TP(Te),Ve=xe?.bucket;Ve&&(q[Ve]-=1),q[pe]+=1;const ke=SP(Te,pe,p),Le=Me(le,"users",e,"tagProgress",ge),Pe={tagId:ge,mastery:Te,bucket:pe,attempts:(xe?.attempts||0)+re.results.length,correctAnswers:(xe?.correctAnswers||0)+re.correct,wrongAnswers:(xe?.wrongAnswers||0)+re.wrong,last7Results:ae,last7:D,lastSeenAt:Ye(),lastCorrectAt:re.correct>0?Ye():xe?.lastCorrectAt||null,streakCorrect:Q,streakWrong:fe,lastDelta:re.delta,nextDueDate:ke,updatedAt:Ye()};M[ge]=Pe,G.set(Le,Pe,{merge:!0})});const H=await Dr(T),I=H.exists()?H.data():null,S=I?.masteryBuckets||{weak:0,developing:0,nearly:0,mastered:0},R={weak:(S.weak||0)+q.weak,developing:(S.developing||0)+q.developing,nearly:(S.nearly||0)+q.nearly,mastered:(S.mastered||0)+q.mastered},V=Object.values(M).sort((ge,Ue)=>ge.mastery-Ue.mastery).map(ge=>ge.tagId),N=Array.isArray(I?.topWeakTags)?I.topWeakTags:[],P=Array.from(new Set([...V,...N])).slice(0,3),x={totalAnswers:(I?.totalAnswers||0)+$,correctAnswers:(I?.correctAnswers||0)+k,totalAttempts:(I?.totalAttempts||0)+1,masteryBuckets:R,lastAttemptId:y.id,lastDate:p,updatedAt:Ye(),topWeakTags:P};return G.set(T,x,{merge:!0}),await G.commit(),{attemptId:y.id,score:k,outOf:$,summary:x,tagsUpdated:M}}function CP(n){const e=[];return Array.isArray(n.exercises)&&e.push(...n.exercises),Array.isArray(n.readings)&&n.readings.forEach(t=>{Array.isArray(t.questions)&&t.questions.forEach(s=>{e.push({...s,readingContext:{readingId:t.id,title:t.title,text:t.text}})})}),e}async function RP(n){const e=Me(le,"users",n,"meta","rewards"),t=await Dr(e);if(t.exists()){const o=t.data();return{xp:o.xp||0,level:o.level||1,badges:Array.isArray(o.badges)?o.badges:[],masteryByTag:typeof o.masteryByTag=="object"&&o.masteryByTag?o.masteryByTag:{},collectibles:o.collectibles&&Array.isArray(o.collectibles.owned)?{owned:o.collectibles.owned,equippedAvatarId:o.collectibles.equippedAvatarId??null}:{owned:[],equippedAvatarId:null},malocraft:o.malocraft&&Array.isArray(o.malocraft.ownedLootIds)?{ownedLootIds:o.malocraft.ownedLootIds,equippedAvatarId:o.malocraft.equippedAvatarId??null,biomeMilestones:o.malocraft.biomeMilestones||{}}:{ownedLootIds:[],equippedAvatarId:null,biomeMilestones:{}},updatedAt:o.updatedAt}}const s={xp:0,level:1,badges:[],masteryByTag:{},collectibles:{owned:[],equippedAvatarId:null},malocraft:{ownedLootIds:[],equippedAvatarId:null,biomeMilestones:{}},updatedAt:Ye()};return await ls(e,s),s}async function xP(n,e,t){if(t<=0)return await RP(n);const s=Me(le,"users",n,"meta","rewards"),o=e?Me(le,"users",n,"rewardEvents",e):null;let l=null;return await li(le,async u=>{const[h,p]=await Promise.all([o?u.get(o):Promise.resolve(null),u.get(s)]);if(o&&h&&h.exists()){l=p.exists()?p.data():{xp:0,level:1};return}const y=p.exists()?p.data():null,w={xp:y?.xp||0,level:y?.level||1,badges:Array.isArray(y?.badges)?y.badges:[],masteryByTag:typeof y?.masteryByTag=="object"&&y?.masteryByTag?y.masteryByTag:{},collectibles:y?.collectibles&&Array.isArray(y.collectibles.owned)?{owned:y.collectibles.owned,equippedAvatarId:y.collectibles.equippedAvatarId??null}:{owned:[],equippedAvatarId:null},malocraft:y?.malocraft&&Array.isArray(y.malocraft.ownedLootIds)?{ownedLootIds:y.malocraft.ownedLootIds,equippedAvatarId:y.malocraft.equippedAvatarId??null,biomeMilestones:y.malocraft.biomeMilestones||{}}:{},updatedAt:y?.updatedAt},T=Math.max(0,(w.xp||0)+t),C=bl(T),k={xp:T,level:C.level,badges:w.badges||[],masteryByTag:w.masteryByTag||{},collectibles:{owned:w.collectibles?.owned||[],equippedAvatarId:w.collectibles?.equippedAvatarId??null},updatedAt:Ye()};u.set(s,k,{merge:!0}),o&&u.set(o,{sessionId:e,deltaXp:t,awardedAt:Ye()}),l=k}),l||{xp:0,level:1}}async function bP(n){const{uid:e,sessionId:t,items:s}=n,o=Me(le,"users",e,"meta","rewards");await li(le,async l=>{const u=await l.get(o),h=u.exists()?u.data():null,p={xp:h?.xp||0,level:h?.level||1,badges:Array.isArray(h?.badges)?h.badges:[],masteryByTag:typeof h?.masteryByTag=="object"&&h?.masteryByTag?h.masteryByTag:{},updatedAt:h?.updatedAt},y=Ye(),w=s.map(k=>({item:k,evRef:Me(le,"users",e,"rewardEvents",`${t}_${k.exerciseId}`)})),T=await Promise.all(w.map(k=>l.get(k.evRef)));let C=p.masteryByTag||{};w.forEach((k,$)=>{if(T[$].exists())return;const O=Array.isArray(k.item.tags)?k.item.tags:[];C=W0({masteryByTag:C,questionTags:O,isCorrect:k.item.correct,timestamp:y})}),w.forEach((k,$)=>{if(T[$].exists())return;const O=Array.isArray(k.item.tags)?k.item.tags:[];l.set(k.evRef,{sessionId:t,exerciseId:k.item.exerciseId,correct:k.item.correct,tags:O,createdAt:y})}),l.set(o,{...p,masteryByTag:C,updatedAt:Ye()},{merge:!0})})}async function PP(n){const{uid:e,rewards:t}=n,s=[],o=Array.isArray(t.badges)?t.badges:[],l=await Dr(Me(le,"users",e,"stats","main")),u=await Dr(Me(le,"users",e,"progressSummary","main")),h=l.exists()?l.data():{},p=u.exists()?u.data():{},y=h.streakDays||0,w=p.totalAttempts||0,T=t.masteryByTag||{},C=Object.entries(T).filter(([,G])=>G?.state==="mastered").map(([G])=>G),$=(await jt(Bn(gt(le,"users",e,"rewardEvents"),rr("correct","==",!1),Gp(5)))).size,j=G=>o.includes(G)||s.includes(G);!j("streak_3")&&y>=3&&s.push("streak_3"),!j("streak_7")&&y>=7&&s.push("streak_7"),!j("sessions_10")&&w>=10&&s.push("sessions_10"),!j("retry_5")&&$>=5&&s.push("retry_5");const O=C.length;if(!j("tag_master_3")&&O>=3&&s.push("tag_master_3"),!j("tag_master_10")&&O>=10&&s.push("tag_master_10"),!j("fractions_first_mastery")&&C.some(G=>G.startsWith("math_fractions"))&&s.push("fractions_first_mastery"),!j("grammar_first_mastery")&&C.some(G=>G.startsWith("fr_grammaire"))&&s.push("grammar_first_mastery"),!s.length)return[];const Z=Me(le,"users",e,"meta","rewards");return await li(le,async G=>{const X=await G.get(Z),q=X.exists()?X.data():{},M=Array.isArray(q.badges)?q.badges:[],H=s.filter(I=>!M.includes(I));H.length&&(G.set(Z,{badges:[...M,...H],updatedAt:Ye()},{merge:!0}),H.forEach(I=>{G.set(Me(le,"users",e,"rewardEvents",`badge_${I}`),{type:"badge",badgeId:I,createdAt:Ye()})}))}),s}function kP({rewards:n}){const{xp:e,level:t}=n||{xp:0,level:1},s=bl(e||0),o=Math.min(100,Math.max(0,Math.round(s.xpIntoLevel/s.xpForNext*100)));return v.jsxs("div",{className:"card",style:{display:"flex",flexDirection:"column",gap:6},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[v.jsxs("div",{style:{fontWeight:800,fontSize:"1.05rem"},children:["Niveau ",s.level]}),v.jsxs("div",{className:"small",children:["XP total : ",e||0]})]}),v.jsxs("div",{className:"small",children:["Prochain niveau : ",s.xpIntoLevel,"/",s.xpForNext," XP"]}),v.jsx("div",{style:{height:12,background:"rgba(255,255,255,0.08)",borderRadius:999,overflow:"hidden"},children:v.jsx("div",{style:{height:"100%",width:`${o}%`,background:"linear-gradient(90deg,#7aa2ff,#2ecc71)",transition:"width 0.6s ease"}})})]})}function NP(n){const{accuracy:e,weakestTag:t,improvedTag:s}=n,o=t||s||"ce tag";return e<50?`On avance : demain, on reprend ${o} avec 5 minutes de rvision.`:e<80?`Bien jou : encore un effort sur ${o} et a passe.`:`Super : tu matrises bien ${s||o}, on peut monter dun cran.`}const DP=[{rarity:"common",weight:.8},{rarity:"rare",weight:.18},{rarity:"epic",weight:.02}];function OP(n){const e=n();let t=0;for(const{rarity:s,weight:o}of DP)if(t+=o,e<=t)return s;return"common"}function VP(n=[],e={}){const t=e.rng||Math.random,s=new Set(n||[]);let o=null,l=0;for(;l<4&&o===null;){const h=OP(t),p=ri.filter(y=>y.rarity===h&&!s.has(y.id));if(p.length){o=p[Math.floor(t()*p.length)].id;break}l++}if(o)return o;const u=ri.filter(h=>h.rarity==="common"&&!s.has(h.id));return u.length?u[Math.floor((e.rng||Math.random)()*u.length)].id:null}const Pl=[{id:"sticker_foret_feuille",type:"sticker",rarity:"common",title:"Feuille de la Fort",description:"Un souvenir de la Fort de la Langue.",icon:"",biomeId:"biome_fr_foret_langue"},{id:"sticker_foret_ecorce",type:"sticker",rarity:"common",title:"corce runique",description:"Rune grave en franais.",icon:"",biomeId:"biome_fr_foret_langue"},{id:"sticker_mines_gemme",type:"sticker",rarity:"common",title:"Gemme des Mines",description:"Fragment mathmatique scintillant.",icon:"",biomeId:"biome_math_mines"},{id:"sticker_mines_pelle",type:"sticker",rarity:"common",title:"Pelle robuste",description:"Pour creuser des nombres.",icon:"",biomeId:"biome_math_mines"},{id:"sticker_en_drapeau",type:"sticker",rarity:"common",title:"Village Anglais",description:"Blason du village.",icon:"",biomeId:"biome_en_village"},{id:"sticker_en_thatch",type:"sticker",rarity:"common",title:"Chaumire cosy",description:"Toit de paille du village.",icon:"",biomeId:"biome_en_village"},{id:"sticker_es_guitarra",type:"sticker",rarity:"common",title:"Guitarra",description:"Cordes vibrantes dEspagne.",icon:"",biomeId:"biome_es_village"},{id:"sticker_es_fiesta",type:"sticker",rarity:"common",title:"Fiesta",description:"Confettis du village espagnol.",icon:"",biomeId:"biome_es_village"},{id:"sticker_hist_boussole",type:"sticker",rarity:"common",title:"Boussole des Plaines",description:"Toujours orient.",icon:"",biomeId:"biome_hist_plaines"},{id:"sticker_hist_parchemin",type:"sticker",rarity:"common",title:"Parchemin",description:"Repre historique cl.",icon:"",biomeId:"biome_hist_plaines"},{id:"sticker_meta_pickaxe",type:"sticker",rarity:"common",title:"Pioche Malo",description:"Outil fidle.",icon:""},{id:"sticker_meta_tocha",type:"sticker",rarity:"common",title:"Torche",description:"claire les donjons.",icon:""},{id:"sticker_meta_map",type:"sticker",rarity:"common",title:"Carte",description:"Toujours savoir o aller.",icon:""},{id:"sticker_meta_marteau",type:"sticker",rarity:"common",title:"Marteau",description:"Rparer les blocs fissurs.",icon:""},{id:"sticker_meta_sac",type:"sticker",rarity:"common",title:"Sac  dos",description:"Tout emporter.",icon:""},{id:"fragment_langue",type:"fragment",rarity:"rare",title:"Fragment Linguistique",description:"Augmente la brillance des blocs de langue.",icon:"",biomeId:"biome_fr_foret_langue"},{id:"fragment_math",type:"fragment",rarity:"rare",title:"Fragment Numrique",description:"Pure nergie mathmatique.",icon:"",biomeId:"biome_math_mines"},{id:"fragment_en",type:"fragment",rarity:"rare",title:"Fragment Anglais",description:"Accent parfait.",icon:"",biomeId:"biome_en_village"},{id:"fragment_es",type:"fragment",rarity:"rare",title:"Fragment Espagnol",description:"Rythme et couleur.",icon:"",biomeId:"biome_es_village"},{id:"fragment_hist",type:"fragment",rarity:"rare",title:"Fragment Chronique",description:"Temps et cartes fusionns.",icon:"",biomeId:"biome_hist_plaines"},{id:"fragment_meta_focus",type:"fragment",rarity:"rare",title:"Fragment de Focalisation",description:"Rend les sessions plus prcises.",icon:""},{id:"fragment_meta_vitesse",type:"fragment",rarity:"rare",title:"Fragment de Vitesse",description:"Acclre tes rponses.",icon:""},{id:"fragment_meta_chance",type:"fragment",rarity:"rare",title:"Fragment de Chance",description:"Boost de loot.",icon:""},{id:"trophy_foret_bronze",type:"trophy",rarity:"rare",title:"Trophe Fort Bronze",description:"3 blocs matriss en Fort.",icon:"",biomeId:"biome_fr_foret_langue"},{id:"trophy_foret_argent",type:"trophy",rarity:"rare",title:"Trophe Fort Argent",description:"6 blocs matriss en Fort.",icon:"",biomeId:"biome_fr_foret_langue"},{id:"trophy_foret_or",type:"trophy",rarity:"epic",title:"Trophe Fort Or",description:"10 blocs matriss en Fort.",icon:"",biomeId:"biome_fr_foret_langue"},{id:"trophy_mines_or",type:"trophy",rarity:"epic",title:"Trophe Mines Or",description:"10 blocs matriss dans les Mines.",icon:"",biomeId:"biome_math_mines"},{id:"trophy_plaines_or",type:"trophy",rarity:"epic",title:"Trophe Plaines Or",description:"10 blocs matriss dans les Plaines.",icon:"",biomeId:"biome_hist_plaines"},{id:"avatar_malo_explorateur",type:"avatar",rarity:"epic",title:"Malo Explorateur",description:"Hros des biomes.",icon:""},{id:"avatar_malo_mineur",type:"avatar",rarity:"epic",title:"Malo Mineur",description:"Spcialiste des nombres.",icon:""},{id:"avatar_malo_mage",type:"avatar",rarity:"epic",title:"Malo Mage",description:"Matrise magique.",icon:""},{id:"avatar_malo_architecte",type:"avatar",rarity:"epic",title:"Malo Architecte",description:"Btisseur de blocs.",icon:""}];function jP(n,e){let{common:t,rare:s,epic:o}=n;const l=e.correctRate??0;l>=.85&&(s+=5),l>=.9&&(o+=1),e.levelUp&&(s+=5,o+=2),e.expedition==="craft"&&(s+=4,o+=1);const u=t+s+o,h=Math.random()*u;return h<o?"epic":h<o+s?"rare":"common"}function MP(n){const e=jP({common:80,rare:18,epic:2},{correctRate:n.correctRate,levelUp:n.levelUp,expedition:n.expedition}),t=Pl.filter(u=>u.rarity===e);if(!t.length)return null;const s=t.filter(u=>!n.biomeId||!u.biomeId||u.biomeId===n.biomeId),o=s.length?s:t;let l=null;for(let u=0;u<3;u++){const h=o[Math.floor(Math.random()*o.length)];if(!n.owned.has(h.id)){l=h;break}}return l||(l=Pl.filter(h=>h.rarity==="common"&&(!n.biomeId||!h.biomeId||h.biomeId===n.biomeId)).filter(h=>!n.owned.has(h.id))[0]||o[0]),l}function LP(n,e){const t=n.masteryByTag||{};return Object.entries(t).filter(([,o])=>o?.state==="mastered").filter(([o])=>o.includes(e.split("_")[1]||"")).length}const FP=[3,6,10];function UP(n,e,t){let s=t||0;for(const l of FP)e>=l&&l>s&&(s=l);return s===t?null:Pl.find(l=>l.type==="trophy"&&l.biomeId===n&&l.title.includes(s>=10?"Or":s>=6?"Argent":"Bronze"))||null}async function BP(n){const{uid:e,sessionId:t,biomeId:s,sessionStats:o,expedition:l}=n,u=`malocraftLoot:${t}`,h=Me(le,"users",e,"meta","rewards"),p=Me(le,"users",e,"rewardEvents",u);let y=null;if(await li(le,async w=>{const[T,C]=await Promise.all([w.get(p),w.get(h)]);if(T.exists())return;const k=C.exists()?C.data():null,$={xp:k?.xp||0,level:k?.level||1,badges:k?.badges||[],masteryByTag:k?.masteryByTag||{},collectibles:k?.collectibles||{owned:[],equippedAvatarId:null},malocraft:k?.malocraft||{ownedLootIds:[],equippedAvatarId:null,biomeMilestones:{}},updatedAt:k?.updatedAt},j=new Set($.malocraft?.ownedLootIds||[]),O=LP($,s),Z=$.malocraft?.biomeMilestones?.[s]||0,G=UP(s,O,Z);if(G&&!j.has(G.id)){y=G,j.add(G.id),w.set(h,{malocraft:{ownedLootIds:Array.from(j),biomeMilestones:{...$.malocraft?.biomeMilestones||{},[s]:Math.max(Z,O)},equippedAvatarId:$.malocraft?.equippedAvatarId??null},updatedAt:Ye()},{merge:!0}),w.set(p,{type:"malocraft",sessionId:t,awardedId:G.id,milestone:!0,createdAt:Ye()});return}if(!((o.deltaXp||0)>=10||(o.correctRate||0)>=.5))return;const q=MP({owned:j,biomeId:s,correctRate:o.correctRate,levelUp:o.levelUp,expedition:l});if(!q)return;y=q,j.add(q.id);const M={...$.malocraft?.biomeMilestones||{}};w.set(h,{malocraft:{ownedLootIds:Array.from(j),biomeMilestones:M,equippedAvatarId:$.malocraft?.equippedAvatarId??null},collectibles:q.type==="avatar"?{owned:Array.from(new Set([...$.collectibles?.owned||[],q.id])),equippedAvatarId:$.collectibles?.equippedAvatarId??q.id}:$.collectibles||{owned:[],equippedAvatarId:null},updatedAt:Ye()},{merge:!0}),w.set(p,{type:"malocraft",sessionId:t,awardedId:q.id,milestone:!1,createdAt:Ye()})}),y&&y.type==="avatar")try{await Xp(n.uid,y.id,`collectible_${u}`)}catch{}return{awarded:y}}function iv(n,e){return n.type==="mcq"?e===n.answerIndex:n.type==="short_text"||n.type==="fill_blank"?n.expected.includes(ia(e||"")):!1}function hu(n){const e=[],t=/_([^_]+)_/g;let s=0,o,l=0;for(;(o=t.exec(n))!==null;)o.index>s&&e.push(n.slice(s,o.index)),e.push(v.jsx("span",{style:{textDecoration:"underline"},children:o[1]},`u-${l++}`)),s=t.lastIndex;return s<n.length&&e.push(n.slice(s)),e}function zP(){const{themeId:n}=gv(),{user:e}=zn(),{rewards:t}=ci(e?.uid||null),[s,o]=de.useState(null),[l,u]=de.useState([]),[h,p]=de.useState({}),[y]=de.useState(()=>Date.now()),[w,T]=de.useState(null),[C,k]=de.useState([]),[$,j]=de.useState(null),[O,Z]=de.useState("mine"),[G,X]=de.useState([]),[q,M]=de.useState(!1),[H,I]=de.useState(null),[S,R]=de.useState(null),[V,N]=de.useState(!1),P=ii(),[x,ge]=de.useState(""),[Ue,Ke]=de.useState(""),[xe]=SI(),[re,ve]=de.useState(!1);de.useEffect(()=>{(async()=>{if(!n||q||re)return;const D=xe.get("targetTagId")||xe.get("tagId"),Q=xe.get("expeditionType")||"mine";Z(Q);const fe=await Dr(Me(le,"themes",n)),we=fe.exists()?{id:n,...fe.data()}:null;let Te=await $0(n,{uid:e?.uid}),Ve=Array.isArray(we?.readings)?we.readings:[];if((!Te.length||!we)&&D)Te=await Jp(D,{uid:e?.uid}),Ve=[];else try{const Kt=await kb(n);Kt.length&&(Ve=Kt)}catch{}const ke=we||(D?{id:n,subjectId:Ui(D),title:"Expdition MaloCraft"}:null);o(ke);const Le=CP({exercises:Te,readings:Ve}),Pe=10,lt={};Le.forEach(Kt=>(Kt.tags||[]).forEach(Qt=>{lt[Qt]=(lt[Qt]||0)+1}));const cn=Object.entries(lt).sort((Kt,Qt)=>Qt[1]-Kt[1])[0]?.[0],Ht=D||cn;j(Ht||null);let Gt=Le;if(Ht){const Kt=t?.masteryByTag||{},Qt=[],qn=O==="mine"&&Id(Ht,Qt)?"repair":O;Gt=lP(Le,{expedition:qn,targetTagId:Ht,desiredCount:Pe,masteryByTag:Kt,history:Qt})}Gt.length||(Gt=[...Le].sort(()=>Math.random()-.5).slice(0,Pe)),u(Gt.slice(0,Pe)),p({}),T(null),X([]),M(!1)})()},[n,e,xe,t]);const ae=async()=>{if(!e||!n||!s)return;ve(!0),Ke("");const D=Math.max(1,Math.round((Date.now()-y)/1e3));try{const Q=l.map(Ie=>({exerciseId:Ie.id,difficulty:Ie.difficulty,tags:Ie.tags||[],correct:iv(Ie,h[Ie.id])})),fe=await AP({uid:e.uid,subjectId:s.subjectId,themeId:n,answers:h,exercises:l,durationSec:D}),we=await Bb({uid:e.uid,subjectId:s.subjectId,themeId:n,items:Q,durationSec:D,existingAttemptId:fe.attemptId,skipAttemptWrite:!0}),Te=l.reduce((Ie,Mt)=>{const We=h[Mt.id];return We==null||typeof We=="string"&&We.trim()===""?Ie:Ie+1},0),pe=t?.masteryByTag||{};let Ve=pe;Q.forEach(Ie=>{Ve=W0({masteryByTag:Ve,questionTags:Ie.tags||[],isCorrect:Ie.correct,timestamp:new Date})});const ke=Object.entries(Ve).filter(([Ie,Mt])=>Mt?.state==="mastered"&&pe?.[Ie]?.state!=="mastered").length,Le=$b({answeredCount:Te,isCompleted:!0}),Pe=t;let lt=null,cn=!1,Ht=[],Gt=null;try{const Ie=await xP(e.uid,fe.attemptId||null,Le);if(lt=Ie,cn=(Ie?.level||1)>(t?.level||1),await bP({uid:e.uid,sessionId:fe.attemptId||n,items:Q}),Ht=await PP({uid:e.uid,rewards:Ie||t})||[],Le>=20||cn||ke>0){const We=Ie?.collectibles?.owned||t?.collectibles?.owned||[];if(Gt=VP(We),Gt){const $n=fe.attemptId?`collectible_${fe.attemptId}`:void 0;await Xp(e.uid,Gt,$n)}}try{const We=Q.length?Q.filter(or=>or.correct).length/Q.length:0,$n=Q[0]?.tags?.[0]||$||"",_n=Ho(s.subjectId),Jt=await BP({uid:e.uid,sessionId:fe.attemptId||n,biomeId:_n,targetTagId:$n,expedition:O,sessionStats:{deltaXp:Le,correctRate:We,levelUp:cn}});Jt.awarded?.id&&R(Jt.awarded.id)}catch(We){console.warn("awardMalocraftLoot failed",We)}Gb({uid:e.uid,sessionId:fe.attemptId||n,answeredCount:Te,tagsUsed:Q.flatMap(We=>We.tags||[])}).catch(We=>console.error("updateDailyProgress failed",We)),Kb({uid:e.uid,sessionsDelta:1,xpDelta:Le}).catch(We=>console.error("upsertDayStat failed",We))}catch(Ie){console.error("awardSessionRewards failed",Ie)}I({deltaXp:Le,levelUp:cn,newRewards:lt,prevRewards:Pe,unlockedBadges:Ht,collectibleId:Gt});const Kt=new Set(l.flatMap(Ie=>Ie.tags||[])),Qt=Object.values(fe.tagsUpdated||{}).filter(Ie=>Ie&&Kt.has(Ie.tagId||"")).sort((Ie,Mt)=>(Ie.mastery??0)-(Mt.mastery??0)).slice(0,3).map(Ie=>Ie.tagId);k(Qt),T({score:we.score,outOf:we.outOf,durationSec:D,...we});const qn=Q.filter(Ie=>!Ie.correct).flatMap(Ie=>Ie.tags||[]),ir=new Map;Q.forEach(Ie=>{const Mt=Ie.correct?8:2;(Ie.tags||[]).forEach(We=>{ir.set(We,(ir.get(We)||0)+Mt)})});let ct;ir.size&&(ct=Array.from(ir.entries()).sort((Ie,Mt)=>Mt[1]-Ie[1])[0]?.[0]);const ut=we.outOf?we.score/we.outOf*100:0,yn=NP({accuracy:ut,weakestTag:qn[0]||C[0],improvedTag:ct}),ui=l.map((Ie,Mt)=>{const We=h[Ie.id],$n=iv(Ie,We);let _n="",Jt="";if(Ie.type==="mcq"){const or=Ie;_n=or.choices[or.answerIndex]||"",Jt=typeof We=="number"&&or.choices[We]||""}else(Ie.type==="short_text"||Ie.type==="fill_blank")&&(_n=Ie.expected[0]||"",Jt=We||"");return{id:Ie.id,prompt:Ie.prompt,correct:$n,expected:_n||"",userAnswer:(Jt??"").toString()||"",idx:Mt+1}});ge(yn),X(ui),M(!0),N(!0)}catch(Q){console.error("submit session failed",Q),Ke(Q?.message||"Enregistrement impossible. Vrifie la connexion ou les droits.")}ve(!1)};if(!n)return v.jsx("div",{className:"container",children:v.jsx("div",{className:"card",children:"Thme introuvable."})});if(q&&G.length){const D=H?.prevRewards?.xp??t?.xp??0,Q=H?.newRewards?.xp??D,fe=D,we=Q;H?.deltaXp;const Te=w?(()=>{const Pe=w.outOf?w.score/w.outOf*100:0;return Pe>=80?"Super ! Continue comme a.":Pe>=50?"Bien jou ! On consolide et a va monter.":"Bien essay. On progresse en sentranant."})():"",pe=H?.collectibleId?ri.find(Pe=>Pe.id===H?.collectibleId):null,Ve=pe?.rarity==="epic"?"pique":pe?.rarity==="rare"?"Rare":"Commun",ke=S?Pl.find(Pe=>Pe.id===S):null,Le=async()=>{if(!(!e||!pe||pe.type!=="avatar")){try{await Yp(e.uid,pe.id)}catch(Pe){console.error("equipAvatar failed",Pe)}N(!1)}};return v.jsxs("div",{className:"container grid",style:{position:"relative"},children:[V&&v.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999},children:v.jsxs("div",{className:"card",style:{maxWidth:460},children:[v.jsxs("h3",{style:{marginTop:0},children:["Bravo ",e?.displayName?.split(" ")[0]||"!"]}),v.jsxs("div",{className:"small",children:["Score ",w?.score,"/",w?.outOf]}),v.jsxs("div",{className:"small",style:{marginTop:6},children:["+",H?.deltaXp??0," XP"]}),H?.levelUp&&v.jsxs("div",{className:"small",style:{marginTop:6},children:[" Niveau ",H?.newRewards?.level]}),pe&&v.jsxs("div",{className:"pill",style:{marginTop:10,display:"flex",alignItems:"center",gap:10},children:[v.jsx("div",{style:{fontSize:"1.6rem"},children:pe.icon}),v.jsxs("div",{children:[v.jsxs("div",{style:{fontWeight:800},children:[" Nouveau ! ",pe.title]}),v.jsxs("div",{className:"small",children:[pe.type==="avatar"?"Avatar":"Sticker","  ",Ve]})]})]}),ke&&v.jsxs("div",{className:"pill",style:{marginTop:10,display:"flex",alignItems:"center",gap:10},children:[v.jsx("div",{style:{fontSize:"1.6rem"},children:ke.icon}),v.jsxs("div",{children:[v.jsxs("div",{style:{fontWeight:800},children:["Butin MaloCraft : ",ke.title]}),v.jsxs("div",{className:"small",children:[ke.type,"  ",ke.rarity==="epic"?"pique":ke.rarity==="rare"?"Rare":"Commun"]})]})]}),H?.unlockedBadges?.length?v.jsxs("div",{className:"small",style:{marginTop:8},children:["Nouveau badge : ",H.unlockedBadges.map(Pe=>v.jsx("span",{className:"badge",children:Pe},Pe))]}):null,Te&&v.jsx("div",{className:"small",style:{marginTop:8},children:Te}),v.jsxs("div",{className:"row",style:{marginTop:12,flexWrap:"wrap",gap:8},children:[pe?.type==="avatar"&&v.jsx("button",{className:"btn",onClick:Le,children:"quiper"}),v.jsx("button",{className:"btn",onClick:()=>N(!1),children:"Voir la correction"})]})]})}),v.jsxs("div",{className:"card",children:[v.jsxs("h2",{style:{margin:0},children:["Corrections  ",s?.title]}),w&&v.jsxs("div",{className:"small",children:["Score ",v.jsxs("strong",{children:[w.score,"/",w.outOf]}),"  ",w.durationSec,"s  +",w.xpGain," XP  +",w.coinsGain," pices"]}),H&&v.jsxs("div",{className:"small",style:{marginTop:8},children:["+",H.deltaXp," XP ",H.levelUp?`  Niveau ${H.newRewards?.level}`:""]}),v.jsxs("div",{className:"row",style:{gap:8,marginTop:10,flexWrap:"wrap"},children:[ke&&v.jsx("button",{className:"btn secondary",onClick:()=>P("/chest"),children:"Voir mon coffre"}),pe&&v.jsx("button",{className:"btn secondary",onClick:()=>P("/collection"),children:"Voir ma collection"})]}),Te&&v.jsx("div",{className:"small",style:{marginTop:8},children:Te})]}),v.jsxs("div",{className:"card",children:[v.jsx("div",{className:"grid",children:G.map(Pe=>v.jsxs("div",{className:"pill",style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6,background:Pe.correct?"rgba(46, 204, 113, 0.12)":"rgba(255, 90, 111, 0.12)",border:Pe.correct?"1px solid rgba(46, 204, 113, 0.4)":"1px solid rgba(255, 90, 111, 0.4)"},children:[v.jsxs("div",{className:"small",children:["Question ",Pe.idx,"  ",Pe.correct?v.jsx("span",{className:"badge",style:{borderColor:"rgba(46,204,113,.6)",color:"#7fffb2"},children:" Bonne rponse"}):v.jsx("span",{className:"badge",style:{borderColor:"rgba(255,90,111,.6)",color:"#ff9fb0"},children:" Mauvaise rponse"})]}),v.jsx("div",{style:{fontWeight:700},children:Pe.prompt}),v.jsxs("div",{className:"small",children:["Ta rponse : ",v.jsx("strong",{children:Pe.userAnswer})]}),!Pe.correct&&v.jsxs("div",{className:"small",children:["Correction : ",v.jsx("strong",{children:Pe.expected})]})]},Pe.id))}),v.jsxs("div",{className:"row",style:{marginTop:16},children:[v.jsx("button",{className:"btn",onClick:()=>P("/"),children:"Retour  laccueil"}),v.jsx("button",{className:"btn secondary",onClick:()=>{M(!1),X([]),T(null),p({})},children:"Refaire une session"})]})]}),H&&v.jsxs("div",{className:"card",children:[v.jsx("h3",{style:{marginTop:0},children:"Progression XP"}),v.jsxs("div",{className:"small",children:["XP : ",fe,"  ",we]}),(()=>{const Pe=bl(fe),lt=bl(we),cn=Math.min(100,Math.max(0,Math.round(lt.xpIntoLevel/lt.xpForNext*100)));return v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"small",children:["Niveau : ",Pe.level,"  ",lt.level]}),v.jsx("div",{style:{height:12,background:"rgba(255,255,255,0.08)",borderRadius:999,overflow:"hidden",marginTop:8},children:v.jsx("div",{style:{height:"100%",width:`${cn}%`,background:"linear-gradient(90deg,#7aa2ff,#2ecc71)",transition:"width 0.6s ease"}})})]})})()]})]})}return v.jsxs("div",{className:"container grid",children:[v.jsxs("div",{className:"card",children:[v.jsx("h2",{style:{margin:0},children:s?.title||"Session"}),v.jsx("div",{className:"small",children:"Fais de ton mieux. Objectif : rgularit "})]}),v.jsx(kP,{rewards:t}),l.map((D,Q)=>{const fe=D.readingContext,we=fe&&(Q===0||l[Q-1].readingContext?.readingId!==fe.readingId);return v.jsxs("div",{className:"card",children:[we&&fe&&v.jsxs("div",{style:{marginBottom:10},children:[v.jsxs("div",{className:"small",style:{marginBottom:4},children:["Lecture : ",fe.title]}),v.jsx("div",{className:"small",style:{whiteSpace:"pre-wrap"},children:hu(fe.text)}),v.jsx("hr",{})]}),v.jsxs("div",{className:"small",children:["Question ",Q+1," / ",l.length," ",v.jsxs("span",{className:"badge",children:["Difficult ",D.difficulty]})]}),v.jsx("div",{style:{fontWeight:800,marginTop:6},children:hu(D.prompt)}),D.type==="mcq"&&v.jsx("div",{className:"grid",style:{marginTop:10},children:D.choices.map((Te,pe)=>v.jsx("button",{type:"button",className:"btn "+(h[D.id]===pe?"":"secondary"),onClick:()=>p(Ve=>({...Ve,[D.id]:pe})),style:{textAlign:"left",opacity:h[D.id]===pe?1:.85},"aria-pressed":h[D.id]===pe,children:hu(Te)},pe))}),D.type==="short_text"&&v.jsx("div",{style:{marginTop:10},children:v.jsx("input",{className:"input",placeholder:"Ta rponse",value:h[D.id]??"",onChange:Te=>p(pe=>({...pe,[D.id]:Te.target.value}))})}),D.type==="fill_blank"&&v.jsxs("div",{style:{marginTop:10},children:[v.jsx("div",{className:"small",children:hu(D.text)}),v.jsx("input",{className:"input",placeholder:"Le mot manquant",value:h[D.id]??"",onChange:Te=>p(pe=>({...pe,[D.id]:Te.target.value}))})]})]},D.id)}),v.jsxs("div",{className:"card",children:[v.jsxs("div",{className:"row",children:[v.jsx("button",{className:"btn",onClick:ae,children:"Corriger et enregistrer"}),w&&v.jsxs("div",{className:"small",children:["Score ",v.jsxs("strong",{children:[w.score,"/",w.outOf]}),"  ",w.durationSec,"s"]})]}),w?.badges?.length?v.jsx("div",{className:"row",style:{marginTop:10},children:w.badges.map(D=>v.jsx("span",{className:"badge",children:D},D))}):null,C.length?v.jsxs("div",{className:"small",style:{marginTop:10},children:["Tags  renforcer (thme) : ",C.map(D=>v.jsx("span",{className:"badge",children:D},D))]}):null]}),G.length?v.jsxs("div",{className:"card",children:[v.jsx("h3",{style:{marginTop:0},children:"Corrections"}),Ue&&v.jsx("div",{className:"small",style:{color:"#ff5a6f",marginBottom:8},children:Ue}),v.jsx("div",{className:"grid",children:G.map(D=>v.jsxs("div",{className:"pill",style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6},children:[v.jsxs("div",{className:"small",children:["Question ",D.idx,"  ",D.correct?v.jsx("span",{className:"badge",children:" Bonne rponse"}):v.jsx("span",{className:"badge",children:" Mauvaise rponse"})]}),v.jsx("div",{style:{fontWeight:700},children:D.prompt}),v.jsxs("div",{className:"small",children:["Ta rponse : ",v.jsx("strong",{children:D.userAnswer})]}),!D.correct&&v.jsxs("div",{className:"small",children:["Correction : ",v.jsx("strong",{children:D.expected})]})]},D.id))})]}):null]})}function qP(){const[n,e]=de.useState(""),t=async s=>{if(!s)return;e("Lecture du fichier");const o=await s.text();let l;try{l=JSON.parse(o)}catch{e(" JSON invalide");return}if(!l?.subjects?.length){e(" Format inattendu (subjects manquant)");return}e("Import en cours"),await Nb(l),e(" Import termin")};return v.jsx("div",{className:"container",children:v.jsxs("div",{className:"card",children:[v.jsx("h2",{style:{marginTop:0},children:"Import dexercices (Parent)"}),v.jsx("p",{className:"small",children:"Importe un pack JSON (gnr par moi) : matires  thmes  exercices."}),v.jsx("input",{className:"input",type:"file",accept:".json,application/json",onChange:s=>t(s.target.files?.[0]||null)}),n&&v.jsx("p",{className:"small",style:{marginTop:10},children:n}),v.jsx("hr",{}),v.jsx("p",{className:"small",children:"Conseil : commence par importer les packs Franais (grammaire + conjugaison) et Maths (fractions)."})]})})}const $P=[{id:"all",label:"Toutes"},{id:"fr",label:"Franais"},{id:"math",label:"Maths"},{id:"en",label:"Anglais"},{id:"es",label:"Espagnol"},{id:"hist",label:"Histoire"}];function WP(n){if(!n)return null;const e=n.split("_")[0];return e==="fr"||e==="math"||e==="en"||e==="es"||e==="hist"?e:null}function ov(n){return n.last7?n.last7:Array.isArray(n.last7Results)?{correct:n.last7Results.filter(Boolean).length,wrong:n.last7Results.filter(e=>!e).length}:{correct:0,wrong:0}}function HP(){const{user:n,role:e}=zn(),[t,s]=de.useState([]),[o,l]=de.useState(""),[u,h]=de.useState([]),[p,y]=de.useState(!1),[w,T]=de.useState("fr"),[C,k]=de.useState(null),[$,j]=de.useState(""),[O,Z]=de.useState({});de.useEffect(()=>{n&&(e==="parent"?(async()=>{const S=(await jt(Bn(gt(le,"users"),rr("role","==","child")))).docs.map(R=>({id:R.id,displayName:R.data().displayName||"Enfant"}));s(S),S[0]&&l(S[0].id)})():l(n.uid))},[n,e]);const G=de.useCallback(async I=>{y(!0);const R=(await jt(gt(le,"users",I,"tagProgress"))).docs.map(P=>({id:P.id,tagId:P.id,...P.data()}));h(R);const N=(await jt(gt(le,"users",I,"progressSummary"))).docs.find(P=>P.id==="main");k(N?.data()||null),y(!1)},[]);de.useEffect(()=>{o&&G(o)},[o,G]);const X=async I=>{if(!o||($!==I&&j(I),O[I]?.items?.length||O[I]?.loading))return;Z(P=>({...P,[I]:{loading:!0,items:[]}}));let S;try{S=await jt(Bn(gt(le,"users",o,"attemptItems"),rr("tags","array-contains",I),Gp(100)))}catch{S=await jt(Bn(gt(le,"users",o,"attemptItems"),rr("tags","array-contains",I)))}const R=S.docs.map(P=>({id:P.id,...P.data()})),V={};await Promise.all(Array.from(new Set(R.map(P=>P.exerciseId))).map(async P=>{const x=await Dr(Me(le,"exercises",P));x.exists()?V[P]=x.data():V[P]={prompt:P}}));const N=R.map(P=>({...P,prompt:P.prompt||V[P.exerciseId]?.prompt||P.exerciseId,choices:P.choices||V[P.exerciseId]?.choices||null,readingContext:P.readingContext})).sort((P,x)=>{const ge=P.createdAt?.toMillis?P.createdAt.toMillis():0;return(x.createdAt?.toMillis?x.createdAt.toMillis():0)-ge});Z(P=>({...P,[I]:{loading:!1,items:N}}))},q=I=>{if($===I){j("");return}X(I)},M=u.filter(I=>w==="all"?!0:WP(I.tagId)===w).sort((I,S)=>(I.mastery||0)-(S.mastery||0)).slice(0,20),H=()=>{const I=[["tagId","mastery","bucket","attempts","correct","wrong","last7_correct","last7_wrong","nextDueDate"]];u.forEach(P=>{const x=ov(P);I.push([P.tagId||P.id,String(P.mastery??0),P.bucket||"",String(P.attempts??0),String(P.correctAnswers??0),String(P.wrongAnswers??0),String(x.correct),String(x.wrong),P.nextDueDate||""])});const S=I.map(P=>P.map(x=>`"${(x??"").toString().replace(/"/g,'""')}"`).join(",")).join(`
`),R=new Blob([S],{type:"text/csv;charset=utf-8;"}),V=URL.createObjectURL(R),N=document.createElement("a");N.href=V,N.download=`progress-${o||"user"}.csv`,N.click(),URL.revokeObjectURL(V)};return v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"card",children:[v.jsx("h2",{style:{marginTop:0},children:"Progression par tag"}),v.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[e==="parent"&&v.jsxs(v.Fragment,{children:[v.jsx("label",{className:"small",children:"Enfant"}),v.jsx("select",{className:"input",value:o,onChange:I=>l(I.target.value),children:t.map(I=>v.jsx("option",{value:I.id,children:I.displayName},I.id))})]}),v.jsx("label",{className:"small",children:"Matire"}),v.jsx("select",{className:"input",value:w,onChange:I=>T(I.target.value),children:$P.map(I=>v.jsx("option",{value:I.id,children:I.label},I.id))}),v.jsx("button",{className:"btn secondary",onClick:H,disabled:!u.length,children:"Tlcharger CSV"})]}),C&&v.jsxs("div",{className:"kpi",style:{marginTop:10},children:[v.jsxs("div",{className:"pill",children:["Rponses: ",v.jsx("strong",{children:C.totalAnswers||0})]}),v.jsxs("div",{className:"pill",children:["Taux: ",v.jsxs("strong",{children:[C.totalAnswers?Math.round((C.correctAnswers||0)/C.totalAnswers*100):0,"%"]})]}),v.jsxs("div",{className:"pill",children:["Tentatives: ",v.jsx("strong",{children:C.totalAttempts||0})]})]})]}),p?v.jsx("div",{className:"card",children:"Chargement"}):v.jsxs("div",{className:"card",children:[v.jsx("h3",{style:{marginTop:0},children:"Top 20 faibles"}),M.length===0?v.jsx("div",{className:"small",children:"Aucun tag pour le moment."}):v.jsx("div",{className:"grid",children:M.map(I=>{const S=ov(I),R=Td(I.tagId||I.id),V=$===(I.tagId||I.id),N=O[I.tagId||I.id]||{loading:!1,items:[]};return v.jsxs("div",{className:"card",style:{padding:12},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[v.jsxs("div",{onClick:()=>q(I.tagId||I.id),style:{cursor:"pointer",flex:1},children:[v.jsx("div",{style:{fontWeight:700},children:R.label}),v.jsxs("div",{className:"small",children:[R.theme,"  ",J0[R.subject]]}),v.jsxs("div",{className:"small",children:[I.mastery??0,"/100  ",I.bucket,"  ",S.correct,"/",S.correct+S.wrong," sur 7  Prochaine: ",I.nextDueDate||""]}),v.jsx("div",{style:{height:8,background:"rgba(255,255,255,0.08)",borderRadius:999,marginTop:6,width:"100%"},children:v.jsx("div",{style:{height:8,borderRadius:999,width:`${Math.min(100,Math.max(0,I.mastery||0))}%`,background:"linear-gradient(90deg,#ff5a6f,#7aa2ff)"}})}),v.jsx("div",{className:"row",style:{marginTop:6,gap:4},children:(I.last7Results||[]).map((P,x)=>v.jsx("span",{style:{width:10,height:10,borderRadius:"50%",background:P?"#2ecc71":"#ff5a6f",opacity:.9}},x))})]}),v.jsx("button",{className:"btn secondary",style:{width:36,height:36},onClick:()=>q(I.tagId||I.id),children:V?"":"+"})]}),V&&v.jsx("div",{className:"card",style:{marginTop:10,background:"rgba(255,255,255,0.03)"},children:N.loading?v.jsx("div",{className:"small",children:"Chargement"}):N.items.length===0?v.jsx("div",{className:"small",children:"Aucune question trouve pour ce tag."}):v.jsx("div",{className:"grid",children:N.items.map(P=>v.jsxs("div",{className:"pill",style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6},children:[v.jsxs("div",{className:"small",children:[P.createdAt?.toDate?P.createdAt.toDate().toLocaleString():"","  Diff ",P.difficulty,"  ",P.correct?"":""]}),v.jsx("div",{style:{fontWeight:700},children:P.prompt}),P.readingContext&&v.jsxs("div",{className:"small",style:{whiteSpace:"pre-wrap"},children:[v.jsxs("div",{style:{fontWeight:600,marginBottom:4},children:["Lecture : ",P.readingContext.title]}),P.readingContext.text]}),Array.isArray(P.choices)&&typeof P.answer=="number"?v.jsxs("div",{className:"small",children:["Rponse : ",v.jsx("strong",{children:P.choices[P.answer]||P.answer})]}):v.jsxs("div",{className:"small",children:["Rponse : ",v.jsx("strong",{children:P.answer??""})]})]},P.id))})})]},I.id)})})]})]})}const av=[{id:"all",label:"Toutes"},{id:"fr",label:"Franais"},{id:"math",label:"Maths"},{id:"en",label:"Anglais"},{id:"es",label:"Espagnol"},{id:"hist",label:"Histoire"}];function GP(){const[n,e]=de.useState([]),[t,s]=de.useState(""),[o,l]=de.useState("all"),[u,h]=de.useState([]),[p,y]=de.useState(!1),[w,T]=de.useState({}),[C,k]=de.useState(null);de.useEffect(()=>{(async()=>{const M=(await jt(Bn(gt(le,"users"),rr("role","==","child")))).docs.map(H=>({id:H.id,displayName:H.data().displayName||"Enfant"}));e(M),M[0]&&s(M[0].id)})()},[]),de.useEffect(()=>{t&&(y(!0),(async()=>{const q=av.filter(S=>S.id!=="all").map(S=>S.id),M=o==="all"?q:[o],H=[];for(const S of M){const R=await Pb(S,{uid:t,includeHidden:!0,includeOverrides:!0});H.push(...R)}const I=H.sort((S,R)=>(S.title||"").localeCompare(R.title||""));h(I),y(!1)})())},[t,o]);const $=async(q,M)=>{t&&(await Vb(t,q,M),h(H=>H.map(I=>I.id===q?{...I,visibleOverride:M}:I)))},j=async(q,M)=>{await Db(q,M),h(H=>H.map(I=>I.id===q?{...I,hidden:M}:I))},O=async q=>{if(!window.confirm("Supprimer ce thme et toutes ses questions ?"))return;const M=await Mb(q);h(H=>H.filter(I=>I.id!==q)),T(H=>{const I={...H};return delete I[q],I}),M.hidden&&h(H=>H.map(I=>I.id===q?{...I,hidden:!0}:I))},Z=async q=>{k(q);const M=await $0(q,{uid:t,includeHidden:!0,includeOverrides:!0});T(H=>({...H,[q]:M})),k(null)},G=async(q,M)=>{await Ob(q,M),T(H=>{const I={};return Object.keys(H).forEach(S=>{I[S]=H[S].map(R=>R.id===q?{...R,hidden:M}:R)}),{...H,...I}})},X=async(q,M,H)=>{t&&(await jb(t,q,M),T(I=>({...I,[H]:(I[H]||[]).map(S=>S.id===q?{...S,visibleOverride:M}:S)})))};return v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"card",children:[v.jsx("h2",{style:{marginTop:0},children:"Modration contenus"}),v.jsxs("div",{className:"row",style:{gap:10},children:[v.jsxs("div",{className:"row",style:{gap:6},children:[v.jsx("span",{className:"small",children:"Enfant"}),v.jsx("select",{className:"input",value:t,onChange:q=>s(q.target.value),children:n.map(q=>v.jsx("option",{value:q.id,children:q.displayName},q.id))})]}),v.jsxs("div",{className:"row",style:{gap:6},children:[v.jsx("span",{className:"small",children:"Matire"}),v.jsx("select",{className:"input",value:o,onChange:q=>l(q.target.value),children:av.map(q=>v.jsx("option",{value:q.id,children:q.label},q.id))})]})]})]}),p?v.jsx("div",{className:"card",children:"Chargement"}):v.jsxs("div",{className:"grid",children:[u.map(q=>{const M=q.visibleOverride,H=M!==void 0?M:!q.hidden;return v.jsxs("div",{className:"card",children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between"},children:[v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:800},children:q.title}),v.jsx("div",{className:"small",children:q.subjectId}),q.hidden&&v.jsx("div",{className:"badge",children:"Masqu globalement"}),M===!1&&v.jsx("div",{className:"badge",children:"Masqu pour lenfant"})]}),v.jsxs("div",{className:"row",children:[v.jsx("button",{className:"btn secondary",onClick:()=>$(q.id,!H),children:H?"Masquer pour lenfant":"Afficher pour lenfant"}),v.jsx("button",{className:"btn secondary",onClick:()=>j(q.id,!q.hidden),children:q.hidden?"Ractiver globalement":"Masquer globalement"}),v.jsx("button",{className:"btn secondary",onClick:()=>O(q.id),children:"Supprimer"}),v.jsx("button",{className:"btn secondary",onClick:()=>Z(q.id),children:"Voir questions"})]})]}),(w[q.id]||[]).length>0&&v.jsxs("div",{style:{marginTop:10},children:[v.jsx("div",{className:"small",style:{marginBottom:6},children:"Questions"}),v.jsx("div",{className:"grid",children:w[q.id].map(I=>{const S=I.visibleOverride,R=S!==void 0?S:!I.hidden;return v.jsxs("div",{className:"pill",style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6},children:[v.jsxs("div",{className:"small",children:[I.prompt?.slice(0,80)||I.id," ",I.hidden&&v.jsx("span",{className:"badge",children:"Masqu global"})," ",S===!1&&v.jsx("span",{className:"badge",children:"Masqu enfant"})]}),v.jsxs("div",{className:"row",children:[v.jsx("button",{className:"btn secondary",onClick:()=>X(I.id,!R,q.id),children:R?"Masquer enfant":"Afficher enfant"}),v.jsx("button",{className:"btn secondary",onClick:()=>G(I.id,!I.hidden),children:I.hidden?"Ractiver global":"Masquer global"})]})]},I.id)})})]}),C===q.id&&v.jsx("div",{className:"small",style:{marginTop:6},children:"Chargement des questions"})]},q.id)}),u.length===0&&v.jsx("div",{className:"card small",children:"Aucun thme."})]})]})}const KP=[{id:"all",label:"Toutes"},{id:"fr",label:"Franais"},{id:"math",label:"Maths"},{id:"en",label:"Anglais"},{id:"es",label:"Espagnol"},{id:"hist",label:"Histoire"}];function QP(n){if(!n)return null;const e=n.split("_")[0];return e==="fr"||e==="math"||e==="en"||e==="es"||e==="hist"?e:null}function JP(){const{user:n}=zn(),{rewards:e}=ci(n?.uid||null),[t,s]=de.useState("all"),[o,l]=de.useState(""),u=e.masteryByTag||{},h=Object.entries(u).map(([p,y])=>({tag:p,data:y,meta:Td(p)})).filter(({tag:p,meta:y})=>t==="all"?!0:QP(p)===t).filter(({meta:p})=>p.label.toLowerCase().includes(o.toLowerCase())).sort((p,y)=>{const w=k=>k==="mastered"?0:k==="progressing"?1:2,T=w(p.data.state),C=w(y.data.state);return T!==C?T-C:(p.meta.order||9999)!==(y.meta.order||9999)?(p.meta.order||9999)-(y.meta.order||9999):p.meta.label.localeCompare(y.meta.label)});return v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"card",children:[v.jsx("h2",{style:{marginTop:0},children:"Progression"}),v.jsxs("div",{className:"row",style:{alignItems:"center",gap:8},children:[v.jsx("span",{className:"small",children:"Matire"}),v.jsx("select",{className:"input",value:t,onChange:p=>s(p.target.value),children:KP.map(p=>v.jsx("option",{value:p.id,children:p.label},p.id))}),v.jsx("input",{className:"input",style:{maxWidth:260},placeholder:"Rechercher un tag",value:o,onChange:p=>l(p.target.value)})]})]}),v.jsx("div",{className:"grid",children:h.length===0?v.jsx("div",{className:"card small",children:"Aucune donne de matrise pour linstant."}):h.map(({tag:p,data:y,meta:w})=>{const T=Math.min(100,Math.max(0,Math.round(y.score||0)));return v.jsxs("div",{className:"card",style:{padding:12},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between"},children:[v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:800},children:w.label}),v.jsxs("div",{className:"small",children:[J0[w.subject],"  ",w.theme]}),v.jsx("div",{className:"small",title:tP[y.state]||"",children:eP[y.state]||y.state})]}),v.jsxs("div",{className:"small",children:[T,"/100"]})]}),v.jsx("div",{style:{height:10,background:"rgba(255,255,255,0.08)",borderRadius:999,marginTop:6},children:v.jsx("div",{style:{height:"100%",width:`${T}%`,background:y.state==="mastered"?"#2ecc71":y.state==="progressing"?"#7aa2ff":"#ff9f43",borderRadius:999}})})]},p)})})]})}function XP(){return v.jsx("div",{className:"container",children:v.jsx("div",{className:"card",children:"Page introuvable."})})}const YP={common:"Commun",rare:"Rare",epic:"pique"};function ZP(){const{user:n}=zn(),{rewards:e}=ci(n?.uid||null),[t,s]=de.useState("sticker"),o=new Set(e?.collectibles?.owned||[]),l=e?.collectibles?.equippedAvatarId,u=async p=>{if(n)try{await Yp(n.uid,p)}catch(y){console.error("equipAvatar",y)}},h=ri.filter(p=>p.type===t);return v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"card",children:[v.jsx("h2",{style:{marginTop:0},children:"Collection"}),v.jsxs("div",{className:"row",style:{gap:8},children:[v.jsx("button",{className:`btn ${t==="sticker"?"":"secondary"}`,onClick:()=>s("sticker"),children:"Stickers"}),v.jsx("button",{className:`btn ${t==="avatar"?"":"secondary"}`,onClick:()=>s("avatar"),children:"Avatars"})]})]}),v.jsx("div",{className:"grid",children:h.map(p=>{const y=o.has(p.id),w=p.id===l;return v.jsxs("div",{className:"card",style:{opacity:y?1:.65},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[v.jsx("div",{style:{fontSize:"1.8rem"},children:p.icon}),v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:800},children:p.title}),v.jsx("div",{className:"small",children:p.description}),v.jsxs("div",{className:"small",children:["Raret : ",YP[p.rarity]]})]})]}),w&&v.jsx("span",{className:"badge",children:"quip"})]}),!y&&v.jsx("div",{className:"small",style:{marginTop:8,color:"rgba(255,255,255,0.7)"},children:" dbloquer en jouant "}),p.type==="avatar"&&y&&v.jsx("button",{className:"btn secondary",style:{marginTop:10},onClick:()=>u(p.id),children:w?"quip":"quiper"})]},p.id)})})]})}function ek(){const{user:n}=zn(),{rewards:e,loading:t}=ci(n?.uid||null),s=ii();return v.jsxs("div",{className:"container grid",children:[v.jsxs("div",{className:"card mc-card",children:[v.jsx("h2",{className:"mc-title",children:"Carte du monde MaloCraft"}),v.jsx("div",{className:"small",children:"Choisis un biome pour voir tes blocs, leur tat et ta progression."})]}),v.jsx("div",{className:"grid2",children:Q0.map(o=>{const l=em(o.id),u=l.filter(y=>e.masteryByTag?.[y.tagId]?.state==="mastered").length,h=l.length,p=!t&&h>0?Math.round(u/h*100):null;return v.jsxs("div",{className:"card mc-card world-card",role:"button",tabIndex:0,onClick:()=>s(`/world/${o.id}`),onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),s(`/world/${o.id}`))},children:[v.jsxs("div",{className:"row",style:{alignItems:"center",gap:12},children:[v.jsx("div",{style:{fontSize:"1.8rem"},children:o.icon}),v.jsxs("div",{style:{flex:1},children:[v.jsx("div",{style:{fontWeight:800,fontSize:"1.1rem"},children:o.name}),v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:o.description})]}),v.jsxs("div",{className:"mc-chip accent",children:[h||0," blocs"]})]}),v.jsxs("div",{className:"small",style:{marginTop:10},children:["Progression : ",p!==null?`${p}% (${u}/${h})`:""]})]},o.id)})})]})}function tk(n,e){return n?.[e]?.state||"discovering"}function lv(n){switch(n){case"mastered":return"Brillant";case"progressing":return"Solide";default:return"Fissur"}}function nk(n){const{tagId:e,biomeId:t,masteryState:s,shouldRepair:o}=n,l=[];l.push({type:"mine",biomeId:t,targetTagId:e,estimatedMinutes:10,recommended:!1}),o&&l.push({type:"repair",biomeId:t,targetTagId:e,estimatedMinutes:8,recommended:!0}),s!=="discovering"&&l.push({type:"craft",biomeId:t,targetTagId:e,estimatedMinutes:12,recommended:!1});let u=!1;return l.forEach(h=>{h.recommended&&!u?u=!0:h.recommended=!1}),!u&&l.length&&(l[0].recommended=!0),l}function rk(){const{biomeId:n}=gv(),e=n?Zb(n):null,{user:t}=zn(),{rewards:s,loading:o}=ci(t?.uid||null),l=ii(),[u,h]=de.useState(null),[p,y]=de.useState({});if(!n||!e)return v.jsx("div",{className:"container grid",children:v.jsxs("div",{className:"card mc-card",children:[v.jsx("div",{className:"small",children:"Biome introuvable."}),v.jsx("button",{className:"mc-button secondary",style:{marginTop:10},onClick:()=>l("/world"),children:" Retour carte"})]})});const w=s.masteryByTag||{},T={mastered:0,progressing:1,discovering:2},C=em(n).map(j=>{const O=Td(j.tagId),Z=tk(w,j.tagId);return{...j,masteryState:Z,description:O.description}}).sort((j,O)=>{const Z=(T[j.masteryState]??2)-(T[O.masteryState]??2);if(Z!==0)return Z;const G=j.theme.localeCompare(O.theme);return G!==0?G:j.blockName.localeCompare(O.blockName)}),k=C.find(j=>j.tagId===u)||null,$=k?nk({tagId:k.tagId,biomeId:n,masteryState:k.masteryState,shouldRepair:Id(k.tagId,[])}):[];return de.useEffect(()=>{let j=!1;return(async()=>{const Z=await Promise.all(C.map(async G=>{try{const X=await Jp(G.tagId,{uid:t?.uid});return[G.tagId,X.length>0]}catch{return[G.tagId,!1]}}));if(!j){const G={};Z.forEach(([X,q])=>{G[X]=q}),y(G)}})(),()=>{j=!0}},[C,t]),v.jsxs("div",{className:"container grid",children:[v.jsxs("div",{className:"card mc-card",children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[v.jsx("button",{className:"mc-button secondary",onClick:()=>l("/world"),children:" Retour carte"}),v.jsxs("div",{className:"mc-chip accent",children:[C.length," blocs"]})]}),v.jsxs("h2",{className:"mc-title",style:{marginTop:10},children:[e.icon," ",e.name]}),v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:e.description})]}),o?v.jsx("div",{className:"grid",children:[1,2,3].map(j=>v.jsx("div",{className:"block-card mc-card skeleton"},j))}):v.jsx("div",{className:"grid",style:{gap:12},children:C.map(j=>{const O=j.masteryState==="mastered"?"block-shiny":j.masteryState==="progressing"?"block-solid":"block-cracked",Z=j.masteryState==="mastered"?"gold":j.masteryState==="progressing"?"accent":"",G=p[j.tagId]!==!1;return v.jsxs("div",{className:`block-card mc-card ${O}`,role:"button",tabIndex:0,onClick:()=>G&&h(j.tagId),onKeyDown:X=>{G&&(X.key==="Enter"||X.key===" ")&&(X.preventDefault(),h(j.tagId))},style:{cursor:G?"pointer":"not-allowed",opacity:G?1:.55,outline:u===j.tagId?"2px solid var(--mc-accent)":void 0},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:800},children:j.blockName}),v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:j.description||"Description  venir."})]}),v.jsxs("span",{className:`mc-chip ${Z}`,children:[j.masteryState==="mastered"?"":j.masteryState==="progressing"?"":""," ",lv(j.masteryState)]})]}),!G&&v.jsx("div",{className:"small",style:{color:"var(--mc-muted)",marginTop:6},children:"Pas encore de missions pour ce bloc."})]},j.tagId)})}),k&&v.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999},role:"dialog","aria-modal":"true",children:v.jsxs("div",{className:"card mc-card",style:{maxWidth:520,width:"92%",maxHeight:"90vh",overflowY:"auto"},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",gap:10},children:[v.jsxs("div",{children:[v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:"Bloc cibl"}),v.jsx("div",{style:{fontWeight:900},children:k.blockName}),v.jsx("div",{className:"small",children:lv(k.masteryState)})]}),v.jsx("button",{className:"mc-button secondary",onClick:()=>h(null),children:"Fermer"})]}),v.jsx("div",{className:"grid",style:{gap:10,marginTop:12},children:$.slice(0,3).map(j=>{const O=j.type==="mine"?"":j.type==="repair"?"":"",Z=j.type==="mine"?"Mine":j.type==="repair"?"Rparer":"Artisanat",G=j.type==="mine"?"Rcolte et consolidation de ton bloc.":j.type==="repair"?"Corriger les fissures : focus sur les erreurs rcentes.":"Combiner ce bloc avec un autre pour progresser.";return v.jsxs("div",{className:"mc-card",style:{border:"2px solid var(--mc-border)"},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[v.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[v.jsx("div",{style:{fontSize:"1.4rem"},children:O}),v.jsxs("div",{children:[v.jsxs("div",{style:{fontWeight:800},children:[Z," ",j.recommended?" recommand":""]}),v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:G})]})]}),v.jsxs("div",{className:"mc-chip",children:[j.estimatedMinutes," min"]})]}),v.jsx("button",{className:"mc-button",style:{marginTop:10,width:"100%"},onClick:()=>l(`/theme/expedition?expeditionType=${j.type}&targetTagId=${k.tagId}&biomeId=${n}`),children:"Commencer lexpdition"})]},j.type)})})]})})]})}const sk={common:"Commun",rare:"Rare",epic:"pique"},ik={sticker:"Sticker",fragment:"Fragment",trophy:"Trophe",avatar:"Avatar"};function ok(){const{user:n}=zn(),{rewards:e}=ci(n?.uid||null),t=new Set(e.malocraft?.ownedLootIds||[]),[s,o]=de.useState("all"),l=async h=>{if(n)try{await Yp(n.uid,h)}catch(p){console.error("equip avatar",p)}},u=Pl.filter(h=>s==="all"?!0:h.type===s).sort((h,p)=>(h.biomeId||"").localeCompare(p.biomeId||"")||h.title.localeCompare(p.title));return v.jsxs("div",{className:"container grid",children:[v.jsxs("div",{className:"card mc-card",children:[v.jsx("h2",{className:"mc-title",children:"Coffre MaloCraft"}),v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:"Tous les loots gagns en expditions."}),v.jsx("div",{className:"row",style:{gap:8,marginTop:10,flexWrap:"wrap"},children:["all","sticker","fragment","trophy","avatar"].map(h=>v.jsx("button",{className:`mc-button ${s===h?"":"secondary"}`,onClick:()=>o(h),children:h==="all"?"Tout":ik[h]},h))})]}),v.jsx("div",{className:"grid2",children:u.map(h=>{const p=t.has(h.id),y=h.type==="avatar",w=e.collectibles?.equippedAvatarId===h.id;return v.jsxs("div",{className:"card mc-card",style:{opacity:p?1:.5},children:[v.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[v.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[v.jsx("div",{style:{fontSize:"1.8rem"},children:h.icon}),v.jsxs("div",{children:[v.jsx("div",{style:{fontWeight:800},children:h.title}),v.jsx("div",{className:"small",style:{color:"var(--mc-muted)"},children:h.description}),v.jsxs("div",{className:"small",children:[sk[h.rarity]," ",h.biomeId?` ${h.biomeId}`:""]})]})]}),w&&v.jsx("span",{className:"mc-chip accent",children:"quip"})]}),!p&&v.jsx("div",{className:"small",style:{marginTop:6},children:" gagner en expdition"}),y&&p&&v.jsx("button",{className:"mc-button secondary",style:{marginTop:8},onClick:()=>l(h.id),children:w?"quip":"quiper"})]},h.id)})})]})}function ak(){return v.jsxs(wI,{children:[v.jsx("div",{className:"container",children:v.jsx(bb,{})}),v.jsxs(hI,{children:[v.jsx(xn,{path:"/connexion",element:v.jsx(_P,{})}),v.jsx(xn,{path:"/",element:v.jsx(Li,{children:v.jsx(yP,{})})}),v.jsx(xn,{path:"/theme/:themeId",element:v.jsx(Li,{children:v.jsx(zP,{})})}),v.jsx(xn,{path:"/admin/import",element:v.jsx(hf,{children:v.jsx(qP,{})})}),v.jsx(xn,{path:"/admin/progression",element:v.jsx(hf,{children:v.jsx(HP,{})})}),v.jsx(xn,{path:"/admin/moderation",element:v.jsx(hf,{children:v.jsx(GP,{})})}),v.jsx(xn,{path:"/collection",element:v.jsx(Li,{children:v.jsx(ZP,{})})}),v.jsx(xn,{path:"/progression",element:v.jsx(Li,{children:v.jsx(JP,{})})}),v.jsx(xn,{path:"/chest",element:v.jsx(Li,{children:v.jsx(ok,{})})}),v.jsx(xn,{path:"/world",element:v.jsx(Li,{children:v.jsx(ek,{})})}),v.jsx(xn,{path:"/world/:biomeId",element:v.jsx(Li,{children:v.jsx(rk,{})})}),v.jsx(xn,{path:"*",element:v.jsx(XP,{})})]})]})}function lk(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("${import.meta.env.BASE_URL}sw.js").catch(()=>{})})}document.body.classList.add("malocraft");wT.createRoot(document.getElementById("root")).render(v.jsx(de.StrictMode,{children:v.jsx(xb,{children:v.jsx(ak,{})})}));lk();
